/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t,e,r,i,n={96:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{BD:()=>l.B,Cb:()=>s.Cb,HK:()=>n.H,LD:()=>c.L,Mv:()=>o.M,OX:()=>s.OX,S6:()=>s.S6,XJ:()=>c.X,Y3:()=>h.Y,ef:()=>l.e,pc:()=>a.p,xi:()=>h.x});var n=r(6976),o=r(3602),a=r(7529),s=r(5396),c=r(6370),l=r(983),h=r(157),u=t([n,o,a,s,l,h]);[n,o,a,s,l,h]=u.then?(await u)():u,i()}catch(t){i(t)}}))},147:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{R:()=>S,i:()=>d});var n=r(7702),o=r(3294),a=r(2231),s=r(1789),c=r(6745),l=r(3432),h=r(1966),u=r(2091),_=t([n,o,a,s,u]);function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function w(){w=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function h(t,e,r,i){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),s=new A(i||[]);return n(a,"_invoke",{value:k(t,r,s)}),a}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var _="suspendedStart",d="suspendedYield",f="executing",g="completed",y={};function m(){}function b(){}function v(){}var S={};l(S,a,(function(){return this}));var R=Object.getPrototypeOf,E=R&&R(R(j([])));E&&E!==r&&i.call(E,a)&&(S=E);var x=v.prototype=m.prototype=Object.create(S);function C(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,o,a,s){var c=u(t[n],t,o);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==p(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return o=o?o.then(n,n):n()}})}function k(e,r,i){var n=_;return function(o,a){if(n===f)throw Error("Generator is already running");if(n===g){if("throw"===o)throw a;return{value:t,done:!0}}for(i.method=o,i.arg=a;;){var s=i.delegate;if(s){var c=M(s,i);if(c){if(c===y)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===_)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=f;var l=u(e,r,i);if("normal"===l.type){if(n=i.done?g:d,l.arg===y)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=g,i.method="throw",i.arg=l.arg)}}}function M(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,M(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=u(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function j(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(p(e)+" is not iterable")}return b.prototype=v,n(x,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:b,configurable:!0}),b.displayName=l(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},C(P.prototype),l(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var a=new P(h(t,r,i,n),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},C(x),l(x,c,"Generator"),l(x,a,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=j,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return s.type="throw",s.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:j(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function f(t,e,r,i,n,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(i,n)}function g(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(t){f(o,i,n,a,s,"next",t)}function s(t){f(o,i,n,a,s,"throw",t)}a(void 0)}))}}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,b(i.key),i)}}function b(t){var e=v(t,"string");return"symbol"==p(e)?e:e+""}function v(t,e){if("object"!=p(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=p(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function S(t){"undefined"!=typeof window&&window.debugLog?window.debugLog("Game",t):console.log("[Game] ".concat(t))}[n,o,a,s,u]=_.then?(await _)():_;var d=function(){return t=function t(){y(this,t),console.log("🧠 GameCore constructor"),S("Инициализация игры..."),this.update=this.update.bind(this),this.fixedUpdate=this.fixedUpdate.bind(this),this.events=new s.W(this),this.state=new a.m(this),this.ui=new n.D(this),this.world=new o.P(this),this.gameTime=0,this.physicsUpdateRate=1/60,this.physicsAccumulator=0,this.lastFrameTime=0,console.log("🧠 GameCore: constructor запущен"),this.init()},e=[{key:"init",value:(d=g(w().mark((function t(){return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("🔄 GameCore: init начат"),t.prev=1,this.ui.updateLoadingStatus("Инициализация компонентов..."),t.next=5,this.initBaseComponents();case 5:return S("Основные компоненты инициализированы"),t.next=8,this.loadResources();case 8:S("Ресурсы загружены"),this.events.setupEventListeners(),this.ui.showMainMenu(),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),S("Ошибка инициализации: ".concat(t.t0.message)),this.ui.showErrorScreen("Произошла ошибка при инициализации: ".concat(t.t0.message));case 17:case"end":return t.stop()}}),t,this,[[1,13]])}))),function(){return d.apply(this,arguments)})},{key:"initBaseComponents",value:(_=g(w().mark((function t(){return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.ui.updateLoadingStatus("Инициализация рендерера..."),this.renderer=new c.A(this.ui.gameCanvas),this.ui.updateLoadingStatus("Инициализация обработчика ввода..."),this.input=new l.l,this.ui.updateLoadingStatus("Инициализация сетевого менеджера..."),this.network=new h.I,this.ui.updateLoadingStatus("Инициализация физического движка..."),this.physics=new u.H,this.ui.updateLoadingStatus("Инициализация UI компонентов..."),t.next=12,this.ui.initComponents();case 12:return this.events.setupEventListeners(),t.abrupt("return",!0);case 16:throw t.prev=16,t.t0=t.catch(0),S("Ошибка инициализации компонентов: ".concat(t.t0.message)),t.t0;case 20:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(){return _.apply(this,arguments)})},{key:"loadResources",value:(i=g(w().mark((function t(){var e=this;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.ui.updateLoadingStatus("Инициализация физического движка..."),t.prev=1,t.next=4,this.physics.init();case 4:if(t.sent){t.next=7;break}throw new Error("Не удалось инициализировать физику");case 7:return this.ui.updateLoadingStatus("Физический движок инициализирован"),this.ui.updateLoadingStatus("Загрузка игровых ресурсов..."),t.next=11,new Promise((function(t){setTimeout((function(){e.state.isLoading=!1,t()}),1e3)}));case 11:return this.ui.updateLoadingStatus("Все ресурсы загружены успешно"),t.abrupt("return",!0);case 15:throw t.prev=15,t.t0=t.catch(1),S("Ошибка загрузки ресурсов: ".concat(t.t0.message)),t.t0;case 19:case"end":return t.stop()}}),t,this,[[1,15]])}))),function(){return i.apply(this,arguments)})},{key:"startGame",value:(r=g(w().mark((function t(){return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("🎮 GameCore: старт игры"),this.RAPIER=Game.RAPIER,console.log("🧪 this.RAPIER установлен:",this.RAPIER),t.prev=3,S("Запуск игры..."),this.ui.hideMainMenu(),this.ui.showGameScreen(),this.state.isRunning=!0,this.state.currentScene="game",this.renderer&&(this.renderer.setupScene(),S("Сцена настроена")),t.next=12,this.world.initialize();case 12:this.network.connect().then((function(){S("Подключено к серверу (прототип)")})).catch((function(t){S("Ошибка подключения: ".concat(t.message))})),this.lastFrameTime=performance.now(),requestAnimationFrame(this.update),S("Игра запущена"),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(3),S("Ошибка при запуске игры: ".concat(t.t0.message)),this.ui.showErrorScreen("Ошибка при запуске игры: ".concat(t.t0.message));case 22:case"end":return t.stop()}}),t,this,[[3,18]])}))),function(){return r.apply(this,arguments)})},{key:"fixedUpdate",value:function(t){try{this.network&&this.network.isConnected,this.world.fixedUpdate(t)}catch(t){S("Ошибка в fixedUpdate: ".concat(t.message))}}},{key:"update",value:function(t){if(this.state.isRunning)try{var e=performance.now(),r=(e-this.lastFrameTime)/1e3;this.lastFrameTime=e;var i=Math.min(r,.1);for(this.gameTime+=i,this.physicsAccumulator+=i;this.physicsAccumulator>=this.physicsUpdateRate;)this.physics&&this.physics.isReady()&&this.physics.update(this.physicsUpdateRate),this.fixedUpdate(this.physicsUpdateRate),this.physicsAccumulator-=this.physicsUpdateRate;this.world.update(i),this.renderer&&this.renderer.render(this.world.player),this.ui.update(),requestAnimationFrame(this.update)}catch(t){S("Ошибка в игровом цикле: ".concat(t.message)),requestAnimationFrame(this.update)}}}],e&&m(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,i,_,d}();i()}catch(R){i(R)}}))},157:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{Y:()=>n,x:()=>u});var n,o=r(5063),a=r(6410),s=r(6892),c=r(3218),l=r(7707),h=t([o,l,a,s,c]);[o,l,a,s,c]=h.then?(await h)():h,function(t){t[t.EXCLUDE_FIXED=1]="EXCLUDE_FIXED",t[t.EXCLUDE_KINEMATIC=2]="EXCLUDE_KINEMATIC",t[t.EXCLUDE_DYNAMIC=4]="EXCLUDE_DYNAMIC",t[t.EXCLUDE_SENSORS=8]="EXCLUDE_SENSORS",t[t.EXCLUDE_SOLIDS=16]="EXCLUDE_SOLIDS",t[t.ONLY_DYNAMIC=3]="ONLY_DYNAMIC",t[t.ONLY_KINEMATIC=5]="ONLY_KINEMATIC",t[t.ONLY_FIXED=6]="ONLY_FIXED"}(n||(n={}));class u{free(){this.raw&&this.raw.free(),this.raw=void 0}constructor(t){this.raw=t||new o.$1}update(t){this.raw.update(t.raw)}castRay(t,e,r,i,n,o,s,c,h,u){let _=l.if.intoRaw(r.origin),d=l.if.intoRaw(r.dir),p=a.OM.fromRaw(e,this.raw.castRay(t.raw,e.raw,_,d,i,n,o,s,c,h,u));return _.free(),d.free(),p}castRayAndGetNormal(t,e,r,i,n,o,s,c,h,u){let _=l.if.intoRaw(r.origin),d=l.if.intoRaw(r.dir),p=a.I0.fromRaw(e,this.raw.castRayAndGetNormal(t.raw,e.raw,_,d,i,n,o,s,c,h,u));return _.free(),d.free(),p}intersectionsWithRay(t,e,r,i,n,o,s,c,h,u,_){let d=l.if.intoRaw(r.origin),p=l.if.intoRaw(r.dir);this.raw.intersectionsWithRay(t.raw,e.raw,d,p,i,n,(t=>o(a.I0.fromRaw(e,t))),s,c,h,u,_),d.free(),p.free()}intersectionWithShape(t,e,r,i,n,o,a,s,c,h){let u=l.if.intoRaw(r),_=l.PB.intoRaw(i),d=n.intoRaw(),p=this.raw.intersectionWithShape(t.raw,e.raw,u,_,d,o,a,s,c,h);return u.free(),_.free(),d.free(),p}projectPoint(t,e,r,i,n,o,a,c,h){let u=l.if.intoRaw(r),_=s.U.fromRaw(e,this.raw.projectPoint(t.raw,e.raw,u,i,n,o,a,c,h));return u.free(),_}projectPointAndGetFeature(t,e,r,i,n,o,a,c){let h=l.if.intoRaw(r),u=s.U.fromRaw(e,this.raw.projectPointAndGetFeature(t.raw,e.raw,h,i,n,o,a,c));return h.free(),u}intersectionsWithPoint(t,e,r,i,n,o,a,s,c){let h=l.if.intoRaw(r);this.raw.intersectionsWithPoint(t.raw,e.raw,h,i,n,o,a,s,c),h.free()}castShape(t,e,r,i,n,o,a,s,h,u,_,d,p,w){let f=l.if.intoRaw(r),g=l.PB.intoRaw(i),y=l.if.intoRaw(n),m=o.intoRaw(),b=c.k.fromRaw(e,this.raw.castShape(t.raw,e.raw,f,g,y,m,a,s,h,u,_,d,p,w));return f.free(),g.free(),y.free(),m.free(),b}intersectionsWithShape(t,e,r,i,n,o,a,s,c,h,u){let _=l.if.intoRaw(r),d=l.PB.intoRaw(i),p=n.intoRaw();this.raw.intersectionsWithShape(t.raw,e.raw,_,d,p,o,a,s,c,h,u),_.free(),d.free(),p.free()}collidersWithAabbIntersectingAabb(t,e,r){let i=l.if.intoRaw(t),n=l.if.intoRaw(e);this.raw.collidersWithAabbIntersectingAabb(i,n,r),i.free(),n.free()}}i()}catch(t){i(t)}}))},216:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{Am:()=>_.A,CA:()=>s.CA,DO:()=>s.DO,Dr:()=>a.D,O9:()=>h.O,Om:()=>n.Om,Po:()=>s.Po,Qm:()=>s.Qm,Qz:()=>s.Qz,Rc:()=>s.Rc,Ux:()=>n.Ux,Vk:()=>n.Vk,Vn:()=>s.Vn,a7:()=>s.a7,c$:()=>l.c$,eB:()=>l.eB,eN:()=>s.eN,eQ:()=>c.e,f5:()=>u.f,ik:()=>s.ik,kn:()=>o.k,p9:()=>l.p9,qe:()=>l.qe,rA:()=>s.rA,ux:()=>s.ux,vH:()=>s.vH,xt:()=>d.x,y:()=>l.y,yB:()=>l.yB});var n=r(2210),o=r(7245),a=r(5081),s=r(8424),c=r(3211),l=r(9726),h=r(2337),u=r(360),_=r(6554),d=r(5551),p=t([n,o,a,s,c,l,h,_,d]);[n,o,a,s,c,l,h,_,d]=p.then?(await p)():p,i()}catch(t){i(t)}}))},360:(t,e,r)=>{var i;r.d(e,{f:()=>i}),function(t){t[t.Average=0]="Average",t[t.Min=1]="Min",t[t.Multiply=2]="Multiply",t[t.Max=3]="Max"}(i||(i={}))},983:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{B:()=>a,e:()=>s});var n=r(5063),o=t([n]);n=(o.then?(await o)():o)[0];class a{constructor(t,e){this.vertices=t,this.colors=e}}class s{free(){this.raw&&this.raw.free(),this.raw=void 0,this.vertices=void 0,this.colors=void 0}constructor(t){this.raw=t||new n.md}render(t,e,r,i,n){this.raw.render(t.raw,e.raw,r.raw,i.raw,n.raw),this.vertices=this.raw.vertices(),this.colors=this.raw.colors()}}i()}catch(t){i(t)}}))},1020:(t,e,r)=>{let i;function n(t){i=t}r.d(e,{$1:()=>xt,$M:()=>Ft,BK:()=>ie,BX:()=>Z,FH:()=>Xt,FJ:()=>it,HB:()=>ce,I$:()=>jt,KH:()=>Vt,NL:()=>H,Nh:()=>le,PR:()=>he,Pu:()=>I,Py:()=>ue,QR:()=>de,Qn:()=>we,Ry:()=>ut,Sn:()=>mt,Y6:()=>j,YK:()=>dt,aF:()=>M,aN:()=>oe,bk:()=>pe,c6:()=>$t,co:()=>Nt,eI:()=>te,eW:()=>O,hI:()=>re,ih:()=>ae,lI:()=>n,m3:()=>T,m7:()=>et,md:()=>X,nF:()=>ne,pi:()=>Ht,pv:()=>Zt,qj:()=>F,rE:()=>g,sR:()=>Qt,sW:()=>_e,vV:()=>ee,w9:()=>Yt,wT:()=>ot,xH:()=>Kt,xW:()=>st,xm:()=>wt,yJ:()=>se,yK:()=>gt,z2:()=>lt}),t=r.hmd(t);const o=new Array(128).fill(void 0);function a(t){return o[t]}o.push(void 0,null,!0,!1);let s=o.length;function c(t){s===o.length&&o.push(o.length+1);const e=s;return s=o[e],o[e]=t,e}function l(t,e){try{return t.apply(this,e)}catch(t){i.__wbindgen_export_0(c(t))}}function h(t){return null==t}let u=null;function _(){return(null===u||!0===u.buffer.detached||void 0===u.buffer.detached&&u.buffer!==i.memory.buffer)&&(u=new DataView(i.memory.buffer)),u}function d(t){const e=a(t);return function(t){t<132||(o[t]=s,s=t)}(t),e}let p=new("undefined"==typeof TextDecoder?(0,t.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});p.decode();let w=null;function f(t,e){return t>>>=0,p.decode((null!==w&&0!==w.byteLength||(w=new Uint8Array(i.memory.buffer)),w).subarray(t,t+e))}function g(){let t,e;try{const o=i.__wbindgen_add_to_stack_pointer(-16);i.version(o);var r=_().getInt32(o+0,!0),n=_().getInt32(o+4,!0);return t=r,e=n,f(r,n)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_export_1(t,e,1)}}function y(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`)}let m=128;function b(t){if(1==m)throw new Error("out of js stack");return o[--m]=t,m}let v=null;function S(){return null!==v&&0!==v.byteLength||(v=new Float32Array(i.memory.buffer)),v}function R(t,e){return t>>>=0,S().subarray(t/4,t/4+e)}let E=null;function x(){return null!==E&&0!==E.byteLength||(E=new Uint32Array(i.memory.buffer)),E}let C=0;function P(t,e){const r=e(4*t.length,4)>>>0;return S().set(t,r/4),C=t.length,r}function k(t,e){const r=e(4*t.length,4)>>>0;return x().set(t,r/4),C=t.length,r}Object.freeze({Vertex:0,0:"Vertex",Edge:1,1:"Edge",Face:2,2:"Face",Unknown:3,3:"Unknown"});const M=Object.freeze({LinX:0,0:"LinX",LinY:1,1:"LinY",LinZ:2,2:"LinZ",AngX:3,3:"AngX",AngY:4,4:"AngY",AngZ:5,5:"AngZ"}),I=Object.freeze({Revolute:0,0:"Revolute",Fixed:1,1:"Fixed",Prismatic:2,2:"Prismatic",Rope:3,3:"Rope",Spring:4,4:"Spring",Spherical:5,5:"Spherical",Generic:6,6:"Generic"}),T=(Object.freeze({AccelerationBased:0,0:"AccelerationBased",ForceBased:1,1:"ForceBased"}),Object.freeze({Dynamic:0,0:"Dynamic",Fixed:1,1:"Fixed",KinematicPositionBased:2,2:"KinematicPositionBased",KinematicVelocityBased:3,3:"KinematicVelocityBased"}),Object.freeze({Ball:0,0:"Ball",Cuboid:1,1:"Cuboid",Capsule:2,2:"Capsule",Segment:3,3:"Segment",Polyline:4,4:"Polyline",Triangle:5,5:"Triangle",TriMesh:6,6:"TriMesh",HeightField:7,7:"HeightField",Compound:8,8:"Compound",ConvexPolyhedron:9,9:"ConvexPolyhedron",Cylinder:10,10:"Cylinder",Cone:11,11:"Cone",RoundCuboid:12,12:"RoundCuboid",RoundTriangle:13,13:"RoundTriangle",RoundCylinder:14,14:"RoundCylinder",RoundCone:15,15:"RoundCone",RoundConvexPolyhedron:16,16:"RoundConvexPolyhedron",HalfSpace:17,17:"HalfSpace"})),A="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawbroadphase_free(t>>>0,1)));class j{static __wrap(t){t>>>=0;const e=Object.create(j.prototype);return e.__wbg_ptr=t,A.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,A.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawbroadphase_free(t,0)}constructor(){const t=i.rawbroadphase_new();return this.__wbg_ptr=t>>>0,A.register(this,this.__wbg_ptr,this),this}}const L="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawccdsolver_free(t>>>0,1)));class F{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,L.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawccdsolver_free(t,0)}constructor(){const t=i.rawccdsolver_new();return this.__wbg_ptr=t>>>0,L.register(this,this.__wbg_ptr,this),this}}const z="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawcharactercollision_free(t>>>0,1)));class O{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,z.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawcharactercollision_free(t,0)}constructor(){const t=i.rawcharactercollision_new();return this.__wbg_ptr=t>>>0,z.register(this,this.__wbg_ptr,this),this}handle(){return i.rawcharactercollision_handle(this.__wbg_ptr)}translationDeltaApplied(){const t=i.rawcharactercollision_translationDeltaApplied(this.__wbg_ptr);return Vt.__wrap(t)}translationDeltaRemaining(){const t=i.rawcharactercollision_translationDeltaRemaining(this.__wbg_ptr);return Vt.__wrap(t)}toi(){return i.rawcharactercollision_toi(this.__wbg_ptr)}worldWitness1(){const t=i.rawcharactercollision_worldWitness1(this.__wbg_ptr);return Vt.__wrap(t)}worldWitness2(){const t=i.rawcharactercollision_worldWitness2(this.__wbg_ptr);return Vt.__wrap(t)}worldNormal1(){const t=i.rawcharactercollision_worldNormal1(this.__wbg_ptr);return Vt.__wrap(t)}worldNormal2(){const t=i.rawcharactercollision_worldNormal2(this.__wbg_ptr);return Vt.__wrap(t)}}const D="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawcolliderset_free(t>>>0,1)));class H{static __wrap(t){t>>>=0;const e=Object.create(H.prototype);return e.__wbg_ptr=t,D.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,D.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawcolliderset_free(t,0)}coTranslation(t){const e=i.rawcolliderset_coTranslation(this.__wbg_ptr,t);return Vt.__wrap(e)}coRotation(t){const e=i.rawcolliderset_coRotation(this.__wbg_ptr,t);return Ft.__wrap(e)}coSetTranslation(t,e,r,n){i.rawcolliderset_coSetTranslation(this.__wbg_ptr,t,e,r,n)}coSetTranslationWrtParent(t,e,r,n){i.rawcolliderset_coSetTranslationWrtParent(this.__wbg_ptr,t,e,r,n)}coSetRotation(t,e,r,n,o){i.rawcolliderset_coSetRotation(this.__wbg_ptr,t,e,r,n,o)}coSetRotationWrtParent(t,e,r,n,o){i.rawcolliderset_coSetRotationWrtParent(this.__wbg_ptr,t,e,r,n,o)}coIsSensor(t){return 0!==i.rawcolliderset_coIsSensor(this.__wbg_ptr,t)}coShapeType(t){return i.rawcolliderset_coShapeType(this.__wbg_ptr,t)}coHalfspaceNormal(t){const e=i.rawcolliderset_coHalfspaceNormal(this.__wbg_ptr,t);return 0===e?void 0:Vt.__wrap(e)}coHalfExtents(t){const e=i.rawcolliderset_coHalfExtents(this.__wbg_ptr,t);return 0===e?void 0:Vt.__wrap(e)}coSetHalfExtents(t,e){y(e,Vt),i.rawcolliderset_coSetHalfExtents(this.__wbg_ptr,t,e.__wbg_ptr)}coRadius(t){const e=i.rawcolliderset_coRadius(this.__wbg_ptr,t);return 4294967297===e?void 0:e}coSetRadius(t,e){i.rawcolliderset_coSetRadius(this.__wbg_ptr,t,e)}coHalfHeight(t){const e=i.rawcolliderset_coHalfHeight(this.__wbg_ptr,t);return 4294967297===e?void 0:e}coSetHalfHeight(t,e){i.rawcolliderset_coSetHalfHeight(this.__wbg_ptr,t,e)}coRoundRadius(t){const e=i.rawcolliderset_coRoundRadius(this.__wbg_ptr,t);return 4294967297===e?void 0:e}coSetRoundRadius(t,e){i.rawcolliderset_coSetRoundRadius(this.__wbg_ptr,t,e)}coVertices(t){try{const n=i.__wbindgen_add_to_stack_pointer(-16);i.rawcolliderset_coVertices(n,this.__wbg_ptr,t);var e=_().getInt32(n+0,!0),r=_().getInt32(n+4,!0);let o;return 0!==e&&(o=R(e,r).slice(),i.__wbindgen_export_1(e,4*r,4)),o}finally{i.__wbindgen_add_to_stack_pointer(16)}}coIndices(t){try{const a=i.__wbindgen_add_to_stack_pointer(-16);i.rawcolliderset_coIndices(a,this.__wbg_ptr,t);var e=_().getInt32(a+0,!0),r=_().getInt32(a+4,!0);let s;return 0!==e&&(s=(n=e,o=r,n>>>=0,x().subarray(n/4,n/4+o)).slice(),i.__wbindgen_export_1(e,4*r,4)),s}finally{i.__wbindgen_add_to_stack_pointer(16)}var n,o}coTriMeshFlags(t){const e=i.rawcolliderset_coTriMeshFlags(this.__wbg_ptr,t);return 4294967297===e?void 0:e}coHeightFieldFlags(t){const e=i.rawcolliderset_coHeightFieldFlags(this.__wbg_ptr,t);return 4294967297===e?void 0:e}coHeightfieldHeights(t){try{const n=i.__wbindgen_add_to_stack_pointer(-16);i.rawcolliderset_coHeightfieldHeights(n,this.__wbg_ptr,t);var e=_().getInt32(n+0,!0),r=_().getInt32(n+4,!0);let o;return 0!==e&&(o=R(e,r).slice(),i.__wbindgen_export_1(e,4*r,4)),o}finally{i.__wbindgen_add_to_stack_pointer(16)}}coHeightfieldScale(t){const e=i.rawcolliderset_coHeightfieldScale(this.__wbg_ptr,t);return 0===e?void 0:Vt.__wrap(e)}coHeightfieldNRows(t){const e=i.rawcolliderset_coHeightfieldNRows(this.__wbg_ptr,t);return 4294967297===e?void 0:e}coHeightfieldNCols(t){const e=i.rawcolliderset_coHeightfieldNCols(this.__wbg_ptr,t);return 4294967297===e?void 0:e}coParent(t){try{const n=i.__wbindgen_add_to_stack_pointer(-16);i.rawcolliderset_coParent(n,this.__wbg_ptr,t);var e=_().getInt32(n+0,!0),r=_().getFloat64(n+8,!0);return 0===e?void 0:r}finally{i.__wbindgen_add_to_stack_pointer(16)}}coSetEnabled(t,e){i.rawcolliderset_coSetEnabled(this.__wbg_ptr,t,e)}coIsEnabled(t){return 0!==i.rawcolliderset_coIsEnabled(this.__wbg_ptr,t)}coSetContactSkin(t,e){i.rawcolliderset_coSetContactSkin(this.__wbg_ptr,t,e)}coContactSkin(t){return i.rawcolliderset_coContactSkin(this.__wbg_ptr,t)}coFriction(t){return i.rawcolliderset_coFriction(this.__wbg_ptr,t)}coRestitution(t){return i.rawcolliderset_coRestitution(this.__wbg_ptr,t)}coDensity(t){return i.rawcolliderset_coDensity(this.__wbg_ptr,t)}coMass(t){return i.rawcolliderset_coMass(this.__wbg_ptr,t)}coVolume(t){return i.rawcolliderset_coVolume(this.__wbg_ptr,t)}coCollisionGroups(t){return i.rawcolliderset_coCollisionGroups(this.__wbg_ptr,t)>>>0}coSolverGroups(t){return i.rawcolliderset_coSolverGroups(this.__wbg_ptr,t)>>>0}coActiveHooks(t){return i.rawcolliderset_coActiveHooks(this.__wbg_ptr,t)>>>0}coActiveCollisionTypes(t){return i.rawcolliderset_coActiveCollisionTypes(this.__wbg_ptr,t)}coActiveEvents(t){return i.rawcolliderset_coActiveEvents(this.__wbg_ptr,t)>>>0}coContactForceEventThreshold(t){return i.rawcolliderset_coContactForceEventThreshold(this.__wbg_ptr,t)}coContainsPoint(t,e){return y(e,Vt),0!==i.rawcolliderset_coContainsPoint(this.__wbg_ptr,t,e.__wbg_ptr)}coCastShape(t,e,r,n,o,a,s,c,l){y(e,Vt),y(r,Nt),y(n,Vt),y(o,Ft),y(a,Vt);const h=i.rawcolliderset_coCastShape(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o.__wbg_ptr,a.__wbg_ptr,s,c,l);return 0===h?void 0:Wt.__wrap(h)}coCastCollider(t,e,r,n,o,a,s){y(e,Vt),y(n,Vt);const c=i.rawcolliderset_coCastCollider(this.__wbg_ptr,t,e.__wbg_ptr,r,n.__wbg_ptr,o,a,s);return 0===c?void 0:N.__wrap(c)}coIntersectsShape(t,e,r,n){return y(e,Nt),y(r,Vt),y(n,Ft),0!==i.rawcolliderset_coIntersectsShape(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr)}coContactShape(t,e,r,n,o){y(e,Nt),y(r,Vt),y(n,Ft);const a=i.rawcolliderset_coContactShape(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o);return 0===a?void 0:qt.__wrap(a)}coContactCollider(t,e,r){const n=i.rawcolliderset_coContactCollider(this.__wbg_ptr,t,e,r);return 0===n?void 0:qt.__wrap(n)}coProjectPoint(t,e,r){y(e,Vt);const n=i.rawcolliderset_coProjectPoint(this.__wbg_ptr,t,e.__wbg_ptr,r);return Rt.__wrap(n)}coIntersectsRay(t,e,r,n){return y(e,Vt),y(r,Vt),0!==i.rawcolliderset_coIntersectsRay(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n)}coCastRay(t,e,r,n,o){return y(e,Vt),y(r,Vt),i.rawcolliderset_coCastRay(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n,o)}coCastRayAndGetNormal(t,e,r,n,o){y(e,Vt),y(r,Vt);const a=i.rawcolliderset_coCastRayAndGetNormal(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n,o);return 0===a?void 0:Tt.__wrap(a)}coSetSensor(t,e){i.rawcolliderset_coSetSensor(this.__wbg_ptr,t,e)}coSetRestitution(t,e){i.rawcolliderset_coSetRestitution(this.__wbg_ptr,t,e)}coSetFriction(t,e){i.rawcolliderset_coSetFriction(this.__wbg_ptr,t,e)}coFrictionCombineRule(t){return i.rawcolliderset_coFrictionCombineRule(this.__wbg_ptr,t)>>>0}coSetFrictionCombineRule(t,e){i.rawcolliderset_coSetFrictionCombineRule(this.__wbg_ptr,t,e)}coRestitutionCombineRule(t){return i.rawcolliderset_coRestitutionCombineRule(this.__wbg_ptr,t)>>>0}coSetRestitutionCombineRule(t,e){i.rawcolliderset_coSetRestitutionCombineRule(this.__wbg_ptr,t,e)}coSetCollisionGroups(t,e){i.rawcolliderset_coSetCollisionGroups(this.__wbg_ptr,t,e)}coSetSolverGroups(t,e){i.rawcolliderset_coSetSolverGroups(this.__wbg_ptr,t,e)}coSetActiveHooks(t,e){i.rawcolliderset_coSetActiveHooks(this.__wbg_ptr,t,e)}coSetActiveEvents(t,e){i.rawcolliderset_coSetActiveEvents(this.__wbg_ptr,t,e)}coSetActiveCollisionTypes(t,e){i.rawcolliderset_coSetActiveCollisionTypes(this.__wbg_ptr,t,e)}coSetShape(t,e){y(e,Nt),i.rawcolliderset_coSetShape(this.__wbg_ptr,t,e.__wbg_ptr)}coSetContactForceEventThreshold(t,e){i.rawcolliderset_coSetContactForceEventThreshold(this.__wbg_ptr,t,e)}coSetDensity(t,e){i.rawcolliderset_coSetDensity(this.__wbg_ptr,t,e)}coSetMass(t,e){i.rawcolliderset_coSetMass(this.__wbg_ptr,t,e)}coSetMassProperties(t,e,r,n,o){y(r,Vt),y(n,Vt),y(o,Ft),i.rawcolliderset_coSetMassProperties(this.__wbg_ptr,t,e,r.__wbg_ptr,n.__wbg_ptr,o.__wbg_ptr)}constructor(){const t=i.rawcolliderset_new();return this.__wbg_ptr=t>>>0,D.register(this,this.__wbg_ptr,this),this}len(){return i.rawcolliderset_len(this.__wbg_ptr)>>>0}contains(t){return 0!==i.rawcolliderset_contains(this.__wbg_ptr,t)}createCollider(t,e,r,n,o,a,s,c,l,h,u,d,p,w,f,g,m,b,v,S,R,E,x,C,P){try{const I=i.__wbindgen_add_to_stack_pointer(-16);y(e,Nt),y(r,Vt),y(n,Ft),y(s,Vt),y(c,Vt),y(l,Ft),y(P,jt),i.rawcolliderset_createCollider(I,this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o,a,s.__wbg_ptr,c.__wbg_ptr,l.__wbg_ptr,h,u,d,p,w,f,g,m,b,v,S,R,E,x,C,P.__wbg_ptr);var k=_().getInt32(I+0,!0),M=_().getFloat64(I+8,!0);return 0===k?void 0:M}finally{i.__wbindgen_add_to_stack_pointer(16)}}remove(t,e,r,n){y(e,lt),y(r,jt),i.rawcolliderset_remove(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n)}isHandleValid(t){return 0!==i.rawcolliderset_contains(this.__wbg_ptr,t)}forEachColliderHandle(t){try{i.rawcolliderset_forEachColliderHandle(this.__wbg_ptr,b(t))}finally{o[m++]=void 0}}}const B="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawcollidershapecasthit_free(t>>>0,1)));class N{static __wrap(t){t>>>=0;const e=Object.create(N.prototype);return e.__wbg_ptr=t,B.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,B.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawcollidershapecasthit_free(t,0)}colliderHandle(){return i.rawcharactercollision_handle(this.__wbg_ptr)}time_of_impact(){return i.rawcollidershapecasthit_time_of_impact(this.__wbg_ptr)}witness1(){const t=i.rawcollidershapecasthit_witness1(this.__wbg_ptr);return Vt.__wrap(t)}witness2(){const t=i.rawcollidershapecasthit_witness2(this.__wbg_ptr);return Vt.__wrap(t)}normal1(){const t=i.rawcharactercollision_translationDeltaApplied(this.__wbg_ptr);return Vt.__wrap(t)}normal2(){const t=i.rawcharactercollision_translationDeltaRemaining(this.__wbg_ptr);return Vt.__wrap(t)}}const G="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawcontactforceevent_free(t>>>0,1)));class W{static __wrap(t){t>>>=0;const e=Object.create(W.prototype);return e.__wbg_ptr=t,G.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,G.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawcontactforceevent_free(t,0)}collider1(){return i.rawcharactercollision_handle(this.__wbg_ptr)}collider2(){return i.rawcontactforceevent_collider2(this.__wbg_ptr)}total_force(){const t=i.rawcontactforceevent_total_force(this.__wbg_ptr);return Vt.__wrap(t)}total_force_magnitude(){return i.rawcontactforceevent_total_force_magnitude(this.__wbg_ptr)}max_force_direction(){const t=i.rawcontactforceevent_max_force_direction(this.__wbg_ptr);return Vt.__wrap(t)}max_force_magnitude(){return i.rawcontactforceevent_max_force_magnitude(this.__wbg_ptr)}}const J="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawcontactmanifold_free(t>>>0,1)));class q{static __wrap(t){t>>>=0;const e=Object.create(q.prototype);return e.__wbg_ptr=t,J.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,J.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawcontactmanifold_free(t,0)}normal(){const t=i.rawcontactmanifold_normal(this.__wbg_ptr);return Vt.__wrap(t)}local_n1(){const t=i.rawcontactmanifold_local_n1(this.__wbg_ptr);return Vt.__wrap(t)}local_n2(){const t=i.rawcontactmanifold_local_n2(this.__wbg_ptr);return Vt.__wrap(t)}subshape1(){return i.rawcontactmanifold_subshape1(this.__wbg_ptr)>>>0}subshape2(){return i.rawcontactmanifold_subshape2(this.__wbg_ptr)>>>0}num_contacts(){return i.rawcontactmanifold_num_contacts(this.__wbg_ptr)>>>0}contact_local_p1(t){const e=i.rawcontactmanifold_contact_local_p1(this.__wbg_ptr,t);return 0===e?void 0:Vt.__wrap(e)}contact_local_p2(t){const e=i.rawcontactmanifold_contact_local_p2(this.__wbg_ptr,t);return 0===e?void 0:Vt.__wrap(e)}contact_dist(t){return i.rawcontactmanifold_contact_dist(this.__wbg_ptr,t)}contact_fid1(t){return i.rawcontactmanifold_contact_fid1(this.__wbg_ptr,t)>>>0}contact_fid2(t){return i.rawcontactmanifold_contact_fid2(this.__wbg_ptr,t)>>>0}contact_impulse(t){return i.rawcontactmanifold_contact_impulse(this.__wbg_ptr,t)}contact_tangent_impulse_x(t){return i.rawcontactmanifold_contact_tangent_impulse_x(this.__wbg_ptr,t)}contact_tangent_impulse_y(t){return i.rawcontactmanifold_contact_tangent_impulse_y(this.__wbg_ptr,t)}num_solver_contacts(){return i.rawcontactmanifold_num_solver_contacts(this.__wbg_ptr)>>>0}solver_contact_point(t){const e=i.rawcontactmanifold_solver_contact_point(this.__wbg_ptr,t);return 0===e?void 0:Vt.__wrap(e)}solver_contact_dist(t){return i.rawcontactmanifold_solver_contact_dist(this.__wbg_ptr,t)}solver_contact_friction(t){return i.rawcontactmanifold_solver_contact_friction(this.__wbg_ptr,t)}solver_contact_restitution(t){return i.rawcontactmanifold_solver_contact_restitution(this.__wbg_ptr,t)}solver_contact_tangent_velocity(t){const e=i.rawcontactmanifold_solver_contact_tangent_velocity(this.__wbg_ptr,t);return Vt.__wrap(e)}}const U="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawcontactpair_free(t>>>0,1)));class V{static __wrap(t){t>>>=0;const e=Object.create(V.prototype);return e.__wbg_ptr=t,U.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,U.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawcontactpair_free(t,0)}collider1(){return i.rawcontactpair_collider1(this.__wbg_ptr)}collider2(){return i.rawcontactpair_collider2(this.__wbg_ptr)}numContactManifolds(){return i.rawcontactpair_numContactManifolds(this.__wbg_ptr)>>>0}contactManifold(t){const e=i.rawcontactpair_contactManifold(this.__wbg_ptr,t);return 0===e?void 0:q.__wrap(e)}}const K="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawdebugrenderpipeline_free(t>>>0,1)));class X{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,K.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawdebugrenderpipeline_free(t,0)}constructor(){const t=i.rawdebugrenderpipeline_new();return this.__wbg_ptr=t>>>0,K.register(this,this.__wbg_ptr,this),this}vertices(){return d(i.rawdebugrenderpipeline_vertices(this.__wbg_ptr))}colors(){return d(i.rawdebugrenderpipeline_colors(this.__wbg_ptr))}render(t,e,r,n,o){y(t,jt),y(e,H),y(r,ot),y(n,dt),y(o,wt),i.rawdebugrenderpipeline_render(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o.__wbg_ptr)}}const Y="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawdeserializedworld_free(t>>>0,1)));class Q{static __wrap(t){t>>>=0;const e=Object.create(Q.prototype);return e.__wbg_ptr=t,Y.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Y.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawdeserializedworld_free(t,0)}takeGravity(){const t=i.rawdeserializedworld_takeGravity(this.__wbg_ptr);return 0===t?void 0:Vt.__wrap(t)}takeIntegrationParameters(){const t=i.rawdeserializedworld_takeIntegrationParameters(this.__wbg_ptr);return 0===t?void 0:st.__wrap(t)}takeIslandManager(){const t=i.rawdeserializedworld_takeIslandManager(this.__wbg_ptr);return 0===t?void 0:lt.__wrap(t)}takeBroadPhase(){const t=i.rawdeserializedworld_takeBroadPhase(this.__wbg_ptr);return 0===t?void 0:j.__wrap(t)}takeNarrowPhase(){const t=i.rawdeserializedworld_takeNarrowPhase(this.__wbg_ptr);return 0===t?void 0:wt.__wrap(t)}takeBodies(){const t=i.rawdeserializedworld_takeBodies(this.__wbg_ptr);return 0===t?void 0:jt.__wrap(t)}takeColliders(){const t=i.rawdeserializedworld_takeColliders(this.__wbg_ptr);return 0===t?void 0:H.__wrap(t)}takeImpulseJoints(){const t=i.rawdeserializedworld_takeImpulseJoints(this.__wbg_ptr);return 0===t?void 0:ot.__wrap(t)}takeMultibodyJoints(){const t=i.rawdeserializedworld_takeMultibodyJoints(this.__wbg_ptr);return 0===t?void 0:dt.__wrap(t)}}const $="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawdynamicraycastvehiclecontroller_free(t>>>0,1)));class Z{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,$.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawdynamicraycastvehiclecontroller_free(t,0)}constructor(t){const e=i.rawdynamicraycastvehiclecontroller_new(t);return this.__wbg_ptr=e>>>0,$.register(this,this.__wbg_ptr,this),this}current_vehicle_speed(){return i.rawdynamicraycastvehiclecontroller_current_vehicle_speed(this.__wbg_ptr)}chassis(){return i.rawdynamicraycastvehiclecontroller_chassis(this.__wbg_ptr)}index_up_axis(){return i.rawdynamicraycastvehiclecontroller_index_up_axis(this.__wbg_ptr)>>>0}set_index_up_axis(t){i.rawdynamicraycastvehiclecontroller_set_index_up_axis(this.__wbg_ptr,t)}index_forward_axis(){return i.rawdynamicraycastvehiclecontroller_index_forward_axis(this.__wbg_ptr)>>>0}set_index_forward_axis(t){i.rawdynamicraycastvehiclecontroller_set_index_forward_axis(this.__wbg_ptr,t)}add_wheel(t,e,r,n,o){y(t,Vt),y(e,Vt),y(r,Vt),i.rawdynamicraycastvehiclecontroller_add_wheel(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n,o)}num_wheels(){return i.rawdynamicraycastvehiclecontroller_num_wheels(this.__wbg_ptr)>>>0}update_vehicle(t,e,r,n,a,s,c){try{y(e,jt),y(r,H),y(n,xt),i.rawdynamicraycastvehiclecontroller_update_vehicle(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,a,h(s)?4294967297:s>>>0,b(c))}finally{o[m++]=void 0}}wheel_chassis_connection_point_cs(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_chassis_connection_point_cs(this.__wbg_ptr,t);return 0===e?void 0:Vt.__wrap(e)}set_wheel_chassis_connection_point_cs(t,e){y(e,Vt),i.rawdynamicraycastvehiclecontroller_set_wheel_chassis_connection_point_cs(this.__wbg_ptr,t,e.__wbg_ptr)}wheel_suspension_rest_length(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_suspension_rest_length(this.__wbg_ptr,t);return 4294967297===e?void 0:e}set_wheel_suspension_rest_length(t,e){i.rawdynamicraycastvehiclecontroller_set_wheel_suspension_rest_length(this.__wbg_ptr,t,e)}wheel_max_suspension_travel(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_max_suspension_travel(this.__wbg_ptr,t);return 4294967297===e?void 0:e}set_wheel_max_suspension_travel(t,e){i.rawdynamicraycastvehiclecontroller_set_wheel_max_suspension_travel(this.__wbg_ptr,t,e)}wheel_radius(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_radius(this.__wbg_ptr,t);return 4294967297===e?void 0:e}set_wheel_radius(t,e){i.rawdynamicraycastvehiclecontroller_set_wheel_radius(this.__wbg_ptr,t,e)}wheel_suspension_stiffness(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_suspension_stiffness(this.__wbg_ptr,t);return 4294967297===e?void 0:e}set_wheel_suspension_stiffness(t,e){i.rawdynamicraycastvehiclecontroller_set_wheel_suspension_stiffness(this.__wbg_ptr,t,e)}wheel_suspension_compression(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_suspension_compression(this.__wbg_ptr,t);return 4294967297===e?void 0:e}set_wheel_suspension_compression(t,e){i.rawdynamicraycastvehiclecontroller_set_wheel_suspension_compression(this.__wbg_ptr,t,e)}wheel_suspension_relaxation(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_suspension_relaxation(this.__wbg_ptr,t);return 4294967297===e?void 0:e}set_wheel_suspension_relaxation(t,e){i.rawdynamicraycastvehiclecontroller_set_wheel_suspension_relaxation(this.__wbg_ptr,t,e)}wheel_max_suspension_force(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_max_suspension_force(this.__wbg_ptr,t);return 4294967297===e?void 0:e}set_wheel_max_suspension_force(t,e){i.rawdynamicraycastvehiclecontroller_set_wheel_max_suspension_force(this.__wbg_ptr,t,e)}wheel_brake(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_brake(this.__wbg_ptr,t);return 4294967297===e?void 0:e}set_wheel_brake(t,e){i.rawdynamicraycastvehiclecontroller_set_wheel_brake(this.__wbg_ptr,t,e)}wheel_steering(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_steering(this.__wbg_ptr,t);return 4294967297===e?void 0:e}set_wheel_steering(t,e){i.rawdynamicraycastvehiclecontroller_set_wheel_steering(this.__wbg_ptr,t,e)}wheel_engine_force(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_engine_force(this.__wbg_ptr,t);return 4294967297===e?void 0:e}set_wheel_engine_force(t,e){i.rawdynamicraycastvehiclecontroller_set_wheel_engine_force(this.__wbg_ptr,t,e)}wheel_direction_cs(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_direction_cs(this.__wbg_ptr,t);return 0===e?void 0:Vt.__wrap(e)}set_wheel_direction_cs(t,e){y(e,Vt),i.rawdynamicraycastvehiclecontroller_set_wheel_direction_cs(this.__wbg_ptr,t,e.__wbg_ptr)}wheel_axle_cs(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_axle_cs(this.__wbg_ptr,t);return 0===e?void 0:Vt.__wrap(e)}set_wheel_axle_cs(t,e){y(e,Vt),i.rawdynamicraycastvehiclecontroller_set_wheel_axle_cs(this.__wbg_ptr,t,e.__wbg_ptr)}wheel_friction_slip(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_friction_slip(this.__wbg_ptr,t);return 4294967297===e?void 0:e}set_wheel_friction_slip(t,e){i.rawdynamicraycastvehiclecontroller_set_wheel_friction_slip(this.__wbg_ptr,t,e)}wheel_side_friction_stiffness(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_side_friction_stiffness(this.__wbg_ptr,t);return 4294967297===e?void 0:e}set_wheel_side_friction_stiffness(t,e){i.rawdynamicraycastvehiclecontroller_set_wheel_side_friction_stiffness(this.__wbg_ptr,t,e)}wheel_rotation(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_rotation(this.__wbg_ptr,t);return 4294967297===e?void 0:e}wheel_forward_impulse(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_forward_impulse(this.__wbg_ptr,t);return 4294967297===e?void 0:e}wheel_side_impulse(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_side_impulse(this.__wbg_ptr,t);return 4294967297===e?void 0:e}wheel_suspension_force(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_suspension_force(this.__wbg_ptr,t);return 4294967297===e?void 0:e}wheel_contact_normal_ws(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_contact_normal_ws(this.__wbg_ptr,t);return 0===e?void 0:Vt.__wrap(e)}wheel_contact_point_ws(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_contact_point_ws(this.__wbg_ptr,t);return 0===e?void 0:Vt.__wrap(e)}wheel_suspension_length(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_suspension_length(this.__wbg_ptr,t);return 4294967297===e?void 0:e}wheel_hard_point_ws(t){const e=i.rawdynamicraycastvehiclecontroller_wheel_hard_point_ws(this.__wbg_ptr,t);return 0===e?void 0:Vt.__wrap(e)}wheel_is_in_contact(t){return 0!==i.rawdynamicraycastvehiclecontroller_wheel_is_in_contact(this.__wbg_ptr,t)}wheel_ground_object(t){try{const n=i.__wbindgen_add_to_stack_pointer(-16);i.rawdynamicraycastvehiclecontroller_wheel_ground_object(n,this.__wbg_ptr,t);var e=_().getInt32(n+0,!0),r=_().getFloat64(n+8,!0);return 0===e?void 0:r}finally{i.__wbindgen_add_to_stack_pointer(16)}}}const tt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_raweventqueue_free(t>>>0,1)));class et{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,tt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_raweventqueue_free(t,0)}constructor(t){const e=i.raweventqueue_new(t);return this.__wbg_ptr=e>>>0,tt.register(this,this.__wbg_ptr,this),this}drainCollisionEvents(t){try{i.raweventqueue_drainCollisionEvents(this.__wbg_ptr,b(t))}finally{o[m++]=void 0}}drainContactForceEvents(t){try{i.raweventqueue_drainContactForceEvents(this.__wbg_ptr,b(t))}finally{o[m++]=void 0}}clear(){i.raweventqueue_clear(this.__wbg_ptr)}}const rt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawgenericjoint_free(t>>>0,1)));class it{static __wrap(t){t>>>=0;const e=Object.create(it.prototype);return e.__wbg_ptr=t,rt.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,rt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawgenericjoint_free(t,0)}static generic(t,e,r,n){y(t,Vt),y(e,Vt),y(r,Vt);const o=i.rawgenericjoint_generic(t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n);return 0===o?void 0:it.__wrap(o)}static spring(t,e,r,n,o){y(n,Vt),y(o,Vt);const a=i.rawgenericjoint_spring(t,e,r,n.__wbg_ptr,o.__wbg_ptr);return it.__wrap(a)}static rope(t,e,r){y(e,Vt),y(r,Vt);const n=i.rawgenericjoint_rope(t,e.__wbg_ptr,r.__wbg_ptr);return it.__wrap(n)}static spherical(t,e){y(t,Vt),y(e,Vt);const r=i.rawgenericjoint_spherical(t.__wbg_ptr,e.__wbg_ptr);return it.__wrap(r)}static prismatic(t,e,r,n,o,a){y(t,Vt),y(e,Vt),y(r,Vt);const s=i.rawgenericjoint_prismatic(t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n,o,a);return 0===s?void 0:it.__wrap(s)}static fixed(t,e,r,n){y(t,Vt),y(e,Ft),y(r,Vt),y(n,Ft);const o=i.rawgenericjoint_fixed(t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr);return it.__wrap(o)}static revolute(t,e,r){y(t,Vt),y(e,Vt),y(r,Vt);const n=i.rawgenericjoint_revolute(t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr);return 0===n?void 0:it.__wrap(n)}}const nt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawimpulsejointset_free(t>>>0,1)));class ot{static __wrap(t){t>>>=0;const e=Object.create(ot.prototype);return e.__wbg_ptr=t,nt.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,nt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawimpulsejointset_free(t,0)}jointType(t){return i.rawimpulsejointset_jointType(this.__wbg_ptr,t)}jointBodyHandle1(t){return i.rawimpulsejointset_jointBodyHandle1(this.__wbg_ptr,t)}jointBodyHandle2(t){return i.rawimpulsejointset_jointBodyHandle2(this.__wbg_ptr,t)}jointFrameX1(t){const e=i.rawimpulsejointset_jointFrameX1(this.__wbg_ptr,t);return Ft.__wrap(e)}jointFrameX2(t){const e=i.rawimpulsejointset_jointFrameX2(this.__wbg_ptr,t);return Ft.__wrap(e)}jointAnchor1(t){const e=i.rawimpulsejointset_jointAnchor1(this.__wbg_ptr,t);return Vt.__wrap(e)}jointAnchor2(t){const e=i.rawimpulsejointset_jointAnchor2(this.__wbg_ptr,t);return Vt.__wrap(e)}jointSetAnchor1(t,e){y(e,Vt),i.rawimpulsejointset_jointSetAnchor1(this.__wbg_ptr,t,e.__wbg_ptr)}jointSetAnchor2(t,e){y(e,Vt),i.rawimpulsejointset_jointSetAnchor2(this.__wbg_ptr,t,e.__wbg_ptr)}jointContactsEnabled(t){return 0!==i.rawimpulsejointset_jointContactsEnabled(this.__wbg_ptr,t)}jointSetContactsEnabled(t,e){i.rawimpulsejointset_jointSetContactsEnabled(this.__wbg_ptr,t,e)}jointLimitsEnabled(t,e){return 0!==i.rawimpulsejointset_jointLimitsEnabled(this.__wbg_ptr,t,e)}jointLimitsMin(t,e){return i.rawimpulsejointset_jointLimitsMin(this.__wbg_ptr,t,e)}jointLimitsMax(t,e){return i.rawimpulsejointset_jointLimitsMax(this.__wbg_ptr,t,e)}jointSetLimits(t,e,r,n){i.rawimpulsejointset_jointSetLimits(this.__wbg_ptr,t,e,r,n)}jointConfigureMotorModel(t,e,r){i.rawimpulsejointset_jointConfigureMotorModel(this.__wbg_ptr,t,e,r)}jointConfigureMotorVelocity(t,e,r,n){i.rawimpulsejointset_jointConfigureMotorVelocity(this.__wbg_ptr,t,e,r,n)}jointConfigureMotorPosition(t,e,r,n,o){i.rawimpulsejointset_jointConfigureMotorPosition(this.__wbg_ptr,t,e,r,n,o)}jointConfigureMotor(t,e,r,n,o,a){i.rawimpulsejointset_jointConfigureMotor(this.__wbg_ptr,t,e,r,n,o,a)}constructor(){const t=i.rawimpulsejointset_new();return this.__wbg_ptr=t>>>0,nt.register(this,this.__wbg_ptr,this),this}createJoint(t,e,r,n){return y(t,it),i.rawimpulsejointset_createJoint(this.__wbg_ptr,t.__wbg_ptr,e,r,n)}remove(t,e){i.rawimpulsejointset_remove(this.__wbg_ptr,t,e)}len(){return i.rawimpulsejointset_len(this.__wbg_ptr)>>>0}contains(t){return 0!==i.rawimpulsejointset_contains(this.__wbg_ptr,t)}forEachJointHandle(t){try{i.rawimpulsejointset_forEachJointHandle(this.__wbg_ptr,b(t))}finally{o[m++]=void 0}}forEachJointAttachedToRigidBody(t,e){try{i.rawimpulsejointset_forEachJointAttachedToRigidBody(this.__wbg_ptr,t,b(e))}finally{o[m++]=void 0}}}const at="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawintegrationparameters_free(t>>>0,1)));class st{static __wrap(t){t>>>=0;const e=Object.create(st.prototype);return e.__wbg_ptr=t,at.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,at.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawintegrationparameters_free(t,0)}constructor(){const t=i.rawintegrationparameters_new();return this.__wbg_ptr=t>>>0,at.register(this,this.__wbg_ptr,this),this}get dt(){return i.rawintegrationparameters_dt(this.__wbg_ptr)}get contact_erp(){return i.rawintegrationparameters_contact_erp(this.__wbg_ptr)}get normalizedAllowedLinearError(){return i.rawintegrationparameters_normalizedAllowedLinearError(this.__wbg_ptr)}get normalizedPredictionDistance(){return i.rawcontactforceevent_max_force_magnitude(this.__wbg_ptr)}get numSolverIterations(){return i.rawintegrationparameters_numSolverIterations(this.__wbg_ptr)>>>0}get numAdditionalFrictionIterations(){return i.rawintegrationparameters_numAdditionalFrictionIterations(this.__wbg_ptr)>>>0}get numInternalPgsIterations(){return i.rawintegrationparameters_numInternalPgsIterations(this.__wbg_ptr)>>>0}get minIslandSize(){return i.rawimpulsejointset_len(this.__wbg_ptr)>>>0}get maxCcdSubsteps(){return i.rawintegrationparameters_maxCcdSubsteps(this.__wbg_ptr)>>>0}get lengthUnit(){return i.rawintegrationparameters_lengthUnit(this.__wbg_ptr)}set dt(t){i.rawintegrationparameters_set_dt(this.__wbg_ptr,t)}set contact_natural_frequency(t){i.rawintegrationparameters_set_contact_natural_frequency(this.__wbg_ptr,t)}set normalizedAllowedLinearError(t){i.rawintegrationparameters_set_normalizedAllowedLinearError(this.__wbg_ptr,t)}set normalizedPredictionDistance(t){i.rawintegrationparameters_set_normalizedPredictionDistance(this.__wbg_ptr,t)}set numSolverIterations(t){i.rawintegrationparameters_set_numSolverIterations(this.__wbg_ptr,t)}set numAdditionalFrictionIterations(t){i.rawintegrationparameters_set_numAdditionalFrictionIterations(this.__wbg_ptr,t)}set numInternalPgsIterations(t){i.rawintegrationparameters_set_numInternalPgsIterations(this.__wbg_ptr,t)}set minIslandSize(t){i.rawintegrationparameters_set_minIslandSize(this.__wbg_ptr,t)}set maxCcdSubsteps(t){i.rawintegrationparameters_set_maxCcdSubsteps(this.__wbg_ptr,t)}set lengthUnit(t){i.rawintegrationparameters_set_lengthUnit(this.__wbg_ptr,t)}switchToStandardPgsSolver(){i.rawintegrationparameters_switchToStandardPgsSolver(this.__wbg_ptr)}switchToSmallStepsPgsSolver(){i.rawintegrationparameters_switchToSmallStepsPgsSolver(this.__wbg_ptr)}switchToSmallStepsPgsSolverWithoutWarmstart(){i.rawintegrationparameters_switchToSmallStepsPgsSolverWithoutWarmstart(this.__wbg_ptr)}}const ct="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawislandmanager_free(t>>>0,1)));class lt{static __wrap(t){t>>>=0;const e=Object.create(lt.prototype);return e.__wbg_ptr=t,ct.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,ct.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawislandmanager_free(t,0)}constructor(){const t=i.rawislandmanager_new();return this.__wbg_ptr=t>>>0,ct.register(this,this.__wbg_ptr,this),this}forEachActiveRigidBodyHandle(t){try{i.rawislandmanager_forEachActiveRigidBodyHandle(this.__wbg_ptr,b(t))}finally{o[m++]=void 0}}}const ht="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawkinematiccharactercontroller_free(t>>>0,1)));class ut{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,ht.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawkinematiccharactercontroller_free(t,0)}constructor(t){const e=i.rawkinematiccharactercontroller_new(t);return this.__wbg_ptr=e>>>0,ht.register(this,this.__wbg_ptr,this),this}up(){const t=i.rawcharactercollision_translationDeltaApplied(this.__wbg_ptr);return Vt.__wrap(t)}setUp(t){y(t,Vt),i.rawkinematiccharactercontroller_setUp(this.__wbg_ptr,t.__wbg_ptr)}normalNudgeFactor(){return i.rawkinematiccharactercontroller_normalNudgeFactor(this.__wbg_ptr)}setNormalNudgeFactor(t){i.rawkinematiccharactercontroller_setNormalNudgeFactor(this.__wbg_ptr,t)}offset(){return i.rawintegrationparameters_dt(this.__wbg_ptr)}setOffset(t){i.rawkinematiccharactercontroller_setOffset(this.__wbg_ptr,t)}slideEnabled(){return 0!==i.rawkinematiccharactercontroller_slideEnabled(this.__wbg_ptr)}setSlideEnabled(t){i.rawkinematiccharactercontroller_setSlideEnabled(this.__wbg_ptr,t)}autostepMaxHeight(){const t=i.rawkinematiccharactercontroller_autostepMaxHeight(this.__wbg_ptr);return 4294967297===t?void 0:t}autostepMinWidth(){const t=i.rawkinematiccharactercontroller_autostepMinWidth(this.__wbg_ptr);return 4294967297===t?void 0:t}autostepIncludesDynamicBodies(){const t=i.rawkinematiccharactercontroller_autostepIncludesDynamicBodies(this.__wbg_ptr);return 16777215===t?void 0:0!==t}autostepEnabled(){return 0!==i.rawkinematiccharactercontroller_autostepEnabled(this.__wbg_ptr)}enableAutostep(t,e,r){i.rawkinematiccharactercontroller_enableAutostep(this.__wbg_ptr,t,e,r)}disableAutostep(){i.rawkinematiccharactercontroller_disableAutostep(this.__wbg_ptr)}maxSlopeClimbAngle(){return i.rawkinematiccharactercontroller_maxSlopeClimbAngle(this.__wbg_ptr)}setMaxSlopeClimbAngle(t){i.rawkinematiccharactercontroller_setMaxSlopeClimbAngle(this.__wbg_ptr,t)}minSlopeSlideAngle(){return i.rawkinematiccharactercontroller_minSlopeSlideAngle(this.__wbg_ptr)}setMinSlopeSlideAngle(t){i.rawkinematiccharactercontroller_setMinSlopeSlideAngle(this.__wbg_ptr,t)}snapToGroundDistance(){const t=i.rawkinematiccharactercontroller_snapToGroundDistance(this.__wbg_ptr);return 4294967297===t?void 0:t}enableSnapToGround(t){i.rawkinematiccharactercontroller_enableSnapToGround(this.__wbg_ptr,t)}disableSnapToGround(){i.rawkinematiccharactercontroller_disableSnapToGround(this.__wbg_ptr)}snapToGroundEnabled(){return 0!==i.rawkinematiccharactercontroller_snapToGroundEnabled(this.__wbg_ptr)}computeColliderMovement(t,e,r,n,a,s,c,l,u,_,d){try{y(e,jt),y(r,H),y(n,xt),y(s,Vt),i.rawkinematiccharactercontroller_computeColliderMovement(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,a,s.__wbg_ptr,c,h(l)?4294967297:Math.fround(l),u,h(_)?4294967297:_>>>0,b(d))}finally{o[m++]=void 0}}computedMovement(){const t=i.rawkinematiccharactercontroller_computedMovement(this.__wbg_ptr);return Vt.__wrap(t)}computedGrounded(){return 0!==i.rawkinematiccharactercontroller_computedGrounded(this.__wbg_ptr)}numComputedCollisions(){return i.rawkinematiccharactercontroller_numComputedCollisions(this.__wbg_ptr)>>>0}computedCollision(t,e){return y(e,O),0!==i.rawkinematiccharactercontroller_computedCollision(this.__wbg_ptr,t,e.__wbg_ptr)}}const _t="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawmultibodyjointset_free(t>>>0,1)));class dt{static __wrap(t){t>>>=0;const e=Object.create(dt.prototype);return e.__wbg_ptr=t,_t.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,_t.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawmultibodyjointset_free(t,0)}jointType(t){return i.rawmultibodyjointset_jointType(this.__wbg_ptr,t)}jointFrameX1(t){const e=i.rawmultibodyjointset_jointFrameX1(this.__wbg_ptr,t);return Ft.__wrap(e)}jointFrameX2(t){const e=i.rawmultibodyjointset_jointFrameX2(this.__wbg_ptr,t);return Ft.__wrap(e)}jointAnchor1(t){const e=i.rawmultibodyjointset_jointAnchor1(this.__wbg_ptr,t);return Vt.__wrap(e)}jointAnchor2(t){const e=i.rawmultibodyjointset_jointAnchor2(this.__wbg_ptr,t);return Vt.__wrap(e)}jointContactsEnabled(t){return 0!==i.rawmultibodyjointset_jointContactsEnabled(this.__wbg_ptr,t)}jointSetContactsEnabled(t,e){i.rawmultibodyjointset_jointSetContactsEnabled(this.__wbg_ptr,t,e)}jointLimitsEnabled(t,e){return 0!==i.rawmultibodyjointset_jointLimitsEnabled(this.__wbg_ptr,t,e)}jointLimitsMin(t,e){return i.rawmultibodyjointset_jointLimitsMin(this.__wbg_ptr,t,e)}jointLimitsMax(t,e){return i.rawmultibodyjointset_jointLimitsMax(this.__wbg_ptr,t,e)}constructor(){const t=i.rawmultibodyjointset_new();return this.__wbg_ptr=t>>>0,_t.register(this,this.__wbg_ptr,this),this}createJoint(t,e,r,n){return y(t,it),i.rawmultibodyjointset_createJoint(this.__wbg_ptr,t.__wbg_ptr,e,r,n)}remove(t,e){i.rawmultibodyjointset_remove(this.__wbg_ptr,t,e)}contains(t){return 0!==i.rawmultibodyjointset_contains(this.__wbg_ptr,t)}forEachJointHandle(t){try{i.rawmultibodyjointset_forEachJointHandle(this.__wbg_ptr,b(t))}finally{o[m++]=void 0}}forEachJointAttachedToRigidBody(t,e){try{i.rawmultibodyjointset_forEachJointAttachedToRigidBody(this.__wbg_ptr,t,b(e))}finally{o[m++]=void 0}}}const pt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawnarrowphase_free(t>>>0,1)));class wt{static __wrap(t){t>>>=0;const e=Object.create(wt.prototype);return e.__wbg_ptr=t,pt.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,pt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawnarrowphase_free(t,0)}constructor(){const t=i.rawnarrowphase_new();return this.__wbg_ptr=t>>>0,pt.register(this,this.__wbg_ptr,this),this}contact_pairs_with(t,e){i.rawnarrowphase_contact_pairs_with(this.__wbg_ptr,t,c(e))}contact_pair(t,e){const r=i.rawnarrowphase_contact_pair(this.__wbg_ptr,t,e);return 0===r?void 0:V.__wrap(r)}intersection_pairs_with(t,e){i.rawnarrowphase_intersection_pairs_with(this.__wbg_ptr,t,c(e))}intersection_pair(t,e){return 0!==i.rawnarrowphase_intersection_pair(this.__wbg_ptr,t,e)}}const ft="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawphysicspipeline_free(t>>>0,1)));class gt{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,ft.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawphysicspipeline_free(t,0)}constructor(){const t=i.rawphysicspipeline_new();return this.__wbg_ptr=t>>>0,ft.register(this,this.__wbg_ptr,this),this}step(t,e,r,n,o,a,s,c,l,h){y(t,Vt),y(e,st),y(r,lt),y(n,j),y(o,wt),y(a,jt),y(s,H),y(c,ot),y(l,dt),y(h,F),i.rawphysicspipeline_step(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o.__wbg_ptr,a.__wbg_ptr,s.__wbg_ptr,c.__wbg_ptr,l.__wbg_ptr,h.__wbg_ptr)}stepWithEvents(t,e,r,n,o,a,s,l,h,u,_,d,p,w){y(t,Vt),y(e,st),y(r,lt),y(n,j),y(o,wt),y(a,jt),y(s,H),y(l,ot),y(h,dt),y(u,F),y(_,et),i.rawphysicspipeline_stepWithEvents(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o.__wbg_ptr,a.__wbg_ptr,s.__wbg_ptr,l.__wbg_ptr,h.__wbg_ptr,u.__wbg_ptr,_.__wbg_ptr,c(d),c(p),c(w))}}const yt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawpidcontroller_free(t>>>0,1)));class mt{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,yt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawpidcontroller_free(t,0)}constructor(t,e,r,n){const o=i.rawpidcontroller_new(t,e,r,n);return this.__wbg_ptr=o>>>0,yt.register(this,this.__wbg_ptr,this),this}set_kp(t,e){i.rawpidcontroller_set_kp(this.__wbg_ptr,t,e)}set_ki(t,e){i.rawpidcontroller_set_ki(this.__wbg_ptr,t,e)}set_kd(t,e){i.rawpidcontroller_set_kd(this.__wbg_ptr,t,e)}set_axes_mask(t){i.rawpidcontroller_set_axes_mask(this.__wbg_ptr,t)}reset_integrals(){i.rawpidcontroller_reset_integrals(this.__wbg_ptr)}apply_linear_correction(t,e,r,n,o){y(e,jt),y(n,Vt),y(o,Vt),i.rawpidcontroller_apply_linear_correction(this.__wbg_ptr,t,e.__wbg_ptr,r,n.__wbg_ptr,o.__wbg_ptr)}apply_angular_correction(t,e,r,n,o){y(e,jt),y(n,Ft),y(o,Vt),i.rawpidcontroller_apply_angular_correction(this.__wbg_ptr,t,e.__wbg_ptr,r,n.__wbg_ptr,o.__wbg_ptr)}linear_correction(t,e,r,n,o){y(e,jt),y(n,Vt),y(o,Vt);const a=i.rawpidcontroller_linear_correction(this.__wbg_ptr,t,e.__wbg_ptr,r,n.__wbg_ptr,o.__wbg_ptr);return Vt.__wrap(a)}angular_correction(t,e,r,n,o){y(e,jt),y(n,Ft),y(o,Vt);const a=i.rawpidcontroller_angular_correction(this.__wbg_ptr,t,e.__wbg_ptr,r,n.__wbg_ptr,o.__wbg_ptr);return Vt.__wrap(a)}}const bt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawpointcolliderprojection_free(t>>>0,1)));class vt{static __wrap(t){t>>>=0;const e=Object.create(vt.prototype);return e.__wbg_ptr=t,bt.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,bt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawpointcolliderprojection_free(t,0)}colliderHandle(){return i.rawpointcolliderprojection_colliderHandle(this.__wbg_ptr)}point(){const t=i.rawpointcolliderprojection_point(this.__wbg_ptr);return Vt.__wrap(t)}isInside(){return 0!==i.rawpointcolliderprojection_isInside(this.__wbg_ptr)}featureType(){return i.rawpointcolliderprojection_featureType(this.__wbg_ptr)}featureId(){const t=i.rawpointcolliderprojection_featureId(this.__wbg_ptr);return 4294967297===t?void 0:t}}const St="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawpointprojection_free(t>>>0,1)));class Rt{static __wrap(t){t>>>=0;const e=Object.create(Rt.prototype);return e.__wbg_ptr=t,St.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,St.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawpointprojection_free(t,0)}point(){const t=i.rawpointprojection_point(this.__wbg_ptr);return Vt.__wrap(t)}isInside(){return 0!==i.rawpointprojection_isInside(this.__wbg_ptr)}}const Et="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawquerypipeline_free(t>>>0,1)));class xt{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Et.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawquerypipeline_free(t,0)}constructor(){const t=i.rawquerypipeline_new();return this.__wbg_ptr=t>>>0,Et.register(this,this.__wbg_ptr,this),this}update(t){y(t,H),i.rawquerypipeline_update(this.__wbg_ptr,t.__wbg_ptr)}castRay(t,e,r,n,a,s,c,l,u,_,d){try{y(t,jt),y(e,H),y(r,Vt),y(n,Vt);const o=i.rawquerypipeline_castRay(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,a,s,c,h(l)?4294967297:l>>>0,!h(u),h(u)?0:u,!h(_),h(_)?0:_,b(d));return 0===o?void 0:Pt.__wrap(o)}finally{o[m++]=void 0}}castRayAndGetNormal(t,e,r,n,a,s,c,l,u,_,d){try{y(t,jt),y(e,H),y(r,Vt),y(n,Vt);const o=i.rawquerypipeline_castRayAndGetNormal(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,a,s,c,h(l)?4294967297:l>>>0,!h(u),h(u)?0:u,!h(_),h(_)?0:_,b(d));return 0===o?void 0:Mt.__wrap(o)}finally{o[m++]=void 0}}intersectionsWithRay(t,e,r,n,a,s,c,l,u,_,d,p){try{y(t,jt),y(e,H),y(r,Vt),y(n,Vt),i.rawquerypipeline_intersectionsWithRay(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,a,s,b(c),l,h(u)?4294967297:u>>>0,!h(_),h(_)?0:_,!h(d),h(d)?0:d,b(p))}finally{o[m++]=void 0,o[m++]=void 0}}intersectionWithShape(t,e,r,n,a,s,c,l,u,d){try{const o=i.__wbindgen_add_to_stack_pointer(-16);y(t,jt),y(e,H),y(r,Vt),y(n,Ft),y(a,Nt),i.rawquerypipeline_intersectionWithShape(o,this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,a.__wbg_ptr,s,h(c)?4294967297:c>>>0,!h(l),h(l)?0:l,!h(u),h(u)?0:u,b(d));var p=_().getInt32(o+0,!0),w=_().getFloat64(o+8,!0);return 0===p?void 0:w}finally{i.__wbindgen_add_to_stack_pointer(16),o[m++]=void 0}}projectPoint(t,e,r,n,a,s,c,l,u){try{y(t,jt),y(e,H),y(r,Vt);const o=i.rawquerypipeline_projectPoint(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n,a,h(s)?4294967297:s>>>0,!h(c),h(c)?0:c,!h(l),h(l)?0:l,b(u));return 0===o?void 0:vt.__wrap(o)}finally{o[m++]=void 0}}projectPointAndGetFeature(t,e,r,n,a,s,c,l){try{y(t,jt),y(e,H),y(r,Vt);const o=i.rawquerypipeline_projectPointAndGetFeature(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n,h(a)?4294967297:a>>>0,!h(s),h(s)?0:s,!h(c),h(c)?0:c,b(l));return 0===o?void 0:vt.__wrap(o)}finally{o[m++]=void 0}}intersectionsWithPoint(t,e,r,n,a,s,c,l,u){try{y(t,jt),y(e,H),y(r,Vt),i.rawquerypipeline_intersectionsWithPoint(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,b(n),a,h(s)?4294967297:s>>>0,!h(c),h(c)?0:c,!h(l),h(l)?0:l,b(u))}finally{o[m++]=void 0,o[m++]=void 0}}castShape(t,e,r,n,a,s,c,l,u,_,d,p,w,f){try{y(t,jt),y(e,H),y(r,Vt),y(n,Ft),y(a,Vt),y(s,Nt);const o=i.rawquerypipeline_castShape(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,a.__wbg_ptr,s.__wbg_ptr,c,l,u,_,h(d)?4294967297:d>>>0,!h(p),h(p)?0:p,!h(w),h(w)?0:w,b(f));return 0===o?void 0:N.__wrap(o)}finally{o[m++]=void 0}}intersectionsWithShape(t,e,r,n,a,s,c,l,u,_,d){try{y(t,jt),y(e,H),y(r,Vt),y(n,Ft),y(a,Nt),i.rawquerypipeline_intersectionsWithShape(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,a.__wbg_ptr,b(s),c,h(l)?4294967297:l>>>0,!h(u),h(u)?0:u,!h(_),h(_)?0:_,b(d))}finally{o[m++]=void 0,o[m++]=void 0}}collidersWithAabbIntersectingAabb(t,e,r){try{y(t,Vt),y(e,Vt),i.rawquerypipeline_collidersWithAabbIntersectingAabb(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,b(r))}finally{o[m++]=void 0}}}const Ct="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawraycolliderhit_free(t>>>0,1)));class Pt{static __wrap(t){t>>>=0;const e=Object.create(Pt.prototype);return e.__wbg_ptr=t,Ct.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Ct.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawraycolliderhit_free(t,0)}colliderHandle(){return i.rawcharactercollision_handle(this.__wbg_ptr)}timeOfImpact(){return i.rawcollidershapecasthit_time_of_impact(this.__wbg_ptr)}}const kt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawraycolliderintersection_free(t>>>0,1)));class Mt{static __wrap(t){t>>>=0;const e=Object.create(Mt.prototype);return e.__wbg_ptr=t,kt.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,kt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawraycolliderintersection_free(t,0)}colliderHandle(){return i.rawpointcolliderprojection_colliderHandle(this.__wbg_ptr)}normal(){const t=i.rawcollidershapecasthit_witness1(this.__wbg_ptr);return Vt.__wrap(t)}time_of_impact(){return i.rawcollidershapecasthit_time_of_impact(this.__wbg_ptr)}featureType(){return i.rawpointcolliderprojection_featureType(this.__wbg_ptr)}featureId(){const t=i.rawpointcolliderprojection_featureId(this.__wbg_ptr);return 4294967297===t?void 0:t}}const It="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawrayintersection_free(t>>>0,1)));class Tt{static __wrap(t){t>>>=0;const e=Object.create(Tt.prototype);return e.__wbg_ptr=t,It.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,It.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawrayintersection_free(t,0)}normal(){const t=i.rawcollidershapecasthit_witness1(this.__wbg_ptr);return Vt.__wrap(t)}time_of_impact(){return i.rawcollidershapecasthit_time_of_impact(this.__wbg_ptr)}featureType(){return i.rawpointcolliderprojection_featureType(this.__wbg_ptr)}featureId(){const t=i.rawpointcolliderprojection_featureId(this.__wbg_ptr);return 4294967297===t?void 0:t}}const At="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawrigidbodyset_free(t>>>0,1)));class jt{static __wrap(t){t>>>=0;const e=Object.create(jt.prototype);return e.__wbg_ptr=t,At.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,At.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawrigidbodyset_free(t,0)}rbTranslation(t){const e=i.rawrigidbodyset_rbTranslation(this.__wbg_ptr,t);return Vt.__wrap(e)}rbRotation(t){const e=i.rawrigidbodyset_rbRotation(this.__wbg_ptr,t);return Ft.__wrap(e)}rbSleep(t){i.rawrigidbodyset_rbSleep(this.__wbg_ptr,t)}rbIsSleeping(t){return 0!==i.rawrigidbodyset_rbIsSleeping(this.__wbg_ptr,t)}rbIsMoving(t){return 0!==i.rawrigidbodyset_rbIsMoving(this.__wbg_ptr,t)}rbNextTranslation(t){const e=i.rawrigidbodyset_rbNextTranslation(this.__wbg_ptr,t);return Vt.__wrap(e)}rbNextRotation(t){const e=i.rawrigidbodyset_rbNextRotation(this.__wbg_ptr,t);return Ft.__wrap(e)}rbSetTranslation(t,e,r,n,o){i.rawrigidbodyset_rbSetTranslation(this.__wbg_ptr,t,e,r,n,o)}rbSetRotation(t,e,r,n,o,a){i.rawrigidbodyset_rbSetRotation(this.__wbg_ptr,t,e,r,n,o,a)}rbSetLinvel(t,e,r){y(e,Vt),i.rawrigidbodyset_rbSetLinvel(this.__wbg_ptr,t,e.__wbg_ptr,r)}rbSetAngvel(t,e,r){y(e,Vt),i.rawrigidbodyset_rbSetAngvel(this.__wbg_ptr,t,e.__wbg_ptr,r)}rbSetNextKinematicTranslation(t,e,r,n){i.rawrigidbodyset_rbSetNextKinematicTranslation(this.__wbg_ptr,t,e,r,n)}rbSetNextKinematicRotation(t,e,r,n,o){i.rawrigidbodyset_rbSetNextKinematicRotation(this.__wbg_ptr,t,e,r,n,o)}rbRecomputeMassPropertiesFromColliders(t,e){y(e,H),i.rawrigidbodyset_rbRecomputeMassPropertiesFromColliders(this.__wbg_ptr,t,e.__wbg_ptr)}rbSetAdditionalMass(t,e,r){i.rawrigidbodyset_rbSetAdditionalMass(this.__wbg_ptr,t,e,r)}rbSetAdditionalMassProperties(t,e,r,n,o,a){y(r,Vt),y(n,Vt),y(o,Ft),i.rawrigidbodyset_rbSetAdditionalMassProperties(this.__wbg_ptr,t,e,r.__wbg_ptr,n.__wbg_ptr,o.__wbg_ptr,a)}rbLinvel(t){const e=i.rawrigidbodyset_rbLinvel(this.__wbg_ptr,t);return Vt.__wrap(e)}rbAngvel(t){const e=i.rawrigidbodyset_rbAngvel(this.__wbg_ptr,t);return Vt.__wrap(e)}rbLockTranslations(t,e,r){i.rawrigidbodyset_rbLockTranslations(this.__wbg_ptr,t,e,r)}rbSetEnabledTranslations(t,e,r,n,o){i.rawrigidbodyset_rbSetEnabledTranslations(this.__wbg_ptr,t,e,r,n,o)}rbLockRotations(t,e,r){i.rawrigidbodyset_rbLockRotations(this.__wbg_ptr,t,e,r)}rbSetEnabledRotations(t,e,r,n,o){i.rawrigidbodyset_rbSetEnabledRotations(this.__wbg_ptr,t,e,r,n,o)}rbDominanceGroup(t){return i.rawrigidbodyset_rbDominanceGroup(this.__wbg_ptr,t)}rbSetDominanceGroup(t,e){i.rawrigidbodyset_rbSetDominanceGroup(this.__wbg_ptr,t,e)}rbEnableCcd(t,e){i.rawrigidbodyset_rbEnableCcd(this.__wbg_ptr,t,e)}rbSetSoftCcdPrediction(t,e){i.rawrigidbodyset_rbSetSoftCcdPrediction(this.__wbg_ptr,t,e)}rbMass(t){return i.rawrigidbodyset_rbMass(this.__wbg_ptr,t)}rbInvMass(t){return i.rawrigidbodyset_rbInvMass(this.__wbg_ptr,t)}rbEffectiveInvMass(t){const e=i.rawrigidbodyset_rbEffectiveInvMass(this.__wbg_ptr,t);return Vt.__wrap(e)}rbLocalCom(t){const e=i.rawrigidbodyset_rbLocalCom(this.__wbg_ptr,t);return Vt.__wrap(e)}rbWorldCom(t){const e=i.rawrigidbodyset_rbWorldCom(this.__wbg_ptr,t);return Vt.__wrap(e)}rbInvPrincipalInertiaSqrt(t){const e=i.rawrigidbodyset_rbInvPrincipalInertiaSqrt(this.__wbg_ptr,t);return Vt.__wrap(e)}rbPrincipalInertiaLocalFrame(t){const e=i.rawrigidbodyset_rbPrincipalInertiaLocalFrame(this.__wbg_ptr,t);return Ft.__wrap(e)}rbPrincipalInertia(t){const e=i.rawrigidbodyset_rbPrincipalInertia(this.__wbg_ptr,t);return Vt.__wrap(e)}rbEffectiveWorldInvInertiaSqrt(t){const e=i.rawrigidbodyset_rbEffectiveWorldInvInertiaSqrt(this.__wbg_ptr,t);return Ot.__wrap(e)}rbEffectiveAngularInertia(t){const e=i.rawrigidbodyset_rbEffectiveAngularInertia(this.__wbg_ptr,t);return Ot.__wrap(e)}rbWakeUp(t){i.rawrigidbodyset_rbWakeUp(this.__wbg_ptr,t)}rbIsCcdEnabled(t){return 0!==i.rawrigidbodyset_rbIsCcdEnabled(this.__wbg_ptr,t)}rbSoftCcdPrediction(t){return i.rawrigidbodyset_rbSoftCcdPrediction(this.__wbg_ptr,t)}rbNumColliders(t){return i.rawrigidbodyset_rbNumColliders(this.__wbg_ptr,t)>>>0}rbCollider(t,e){return i.rawrigidbodyset_rbCollider(this.__wbg_ptr,t,e)}rbBodyType(t){return i.rawrigidbodyset_rbBodyType(this.__wbg_ptr,t)}rbSetBodyType(t,e,r){i.rawrigidbodyset_rbSetBodyType(this.__wbg_ptr,t,e,r)}rbIsFixed(t){return 0!==i.rawrigidbodyset_rbIsFixed(this.__wbg_ptr,t)}rbIsKinematic(t){return 0!==i.rawrigidbodyset_rbIsKinematic(this.__wbg_ptr,t)}rbIsDynamic(t){return 0!==i.rawrigidbodyset_rbIsDynamic(this.__wbg_ptr,t)}rbLinearDamping(t){return i.rawrigidbodyset_rbLinearDamping(this.__wbg_ptr,t)}rbAngularDamping(t){return i.rawrigidbodyset_rbAngularDamping(this.__wbg_ptr,t)}rbSetLinearDamping(t,e){i.rawrigidbodyset_rbSetLinearDamping(this.__wbg_ptr,t,e)}rbSetAngularDamping(t,e){i.rawrigidbodyset_rbSetAngularDamping(this.__wbg_ptr,t,e)}rbSetEnabled(t,e){i.rawrigidbodyset_rbSetEnabled(this.__wbg_ptr,t,e)}rbIsEnabled(t){return 0!==i.rawrigidbodyset_rbIsEnabled(this.__wbg_ptr,t)}rbGravityScale(t){return i.rawrigidbodyset_rbGravityScale(this.__wbg_ptr,t)}rbSetGravityScale(t,e,r){i.rawrigidbodyset_rbSetGravityScale(this.__wbg_ptr,t,e,r)}rbResetForces(t,e){i.rawrigidbodyset_rbResetForces(this.__wbg_ptr,t,e)}rbResetTorques(t,e){i.rawrigidbodyset_rbResetTorques(this.__wbg_ptr,t,e)}rbAddForce(t,e,r){y(e,Vt),i.rawrigidbodyset_rbAddForce(this.__wbg_ptr,t,e.__wbg_ptr,r)}rbApplyImpulse(t,e,r){y(e,Vt),i.rawrigidbodyset_rbApplyImpulse(this.__wbg_ptr,t,e.__wbg_ptr,r)}rbAddTorque(t,e,r){y(e,Vt),i.rawrigidbodyset_rbAddTorque(this.__wbg_ptr,t,e.__wbg_ptr,r)}rbApplyTorqueImpulse(t,e,r){y(e,Vt),i.rawrigidbodyset_rbApplyTorqueImpulse(this.__wbg_ptr,t,e.__wbg_ptr,r)}rbAddForceAtPoint(t,e,r,n){y(e,Vt),y(r,Vt),i.rawrigidbodyset_rbAddForceAtPoint(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n)}rbApplyImpulseAtPoint(t,e,r,n){y(e,Vt),y(r,Vt),i.rawrigidbodyset_rbApplyImpulseAtPoint(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n)}rbAdditionalSolverIterations(t){return i.rawrigidbodyset_rbAdditionalSolverIterations(this.__wbg_ptr,t)>>>0}rbSetAdditionalSolverIterations(t,e){i.rawrigidbodyset_rbSetAdditionalSolverIterations(this.__wbg_ptr,t,e)}rbUserData(t){return i.rawrigidbodyset_rbUserData(this.__wbg_ptr,t)>>>0}rbSetUserData(t,e){i.rawrigidbodyset_rbSetUserData(this.__wbg_ptr,t,e)}rbUserForce(t){const e=i.rawrigidbodyset_rbUserForce(this.__wbg_ptr,t);return Vt.__wrap(e)}rbUserTorque(t){const e=i.rawrigidbodyset_rbUserTorque(this.__wbg_ptr,t);return Vt.__wrap(e)}constructor(){const t=i.rawrigidbodyset_new();return this.__wbg_ptr=t>>>0,At.register(this,this.__wbg_ptr,this),this}createRigidBody(t,e,r,n,o,a,s,c,l,h,u,_,d,p,w,f,g,m,b,v,S,R,E,x,C,P){return y(e,Vt),y(r,Ft),y(s,Vt),y(c,Vt),y(l,Vt),y(h,Vt),y(u,Ft),i.rawrigidbodyset_createRigidBody(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n,o,a,s.__wbg_ptr,c.__wbg_ptr,l.__wbg_ptr,h.__wbg_ptr,u.__wbg_ptr,_,d,p,w,f,g,m,b,v,S,R,E,x,C,P)}remove(t,e,r,n,o){y(e,lt),y(r,H),y(n,ot),y(o,dt),i.rawrigidbodyset_remove(this.__wbg_ptr,t,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o.__wbg_ptr)}len(){return i.rawcolliderset_len(this.__wbg_ptr)>>>0}contains(t){return 0!==i.rawrigidbodyset_contains(this.__wbg_ptr,t)}forEachRigidBodyHandle(t){try{i.rawrigidbodyset_forEachRigidBodyHandle(this.__wbg_ptr,b(t))}finally{o[m++]=void 0}}propagateModifiedBodyPositionsToColliders(t){y(t,H),i.rawrigidbodyset_propagateModifiedBodyPositionsToColliders(this.__wbg_ptr,t.__wbg_ptr)}}const Lt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawrotation_free(t>>>0,1)));class Ft{static __wrap(t){t>>>=0;const e=Object.create(Ft.prototype);return e.__wbg_ptr=t,Lt.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Lt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawrotation_free(t,0)}constructor(t,e,r,n){const o=i.rawrotation_new(t,e,r,n);return this.__wbg_ptr=o>>>0,Lt.register(this,this.__wbg_ptr,this),this}static identity(){const t=i.rawrotation_identity();return Ft.__wrap(t)}get x(){return i.rawrotation_x(this.__wbg_ptr)}get y(){return i.rawintegrationparameters_dt(this.__wbg_ptr)}get z(){return i.rawcollidershapecasthit_time_of_impact(this.__wbg_ptr)}get w(){return i.rawrotation_w(this.__wbg_ptr)}}const zt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawsdpmatrix3_free(t>>>0,1)));class Ot{static __wrap(t){t>>>=0;const e=Object.create(Ot.prototype);return e.__wbg_ptr=t,zt.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,zt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawsdpmatrix3_free(t,0)}elements(){return d(i.rawsdpmatrix3_elements(this.__wbg_ptr))}}const Dt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawserializationpipeline_free(t>>>0,1)));class Ht{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Dt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawserializationpipeline_free(t,0)}constructor(){const t=i.rawserializationpipeline_new();return this.__wbg_ptr=t>>>0,Dt.register(this,this.__wbg_ptr,this),this}serializeAll(t,e,r,n,o,a,s,c,l){return y(t,Vt),y(e,st),y(r,lt),y(n,j),y(o,wt),y(a,jt),y(s,H),y(c,ot),y(l,dt),d(i.rawserializationpipeline_serializeAll(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o.__wbg_ptr,a.__wbg_ptr,s.__wbg_ptr,c.__wbg_ptr,l.__wbg_ptr))}deserializeAll(t){const e=i.rawserializationpipeline_deserializeAll(this.__wbg_ptr,c(t));return 0===e?void 0:Q.__wrap(e)}}const Bt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawshape_free(t>>>0,1)));class Nt{static __wrap(t){t>>>=0;const e=Object.create(Nt.prototype);return e.__wbg_ptr=t,Bt.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Bt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawshape_free(t,0)}static cuboid(t,e,r){const n=i.rawshape_cuboid(t,e,r);return Nt.__wrap(n)}static roundCuboid(t,e,r,n){const o=i.rawshape_roundCuboid(t,e,r,n);return Nt.__wrap(o)}static ball(t){const e=i.rawshape_ball(t);return Nt.__wrap(e)}static halfspace(t){y(t,Vt);const e=i.rawshape_halfspace(t.__wbg_ptr);return Nt.__wrap(e)}static capsule(t,e){const r=i.rawshape_capsule(t,e);return Nt.__wrap(r)}static cylinder(t,e){const r=i.rawshape_cylinder(t,e);return Nt.__wrap(r)}static roundCylinder(t,e,r){const n=i.rawshape_roundCylinder(t,e,r);return Nt.__wrap(n)}static cone(t,e){const r=i.rawshape_cone(t,e);return Nt.__wrap(r)}static roundCone(t,e,r){const n=i.rawshape_roundCone(t,e,r);return Nt.__wrap(n)}static polyline(t,e){const r=P(t,i.__wbindgen_export_2),n=C,o=k(e,i.__wbindgen_export_2),a=C,s=i.rawshape_polyline(r,n,o,a);return Nt.__wrap(s)}static trimesh(t,e,r){const n=P(t,i.__wbindgen_export_2),o=C,a=k(e,i.__wbindgen_export_2),s=C,c=i.rawshape_trimesh(n,o,a,s,r);return 0===c?void 0:Nt.__wrap(c)}static heightfield(t,e,r,n,o){const a=P(r,i.__wbindgen_export_2),s=C;y(n,Vt);const c=i.rawshape_heightfield(t,e,a,s,n.__wbg_ptr,o);return Nt.__wrap(c)}static segment(t,e){y(t,Vt),y(e,Vt);const r=i.rawshape_segment(t.__wbg_ptr,e.__wbg_ptr);return Nt.__wrap(r)}static triangle(t,e,r){y(t,Vt),y(e,Vt),y(r,Vt);const n=i.rawshape_triangle(t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr);return Nt.__wrap(n)}static roundTriangle(t,e,r,n){y(t,Vt),y(e,Vt),y(r,Vt);const o=i.rawshape_roundTriangle(t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n);return Nt.__wrap(o)}static convexHull(t){const e=P(t,i.__wbindgen_export_2),r=C,n=i.rawshape_convexHull(e,r);return 0===n?void 0:Nt.__wrap(n)}static roundConvexHull(t,e){const r=P(t,i.__wbindgen_export_2),n=C,o=i.rawshape_roundConvexHull(r,n,e);return 0===o?void 0:Nt.__wrap(o)}static convexMesh(t,e){const r=P(t,i.__wbindgen_export_2),n=C,o=k(e,i.__wbindgen_export_2),a=C,s=i.rawshape_convexMesh(r,n,o,a);return 0===s?void 0:Nt.__wrap(s)}static roundConvexMesh(t,e,r){const n=P(t,i.__wbindgen_export_2),o=C,a=k(e,i.__wbindgen_export_2),s=C,c=i.rawshape_roundConvexMesh(n,o,a,s,r);return 0===c?void 0:Nt.__wrap(c)}castShape(t,e,r,n,o,a,s,c,l,h){y(t,Vt),y(e,Ft),y(r,Vt),y(n,Nt),y(o,Vt),y(a,Ft),y(s,Vt);const u=i.rawshape_castShape(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o.__wbg_ptr,a.__wbg_ptr,s.__wbg_ptr,c,l,h);return 0===u?void 0:Wt.__wrap(u)}intersectsShape(t,e,r,n,o){return y(t,Vt),y(e,Ft),y(r,Nt),y(n,Vt),y(o,Ft),0!==i.rawshape_intersectsShape(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o.__wbg_ptr)}contactShape(t,e,r,n,o,a){y(t,Vt),y(e,Ft),y(r,Nt),y(n,Vt),y(o,Ft);const s=i.rawshape_contactShape(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o.__wbg_ptr,a);return 0===s?void 0:qt.__wrap(s)}containsPoint(t,e,r){return y(t,Vt),y(e,Ft),y(r,Vt),0!==i.rawshape_containsPoint(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr)}projectPoint(t,e,r,n){y(t,Vt),y(e,Ft),y(r,Vt);const o=i.rawshape_projectPoint(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n);return Rt.__wrap(o)}intersectsRay(t,e,r,n,o){return y(t,Vt),y(e,Ft),y(r,Vt),y(n,Vt),0!==i.rawshape_intersectsRay(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o)}castRay(t,e,r,n,o,a){return y(t,Vt),y(e,Ft),y(r,Vt),y(n,Vt),i.rawshape_castRay(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o,a)}castRayAndGetNormal(t,e,r,n,o,a){y(t,Vt),y(e,Ft),y(r,Vt),y(n,Vt);const s=i.rawshape_castRayAndGetNormal(this.__wbg_ptr,t.__wbg_ptr,e.__wbg_ptr,r.__wbg_ptr,n.__wbg_ptr,o,a);return 0===s?void 0:Tt.__wrap(s)}}const Gt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawshapecasthit_free(t>>>0,1)));class Wt{static __wrap(t){t>>>=0;const e=Object.create(Wt.prototype);return e.__wbg_ptr=t,Gt.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Gt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawshapecasthit_free(t,0)}time_of_impact(){return i.rawrotation_x(this.__wbg_ptr)}witness1(){const t=i.rawshapecasthit_witness1(this.__wbg_ptr);return Vt.__wrap(t)}witness2(){const t=i.rawcontactforceevent_total_force(this.__wbg_ptr);return Vt.__wrap(t)}normal1(){const t=i.rawshapecasthit_normal1(this.__wbg_ptr);return Vt.__wrap(t)}normal2(){const t=i.rawshapecasthit_normal2(this.__wbg_ptr);return Vt.__wrap(t)}}const Jt="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawshapecontact_free(t>>>0,1)));class qt{static __wrap(t){t>>>=0;const e=Object.create(qt.prototype);return e.__wbg_ptr=t,Jt.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Jt.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawshapecontact_free(t,0)}distance(){return i.rawkinematiccharactercontroller_maxSlopeClimbAngle(this.__wbg_ptr)}point1(){const t=i.rawpointprojection_point(this.__wbg_ptr);return Vt.__wrap(t)}point2(){const t=i.rawcollidershapecasthit_witness1(this.__wbg_ptr);return Vt.__wrap(t)}normal1(){const t=i.rawcollidershapecasthit_witness2(this.__wbg_ptr);return Vt.__wrap(t)}normal2(){const t=i.rawcharactercollision_translationDeltaApplied(this.__wbg_ptr);return Vt.__wrap(t)}}const Ut="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>i.__wbg_rawvector_free(t>>>0,1)));class Vt{static __wrap(t){t>>>=0;const e=Object.create(Vt.prototype);return e.__wbg_ptr=t,Ut.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,Ut.unregister(this),t}free(){const t=this.__destroy_into_raw();i.__wbg_rawvector_free(t,0)}static zero(){const t=i.rawvector_zero();return Vt.__wrap(t)}constructor(t,e,r){const n=i.rawvector_new(t,e,r);return this.__wbg_ptr=n>>>0,Ut.register(this,this.__wbg_ptr,this),this}get x(){return i.rawrotation_x(this.__wbg_ptr)}set x(t){i.rawvector_set_x(this.__wbg_ptr,t)}get y(){return i.rawintegrationparameters_dt(this.__wbg_ptr)}set y(t){i.rawintegrationparameters_set_dt(this.__wbg_ptr,t)}get z(){return i.rawcollidershapecasthit_time_of_impact(this.__wbg_ptr)}set z(t){i.rawvector_set_z(this.__wbg_ptr,t)}xyz(){const t=i.rawvector_xyz(this.__wbg_ptr);return Vt.__wrap(t)}yxz(){const t=i.rawvector_yxz(this.__wbg_ptr);return Vt.__wrap(t)}zxy(){const t=i.rawvector_zxy(this.__wbg_ptr);return Vt.__wrap(t)}xzy(){const t=i.rawvector_xzy(this.__wbg_ptr);return Vt.__wrap(t)}yzx(){const t=i.rawvector_yzx(this.__wbg_ptr);return Vt.__wrap(t)}zyx(){const t=i.rawvector_zyx(this.__wbg_ptr);return Vt.__wrap(t)}}function Kt(t,e,r,i){return c(a(t).bind(a(e),a(r),a(i)))}function Xt(t){return c(a(t).buffer)}function Yt(){return l((function(t,e,r){return c(a(t).call(a(e),a(r)))}),arguments)}function Qt(){return l((function(t,e,r,i){return c(a(t).call(a(e),a(r),a(i)))}),arguments)}function $t(){return l((function(t,e,r,i,n){return c(a(t).call(a(e),a(r),a(i),a(n)))}),arguments)}function Zt(t){return a(t).length}function te(t){return a(t).length}function ee(t){return c(new Uint8Array(a(t)))}function re(t,e,r){return c(new Uint8Array(a(t),e>>>0,r>>>0))}function ie(t,e,r){return c(new Float32Array(a(t),e>>>0,r>>>0))}function ne(t){return c(new Float32Array(t>>>0))}function oe(t){return c(W.__wrap(t))}function ae(t){return c(Mt.__wrap(t))}function se(t,e,r){a(t).set(a(e),r>>>0)}function ce(t,e,r){a(t).set(a(e),r>>>0)}function le(t){const e=a(t);return"boolean"==typeof e?e?1:0:2}function he(t){return"function"==typeof a(t)}function ue(){return c(i.memory)}function _e(t,e){const r=a(e),i="number"==typeof r?r:void 0;_().setFloat64(t+8,h(i)?0:i,!0),_().setInt32(t+0,!h(i),!0)}function de(t){return c(t)}function pe(t){d(t)}function we(t,e){throw new Error(f(t,e))}},1039:(t,e,r)=>{function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return(e=c(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,c(i.key),i)}}function c(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}r.d(e,{a:()=>l});var l=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.id||"local_player",this.isLocalPlayer=void 0===e.isLocalPlayer||e.isLocalPlayer,this.position=e.position||{x:0,y:0,z:0},this.rotation=e.rotation||{x:0,y:0,z:0},this.direction={x:0,z:-1},this.health=e.health||100,this.maxHealth=e.maxHealth||100,this.speed=e.speed||5,this.weapon=e.weapon||"pistol",this.ammo=e.ammo||30,this.weaponType="single",this.fireRate=500,this.recoil={x:.05,y:.05},this.inventory=e.inventory||{items:[],maxSlots:25},this.isMoving=!1,this.isRunning=!1,this.isAiming=!1,this.isShooting=!1,this.canShoot=!0,this.lastShootTime=0,this.currentState="idle",this.viewAngle=90,this.normalViewAngle=90,this.aimingViewAngle=45,this.runningViewAngle=70,this.viewDistance=50,this.normalSpeed=5,this.runningSpeed=7.5,this.aimingSpeed=1.5,this.acceleration=10,this.velocity={x:0,z:0},this.renderer=e.renderer,this.input=e.input,this.game=e.game,this.mesh=null,this.isLocalPlayer&&this.setupControls(),this.createModel()},(e=[{key:"createModel",value:function(){this.renderer&&(this.mesh=this.renderer.addPlayer({position:this.position,rotation:this.rotation,isLocalPlayer:this.isLocalPlayer}))}},{key:"setupControls",value:function(){var t=this;this.input&&(this.input.setMouseDownCallback((function(e,r){0===e&&t.startAiming()})),this.input.setMouseUpCallback((function(e){0===e&&t.stopAiming()})),this.input.setRightClickCallback((function(){t.tryShoot()})),this.input.setMouseMoveCallback((function(e,r){t.handleMouseMove(e)})))}},{key:"startAiming",value:function(){this.isAiming=!0,this.speed=this.aimingSpeed,this.viewAngle=this.aimingViewAngle,console.log("Начало прицеливания")}},{key:"stopAiming",value:function(){this.isAiming=!1,this.speed=this.normalSpeed,this.viewAngle=this.normalViewAngle,console.log("Конец прицеливания")}},{key:"tryShoot",value:function(){var t=this;if(this.isAiming&&this.canShoot&&!(this.ammo<=0)){var e=Date.now();e-this.lastShootTime<this.fireRate||(this.lastShootTime=e,this.ammo--,this.isShooting=!0,setTimeout((function(){t.isShooting=!1}),100),this.applyRecoil(),this.createShot(),"single"===this.weaponType&&(this.canShoot=!1,setTimeout((function(){t.canShoot=!0}),this.fireRate)),this.game&&this.game.network&&this.game.network.sendPlayerShoot(this.position,this.direction,this.weapon))}}},{key:"applyRecoil",value:function(){var t=(Math.random()-.5)*this.recoil.x*2,e=-Math.abs(Math.random()*this.recoil.y),r=this.input.getMousePosition(),i={x:r.x+100*t,y:r.y+100*e};this.handleMouseMove(i)}},{key:"handleMouseMove",value:function(t){var e=this.renderer.canvas.getBoundingClientRect(),r=e.left+e.width/2,i=e.top+e.height/2,n={x:t.x-r,y:t.y-i},o=Math.sqrt(n.x*n.x+n.y*n.y);o>0&&(n.x/=o,n.y/=o);var a=Math.atan2(n.x,-n.y);this.rotation.y=a,this.direction={x:Math.sin(a),z:-Math.cos(a)}}},{key:"update",value:function(t){t&&(this.isLocalPlayer&&(this.handleMovement(t),this.renderer&&this.renderer.updateCamera(this.position),this.handleRunning(),this.updateAnimationState()),this.updateModel())}},{key:"handleRunning",value:function(){if(this.input){var t=this.isRunning;this.input.isKeyPressed("ShiftLeft")&&!this.isAiming?this.isRunning||(this.isRunning=!0,this.speed=this.runningSpeed,this.viewAngle=this.runningViewAngle):this.isRunning&&(this.isRunning=!1,this.speed=this.isAiming?this.aimingSpeed:this.normalSpeed,this.viewAngle=this.isAiming?this.aimingViewAngle:this.normalViewAngle),t!==this.isRunning&&console.log(this.isRunning?"Начало бега":"Конец бега")}}},{key:"updateAnimationState",value:function(){var t="idle";this.isMoving&&(t=this.isRunning?"run":"walk"),this.isAiming&&(t="aim"),this.isShooting&&(t="shoot"),this.currentState!==t&&(this.currentState=t,console.log("Состояние анимации: ".concat(this.currentState)))}},{key:"handleMovement",value:function(t){if(this.input){var e=this.input.getMovementDirection();if(0===e.x&&0===e.z)this.velocity.x*=.9,this.velocity.z*=.9,Math.abs(this.velocity.x)<.01&&Math.abs(this.velocity.z)<.01&&(this.velocity.x=0,this.velocity.z=0,this.isMoving=!1);else{this.isMoving=!0;var r=Math.sqrt(e.x*e.x+e.z*e.z),i={x:e.x/r,z:e.z/r},n={x:i.x*this.speed,z:i.z*this.speed};this.velocity.x+=(n.x-this.velocity.x)*this.acceleration*t,this.velocity.z+=(n.z-this.velocity.z)*this.acceleration*t}var o=this.position.x+this.velocity.x*t,a=this.position.z+this.velocity.z*t,s=this.checkCollision({x:o,y:this.position.y,z:this.position.z}),c=this.checkCollision({x:this.position.x,y:this.position.y,z:a});s?this.position.x=o:this.velocity.x=0,c?this.position.z=a:this.velocity.z=0,this.game&&this.game.network&&this.game.network.sendPlayerMove(this.position,this.rotation)}}},{key:"checkCollision",value:function(t){return!(Math.abs(t.x)>500||Math.abs(t.z)>500)}},{key:"createShot",value:function(){if(this.renderer&&this.renderer.scene){var t=o({},this.position);t.y+=1;var e={x:t.x+100*this.direction.x,y:t.y,z:t.z+100*this.direction.z};this.renderer.createTemporaryBeam(t,e,16711680,100),console.log("Выстрел!",this.direction)}}},{key:"updateModel",value:function(){this.mesh&&this.renderer&&this.renderer.updateObjectTransform(this.mesh,this.position,this.rotation)}},{key:"getViewAngle",value:function(){return this.viewAngle}},{key:"getViewDistance",value:function(){return this.viewDistance}},{key:"getViewDirection",value:function(){return o({},this.direction)}}])&&s(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}()},1062:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{u:()=>a});var n=r(5063),o=t([n]);n=(o.then?(await o)():o)[0];class a{free(){this.raw&&this.raw.free(),this.raw=void 0}constructor(t){this.raw=t||new n.Y6}}i()}catch(t){i(t)}}))},1119:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{BM:()=>n.B,EW:()=>o.E,Lu:()=>a.L,W0:()=>n.W,lx:()=>o.l});var n=r(1923),o=r(8365),a=r(2125),s=t([n,o,a]);[n,o,a]=s.then?(await s)():s,i()}catch(t){i(t)}}))},1332:(t,e,r)=>{r.a(t,(async(t,e)=>{try{var i=r(147),n=r(2472),o=t([i,n]);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(e&&("object"==s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}function w(t,e,r){return(e=f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){var e=g(t,"string");return"symbol"==s(e)?e:e+""}function g(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}[i,n]=o.then?(await o)():o,console.log("📦 game.js загружен"),console.log("🧪 Проверка RAPIER (из импорта):",n),console.log("✅ Rapier 3D модуль загружен");var a=function(t){function e(){return c(this,e),t=this,i=arguments,r=_(r=e),l(t,u()?Reflect.construct(r,i||[],_(t).constructor):r.apply(t,i));var t,r,i}return d(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(i.i);w(a,"RAPIER",n),console.log("🚀 DOM загружен. Запускаем игру..."),window.game=new a,e()}catch(y){e(y)}}))},1789:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{W:()=>a});var n=r(147),o=t([n]);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function h(t){var e=u(t,"string");return"symbol"==s(e)?e:e+""}function u(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}n=(o.then?(await o)():o)[0];var a=function(){return t=function t(e){c(this,t),this.game=e,this.handleGlobalError=this.handleGlobalError.bind(this),this.handlePromiseError=this.handlePromiseError.bind(this),window.addEventListener("error",this.handleGlobalError),window.addEventListener("unhandledrejection",this.handlePromiseError)},e=[{key:"setupEventListeners",value:function(){var t=this;try{var e=document.getElementById("start-game");e&&e.addEventListener("click",(function(){return t.game.startGame()}));var r=document.getElementById("settings");r&&r.addEventListener("click",(function(){(0,n.R)("Настройки")}));var i=document.getElementById("close-inventory");if(i&&i.addEventListener("click",(function(){t.game.ui.hideInventory()})),this.game.input&&(this.game.input.addKeyCallback("KeyI",(function(){t.game.state.isInScene("game")&&t.game.ui.toggleInventory()})),this.game.input.addKeyCallback("Escape",(function(){t.game.state.isInScene("game")&&t.game.state.togglePause()}))),window.vkBridge)try{window.vkBridge.send("VKWebAppInit"),(0,n.R)("VK Bridge инициализирован")}catch(t){(0,n.R)("Ошибка инициализации VK Bridge: ".concat(t.message))}window.addEventListener("resize",(function(){t.game.renderer&&t.game.renderer.render(t.game.world.player)})),(0,n.R)("Обработчики событий настроены")}catch(t){throw(0,n.R)("Ошибка настройки обработчиков событий: ".concat(t.message)),t}}},{key:"handleGlobalError",value:function(t){(0,n.R)("Глобальная ошибка: ".concat(t.message," в ").concat(t.filename,":").concat(t.lineno)),this.game.state.isInScene("loading")&&this.game.ui.showErrorScreen("Ошибка: ".concat(t.message)),t.preventDefault()}},{key:"handlePromiseError",value:function(t){var e,r=(null===(e=t.reason)||void 0===e?void 0:e.message)||"Неизвестная ошибка Promise";(0,n.R)("Необработанная ошибка Promise: ".concat(r)),this.game.state.isInScene("loading")&&this.game.ui.showErrorScreen("Ошибка асинхронной операции: ".concat(r)),t.preventDefault()}}],e&&l(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();i()}catch(_){i(_)}}))},1862:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.r(e),r.d(e,{ActiveCollisionTypes:()=>s._j,ActiveEvents:()=>c.OX,ActiveHooks:()=>c.XJ,Ball:()=>s.cx,BroadPhase:()=>s.uf,CCDSolver:()=>a.Am,Capsule:()=>s.wn,CharacterCollision:()=>l.W0,CoefficientCombineRule:()=>a.f5,Collider:()=>s.Jo,ColliderDesc:()=>s.EN,ColliderSet:()=>s.Zf,ColliderShapeCastHit:()=>s.k2,Cone:()=>s.Sd,ConvexPolyhedron:()=>s.qe,Cuboid:()=>s.JP,Cylinder:()=>s.T,DebugRenderBuffers:()=>c.BD,DebugRenderPipeline:()=>c.ef,DynamicRayCastVehicleController:()=>l.Lu,EventQueue:()=>c.Cb,FeatureType:()=>s.lo,FixedImpulseJoint:()=>a.ik,FixedMultibodyJoint:()=>a.yB,GenericImpulseJoint:()=>a.Vn,HalfSpace:()=>s.G9,HeightFieldFlags:()=>s.fn,Heightfield:()=>s.cW,ImpulseJoint:()=>a.Qz,ImpulseJointSet:()=>a.eQ,IntegrationParameters:()=>a.Dr,IslandManager:()=>a.xt,JointAxesMask:()=>a.Qm,JointData:()=>a.Po,JointType:()=>a.DO,KinematicCharacterController:()=>l.BM,MassPropsMode:()=>s.an,MotorModel:()=>a.rA,MultibodyJoint:()=>a.eB,MultibodyJointSet:()=>a.O9,NarrowPhase:()=>s.XB,PhysicsPipeline:()=>c.Mv,PidAxesMask:()=>l.lx,PidController:()=>l.EW,PointColliderProjection:()=>s.Uv,PointProjection:()=>s.gP,Polyline:()=>s.Ro,PrismaticImpulseJoint:()=>a.a7,PrismaticMultibodyJoint:()=>a.c$,Quaternion:()=>o.PT,QueryFilterFlags:()=>c.Y3,QueryPipeline:()=>c.xi,Ray:()=>s.Rl,RayColliderHit:()=>s.OM,RayColliderIntersection:()=>s.I0,RayIntersection:()=>s.cU,RevoluteImpulseJoint:()=>a.ux,RevoluteMultibodyJoint:()=>a.y,RigidBody:()=>a.Ux,RigidBodyDesc:()=>a.Vk,RigidBodySet:()=>a.kn,RigidBodyType:()=>a.Om,RopeImpulseJoint:()=>a.CA,RotationOps:()=>o.PB,RoundCone:()=>s.WE,RoundConvexPolyhedron:()=>s._D,RoundCuboid:()=>s.d2,RoundCylinder:()=>s.ti,RoundTriangle:()=>s.tt,SdpMatrix3:()=>o.Qr,SdpMatrix3Ops:()=>o.K,Segment:()=>s.Y4,SerializationPipeline:()=>c.pc,Shape:()=>s.yp,ShapeCastHit:()=>s.GH,ShapeContact:()=>s._1,ShapeType:()=>s.IO,SolverFlags:()=>c.LD,SphericalImpulseJoint:()=>a.Rc,SphericalMultibodyJoint:()=>a.p9,SpringImpulseJoint:()=>a.vH,TempContactForceEvent:()=>c.S6,TempContactManifold:()=>s.BQ,TriMesh:()=>s.z6,TriMeshFlags:()=>s.I8,Triangle:()=>s.lM,UnitImpulseJoint:()=>a.eN,UnitMultibodyJoint:()=>a.qe,Vector3:()=>o.Pq,VectorOps:()=>o.if,World:()=>c.HK,version:()=>u});var n=r(5063),o=r(7707),a=r(216),s=r(6414),c=r(96),l=(r(2235),r(1119)),h=t([n,o,a,s,c,l]);function u(){return(0,n.rE)()}[n,o,a,s,c,l]=h.then?(await h)():h,i()}catch(_){i(_)}}))},1923:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{B:()=>c,W:()=>s});var n=r(5063),o=r(7707),a=t([n,o]);[n,o]=a.then?(await a)():a;class s{}class c{constructor(t,e,r,i,o){this.params=e,this.bodies=r,this.colliders=i,this.queries=o,this.raw=new n.Ry(t),this.rawCharacterCollision=new n.eW,this._applyImpulsesToDynamicBodies=!1,this._characterMass=null}free(){this.raw&&(this.raw.free(),this.rawCharacterCollision.free()),this.raw=void 0,this.rawCharacterCollision=void 0}up(){return this.raw.up()}setUp(t){let e=o.if.intoRaw(t);return this.raw.setUp(e)}applyImpulsesToDynamicBodies(){return this._applyImpulsesToDynamicBodies}setApplyImpulsesToDynamicBodies(t){this._applyImpulsesToDynamicBodies=t}characterMass(){return this._characterMass}setCharacterMass(t){this._characterMass=t}offset(){return this.raw.offset()}setOffset(t){this.raw.setOffset(t)}normalNudgeFactor(){return this.raw.normalNudgeFactor()}setNormalNudgeFactor(t){this.raw.setNormalNudgeFactor(t)}slideEnabled(){return this.raw.slideEnabled()}setSlideEnabled(t){this.raw.setSlideEnabled(t)}autostepMaxHeight(){return this.raw.autostepMaxHeight()}autostepMinWidth(){return this.raw.autostepMinWidth()}autostepIncludesDynamicBodies(){return this.raw.autostepIncludesDynamicBodies()}autostepEnabled(){return this.raw.autostepEnabled()}enableAutostep(t,e,r){this.raw.enableAutostep(t,e,r)}disableAutostep(){return this.raw.disableAutostep()}maxSlopeClimbAngle(){return this.raw.maxSlopeClimbAngle()}setMaxSlopeClimbAngle(t){this.raw.setMaxSlopeClimbAngle(t)}minSlopeSlideAngle(){return this.raw.minSlopeSlideAngle()}setMinSlopeSlideAngle(t){this.raw.setMinSlopeSlideAngle(t)}snapToGroundDistance(){return this.raw.snapToGroundDistance()}enableSnapToGround(t){this.raw.enableSnapToGround(t)}disableSnapToGround(){this.raw.disableSnapToGround()}snapToGroundEnabled(){return this.raw.snapToGroundEnabled()}computeColliderMovement(t,e,r,i,n){let a=o.if.intoRaw(e);this.raw.computeColliderMovement(this.params.dt,this.bodies.raw,this.colliders.raw,this.queries.raw,t.handle,a,this._applyImpulsesToDynamicBodies,this._characterMass,r,i,this.colliders.castClosure(n)),a.free()}computedMovement(){return o.if.fromRaw(this.raw.computedMovement())}computedGrounded(){return this.raw.computedGrounded()}numComputedCollisions(){return this.raw.numComputedCollisions()}computedCollision(t,e){if(this.raw.computedCollision(t,this.rawCharacterCollision)){let t=this.rawCharacterCollision;return(e=null!=e?e:new s).translationDeltaApplied=o.if.fromRaw(t.translationDeltaApplied()),e.translationDeltaRemaining=o.if.fromRaw(t.translationDeltaRemaining()),e.toi=t.toi(),e.witness1=o.if.fromRaw(t.worldWitness1()),e.witness2=o.if.fromRaw(t.worldWitness2()),e.normal1=o.if.fromRaw(t.worldNormal1()),e.normal2=o.if.fromRaw(t.worldNormal2()),e.collider=this.colliders.get(t.handle()),e}return null}}i()}catch(t){i(t)}}))},1966:(t,e,r)=>{function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return(e=c(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,c(i.key),i)}}function c(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}r.d(e,{I:()=>l});var l=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.socket=null,this.connected=!1,this.serverUrl="wss://your-server-url.com",this.mockMode=!0,this.eventHandlers={connect:[],disconnect:[],error:[],message:[],playerMove:[],playerShoot:[],playerDamage:[],itemPickup:[],npcSpawn:[],npcMove:[],gameState:[]},this.mockData={players:{},npcs:{},items:{}},this.playerId="local_player"},(e=[{key:"connect",value:function(){var t=this;return new Promise((function(e){console.log("Запущен режим прототипа (без сервера)"),t.connected=!0,t.generateMockData(),setTimeout((function(){t.eventHandlers.connect.forEach((function(t){return t()})),t.startMockNpcMovement(),e()}),500)}))}},{key:"generateMockData",value:function(){for(var t=0;t<15;t++){var e="item_".concat(t),r=80*(Math.random()-.5),i=80*(Math.random()-.5),n=["weapon","medkit","ammo"],o=n[Math.floor(Math.random()*n.length)];this.mockData.items[e]={id:e,type:o,position:{x:r,y:0,z:i},properties:{}}}for(var a=0;a<5;a++){var s="npc_".concat(a),c=80*(Math.random()-.5),l=80*(Math.random()-.5);this.mockData.npcs[s]={id:s,type:"enemy",position:{x:c,y:0,z:l},health:100,state:"patrol"}}}},{key:"startMockNpcMovement",value:function(){var t=this;setInterval((function(){Object.keys(t.mockData.npcs).forEach((function(e){var r=t.mockData.npcs[e],i=2*(Math.random()-.5),n=2*(Math.random()-.5);r.position.x+=i,r.position.z+=n,r.position.x=Math.max(-45,Math.min(45,r.position.x)),r.position.z=Math.max(-45,Math.min(45,r.position.z)),t.eventHandlers.npcMove.forEach((function(t){return t({id:e,position:r.position})}))}))}),1e3)}},{key:"on",value:function(t,e){this.eventHandlers[t]&&this.eventHandlers[t].push(e)}},{key:"sendPlayerMove",value:function(t,e){this.connected&&this.mockMode&&(this.mockData.players[this.playerId]=o(o({},this.mockData.players[this.playerId]),{},{position:t,rotation:e}))}},{key:"sendPlayerShoot",value:function(t,e,r){this.connected&&console.log("Выстрел игрока:",{position:t,direction:e,weapon:r})}},{key:"sendItemPickup",value:function(t,e){this.connected&&(console.log("Подбор предмета:",{itemId:t,itemType:e}),this.mockMode&&delete this.mockData.items[t])}}])&&s(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}()},2091:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{H:()=>a});var n=r(5440),o=t([n]);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,n,o,a,s=[],c=!0,l=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(i=o.call(r)).done)&&(s.push(i.value),s.length!==e);c=!0);}catch(t){l=!0,n=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw n}}return s}}function h(t){if(Array.isArray(t))return t}function u(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _(t,e){if(t){if("string"==typeof t)return d(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}function p(){p=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function u(t,e,r,i){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),s=new A(i||[]);return n(a,"_invoke",{value:k(t,r,s)}),a}function _(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",w="suspendedYield",f="executing",g="completed",y={};function m(){}function b(){}function v(){}var S={};h(S,a,(function(){return this}));var R=Object.getPrototypeOf,E=R&&R(R(j([])));E&&E!==r&&i.call(E,a)&&(S=E);var x=v.prototype=m.prototype=Object.create(S);function C(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,o,a,c){var l=_(t[n],t,o);if("throw"!==l.type){var h=l.arg,u=h.value;return u&&"object"==s(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(u).then((function(t){h.value=t,a(h)}),(function(t){return r("throw",t,a,c)}))}c(l.arg)}var o;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return o=o?o.then(n,n):n()}})}function k(e,r,i){var n=d;return function(o,a){if(n===f)throw Error("Generator is already running");if(n===g){if("throw"===o)throw a;return{value:t,done:!0}}for(i.method=o,i.arg=a;;){var s=i.delegate;if(s){var c=M(s,i);if(c){if(c===y)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===d)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=f;var l=_(e,r,i);if("normal"===l.type){if(n=i.done?g:w,l.arg===y)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=g,i.method="throw",i.arg=l.arg)}}}function M(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,M(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=_(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function j(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(s(e)+" is not iterable")}return b.prototype=v,n(x,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:b,configurable:!0}),b.displayName=h(v,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,h(t,l,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},C(P.prototype),h(P.prototype,c,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var a=new P(u(t,r,i,n),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},C(x),h(x,l,"Generator"),h(x,a,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=j,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return s.type="throw",s.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:j(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function w(t,e,r,i,n,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(i,n)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(t){w(o,i,n,a,s,"next",t)}function s(t){w(o,i,n,a,s,"throw",t)}a(void 0)}))}}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,m(i.key),i)}}function m(t){var e=b(t,"string");return"symbol"==s(e)?e:e+""}function b(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}n=(o.then?(await o)():o)[0];var a=function(){return t=function t(){g(this,t),this.world=null,this.bodies=new Map,this.colliders=new Map,this.isInitialized=!1,this.RAPIER=null,this.initPromise=null},e=[{key:"init",value:(r=f(p().mark((function t(){var e=this;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initPromise){t.next=2;break}return t.abrupt("return",this.initPromise);case 2:return this.initPromise=new Promise(function(){var t=f(p().mark((function t(r){var i,o;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("PhysicsManager: начало инициализации..."),t.next=4,(0,n.K)();case 4:if(e.RAPIER=t.sent,console.log("PhysicsManager: создание физического мира..."),o={x:0,y:-9.81,z:0},"function"!=typeof e.RAPIER.World){t.next=11;break}e.world=new e.RAPIER.World(o),t.next=18;break;case 11:if("function"!=typeof(null===(i=e.RAPIER.World)||void 0===i?void 0:i.new)){t.next=15;break}e.world=e.RAPIER.World.new(o),t.next=18;break;case 15:return console.error("PhysicsManager: не удалось создать физический мир. Неподдерживаемый API."),r(!1),t.abrupt("return");case 18:e.isInitialized=!0,console.log("PhysicsManager: физический движок успешно инициализирован."),r(!0),t.next=28;break;case 23:t.prev=23,t.t0=t.catch(0),console.error("PhysicsManager: ошибка при инициализации физики:",t.t0),e.isInitialized=!1,r(!1);case 28:case"end":return t.stop()}}),t,null,[[0,23]])})));return function(e){return t.apply(this,arguments)}}()),t.abrupt("return",this.initPromise);case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"isReady",value:function(){return this.isInitialized&&null!==this.world}},{key:"getWorld",value:function(){return this.world}},{key:"update",value:function(t){if(this.isReady())try{"function"==typeof this.world.step?this.world.step():"function"==typeof this.world.timestep&&this.world.timestep(t||1/60),this.updateBodies()}catch(t){console.error("PhysicsManager: ошибка при обновлении физики:",t)}}},{key:"updateBodies",value:function(){try{var t,e=u(this.bodies);try{for(e.s();!(t=e.n()).done;){var r=(a=t.value,h(a)||l(a,2)||_(a,2)||c()),i=r[0],n=r[1];if(i&&i.position&&n){var o=void 0;if("function"==typeof n.translation)o=n.translation();else if("function"==typeof n.getTranslation)o=n.getTranslation();else{if(!n.translation)continue;o=n.translation}i.position.set(o.x,o.y,o.z),"function"==typeof i.updatePhysics&&i.updatePhysics(n)}}}catch(t){e.e(t)}finally{e.f()}}catch(t){console.error("PhysicsManager: ошибка при обновлении позиций объектов:",t)}var a}},{key:"createObstacle",value:function(t){if(!this.isReady())return null;try{var e,r=t.position||{x:0,y:0,z:0},i=t.size||{x:1,y:1,z:1};"function"==typeof this.RAPIER.RigidBodyDesc.fixed?e=this.RAPIER.RigidBodyDesc.fixed().setTranslation(r.x,r.y,r.z):(e=new this.RAPIER.RigidBodyDesc(this.RAPIER.RigidBodyType.Fixed)).translation={x:r.x,y:r.y,z:r.z};var n,o=this.world.createRigidBody(e);n="function"==typeof this.RAPIER.ColliderDesc.cuboid?this.RAPIER.ColliderDesc.cuboid(i.x/2,i.y/2,i.z/2):new this.RAPIER.ColliderDesc(new this.RAPIER.Cuboid(i.x/2,i.y/2,i.z/2));var a=this.world.createCollider(n,o);return t.object&&(this.bodies.set(t.object,o),this.colliders.set(t.object,a)),a}catch(t){return console.error("PhysicsManager: ошибка при создании препятствия:",t),null}}},{key:"createCharacter",value:function(t){if(!this.isReady())return null;try{var e,r=t.position||{x:0,y:0,z:0},i=t.radius||.5,n=t.height||1.8;"function"==typeof this.RAPIER.RigidBodyDesc.dynamic?e=this.RAPIER.RigidBodyDesc.dynamic().setTranslation(r.x,r.y,r.z).setCanSleep(!1).setLinearDamping(.2):((e=new this.RAPIER.RigidBodyDesc(this.RAPIER.RigidBodyType.Dynamic)).translation={x:r.x,y:r.y,z:r.z},e.canSleep=!1,e.linearDamping=.2);var o,a=this.world.createRigidBody(e);o="function"==typeof this.RAPIER.ColliderDesc.capsule?this.RAPIER.ColliderDesc.capsule(n/2-i,i):new this.RAPIER.ColliderDesc(new this.RAPIER.Capsule(n/2-i,i));var s=this.world.createCollider(o,a);return t.object&&(this.bodies.set(t.object,a),this.colliders.set(t.object,s)),a}catch(t){return console.error("PhysicsManager: ошибка при создании персонажа:",t),null}}},{key:"castRay",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;if(!this.isReady())return null;try{var i;return i="function"==typeof this.RAPIER.Ray?new this.RAPIER.Ray(t,e):{origin:t,direction:e},"function"==typeof this.world.castRay?this.world.castRay(i,r,!0):"function"==typeof this.world.castRayAndGetNormal?this.world.castRayAndGetNormal(t,e,r,!0):(console.warn("PhysicsManager: метод рейкаста не доступен"),null)}catch(t){return console.error("PhysicsManager: ошибка при выполнении рейкаста:",t),null}}},{key:"createGround",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isReady())return null;try{var e,r=t.normal||{x:0,y:1,z:0},i=t.offset||0;e="function"==typeof this.RAPIER.RigidBodyDesc.fixed?this.RAPIER.RigidBodyDesc.fixed():new this.RAPIER.RigidBodyDesc(this.RAPIER.RigidBodyType.Fixed);var n,o=this.world.createRigidBody(e);return n="function"==typeof this.RAPIER.ColliderDesc.halfspace?this.RAPIER.ColliderDesc.halfspace(r,i):new this.RAPIER.ColliderDesc(new this.RAPIER.HalfSpace(r,i)),this.world.createCollider(n,o)}catch(t){return console.error("PhysicsManager: ошибка при создании плоскости:",t),null}}},{key:"removeBody",value:function(t){try{if(this.bodies.has(t)){var e=this.bodies.get(t);this.world.removeRigidBody(e),this.bodies.delete(t)}this.colliders.has(t)&&this.colliders.delete(t)}catch(t){console.error("PhysicsManager: ошибка при удалении тела:",t)}}},{key:"dispose",value:function(){try{this.bodies.clear(),this.colliders.clear(),this.world&&("function"==typeof this.world.free&&this.world.free(),this.world=null),this.isInitialized=!1,this.initPromise=null,console.log("PhysicsManager: ресурсы освобождены")}catch(t){console.error("PhysicsManager: ошибка при освобождении ресурсов:",t)}}}],e&&y(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();i()}catch(v){i(v)}}))},2125:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{L:()=>s});var n=r(5063),o=r(7707),a=t([n,o]);[n,o]=a.then?(await a)():a;class s{constructor(t,e,r,i){this.raw=new n.BX(t.handle),this.bodies=e,this.colliders=r,this.queries=i,this._chassis=t}free(){this.raw&&this.raw.free(),this.raw=void 0}updateVehicle(t,e,r,i){this.raw.update_vehicle(t,this.bodies.raw,this.colliders.raw,this.queries.raw,e,r,this.colliders.castClosure(i))}currentVehicleSpeed(){return this.raw.current_vehicle_speed()}chassis(){return this._chassis}get indexUpAxis(){return this.raw.index_up_axis()}set indexUpAxis(t){this.raw.set_index_up_axis(t)}get indexForwardAxis(){return this.raw.index_forward_axis()}set setIndexForwardAxis(t){this.raw.set_index_forward_axis(t)}addWheel(t,e,r,i,n){let a=o.if.intoRaw(t),s=o.if.intoRaw(e),c=o.if.intoRaw(r);this.raw.add_wheel(a,s,c,i,n),a.free(),s.free(),c.free()}numWheels(){return this.raw.num_wheels()}wheelChassisConnectionPointCs(t){return o.if.fromRaw(this.raw.wheel_chassis_connection_point_cs(t))}setWheelChassisConnectionPointCs(t,e){let r=o.if.intoRaw(e);this.raw.set_wheel_chassis_connection_point_cs(t,r),r.free()}wheelSuspensionRestLength(t){return this.raw.wheel_suspension_rest_length(t)}setWheelSuspensionRestLength(t,e){this.raw.set_wheel_suspension_rest_length(t,e)}wheelMaxSuspensionTravel(t){return this.raw.wheel_max_suspension_travel(t)}setWheelMaxSuspensionTravel(t,e){this.raw.set_wheel_max_suspension_travel(t,e)}wheelRadius(t){return this.raw.wheel_radius(t)}setWheelRadius(t,e){this.raw.set_wheel_radius(t,e)}wheelSuspensionStiffness(t){return this.raw.wheel_suspension_stiffness(t)}setWheelSuspensionStiffness(t,e){this.raw.set_wheel_suspension_stiffness(t,e)}wheelSuspensionCompression(t){return this.raw.wheel_suspension_compression(t)}setWheelSuspensionCompression(t,e){this.raw.set_wheel_suspension_compression(t,e)}wheelSuspensionRelaxation(t){return this.raw.wheel_suspension_relaxation(t)}setWheelSuspensionRelaxation(t,e){this.raw.set_wheel_suspension_relaxation(t,e)}wheelMaxSuspensionForce(t){return this.raw.wheel_max_suspension_force(t)}setWheelMaxSuspensionForce(t,e){this.raw.set_wheel_max_suspension_force(t,e)}wheelBrake(t){return this.raw.wheel_brake(t)}setWheelBrake(t,e){this.raw.set_wheel_brake(t,e)}wheelSteering(t){return this.raw.wheel_steering(t)}setWheelSteering(t,e){this.raw.set_wheel_steering(t,e)}wheelEngineForce(t){return this.raw.wheel_engine_force(t)}setWheelEngineForce(t,e){this.raw.set_wheel_engine_force(t,e)}wheelDirectionCs(t){return o.if.fromRaw(this.raw.wheel_direction_cs(t))}setWheelDirectionCs(t,e){let r=o.if.intoRaw(e);this.raw.set_wheel_direction_cs(t,r),r.free()}wheelAxleCs(t){return o.if.fromRaw(this.raw.wheel_axle_cs(t))}setWheelAxleCs(t,e){let r=o.if.intoRaw(e);this.raw.set_wheel_axle_cs(t,r),r.free()}wheelFrictionSlip(t){return this.raw.wheel_friction_slip(t)}setWheelFrictionSlip(t,e){this.raw.set_wheel_friction_slip(t,e)}wheelSideFrictionStiffness(t){return this.raw.wheel_side_friction_stiffness(t)}setWheelSideFrictionStiffness(t,e){this.raw.set_wheel_side_friction_stiffness(t,e)}wheelRotation(t){return this.raw.wheel_rotation(t)}wheelForwardImpulse(t){return this.raw.wheel_forward_impulse(t)}wheelSideImpulse(t){return this.raw.wheel_side_impulse(t)}wheelSuspensionForce(t){return this.raw.wheel_suspension_force(t)}wheelContactNormal(t){return o.if.fromRaw(this.raw.wheel_contact_normal_ws(t))}wheelContactPoint(t){return o.if.fromRaw(this.raw.wheel_contact_point_ws(t))}wheelSuspensionLength(t){return this.raw.wheel_suspension_length(t)}wheelHardPoint(t){return o.if.fromRaw(this.raw.wheel_hard_point_ws(t))}wheelIsInContact(t){return this.raw.wheel_is_in_contact(t)}wheelGroundObject(t){return this.colliders.get(this.raw.wheel_ground_object(t))}}i()}catch(t){i(t)}}))},2130:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{_:()=>a});var n=r(7707),o=t([n]);n=(o.then?(await o)():o)[0];class a{constructor(t,e,r,i,n){this.distance=t,this.point1=e,this.point2=r,this.normal1=i,this.normal2=n}static fromRaw(t){if(!t)return null;const e=new a(t.distance(),n.if.fromRaw(t.point1()),n.if.fromRaw(t.point2()),n.if.fromRaw(t.normal1()),n.if.fromRaw(t.normal2()));return t.free(),e}}i()}catch(t){i(t)}}))},2150:(t,e,r)=>{function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(){n=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",h=s.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function _(t,e,r,i){var n=e&&e.prototype instanceof m?e:m,o=Object.create(n.prototype),s=new A(i||[]);return a(o,"_invoke",{value:k(t,r,s)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=_;var p="suspendedStart",w="suspendedYield",f="executing",g="completed",y={};function m(){}function b(){}function v(){}var S={};u(S,c,(function(){return this}));var R=Object.getPrototypeOf,E=R&&R(R(j([])));E&&E!==r&&o.call(E,c)&&(S=E);var x=v.prototype=m.prototype=Object.create(S);function C(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,a,s,c){var l=d(t[n],t,a);if("throw"!==l.type){var h=l.arg,u=h.value;return u&&"object"==i(u)&&o.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,s,c)}),(function(t){r("throw",t,s,c)})):e.resolve(u).then((function(t){h.value=t,s(h)}),(function(t){return r("throw",t,s,c)}))}c(l.arg)}var n;a(this,"_invoke",{value:function(t,i){function o(){return new e((function(e,n){r(t,i,e,n)}))}return n=n?n.then(o,o):o()}})}function k(e,r,i){var n=p;return function(o,a){if(n===f)throw Error("Generator is already running");if(n===g){if("throw"===o)throw a;return{value:t,done:!0}}for(i.method=o,i.arg=a;;){var s=i.delegate;if(s){var c=M(s,i);if(c){if(c===y)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===p)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=f;var l=d(e,r,i);if("normal"===l.type){if(n=i.done?g:w,l.arg===y)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=g,i.method="throw",i.arg=l.arg)}}}function M(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,M(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=d(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function j(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function r(){for(;++n<e.length;)if(o.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return b.prototype=v,a(x,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:b,configurable:!0}),b.displayName=u(v,h,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,h,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},C(P.prototype),u(P.prototype,l,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var a=new P(_(t,r,i,n),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},C(x),u(x,h,"Generator"),u(x,c,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=j,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(i,n){return s.type="throw",s.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var a=n?n.completion:{};return a.type=t,a.arg=e,n?(this.method="next",this.next=n.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:j(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function o(t,e,r,i,n,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(i,n)}function a(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var a=t.apply(e,r);function s(t){o(a,i,n,s,c,"next",t)}function c(t){o(a,i,n,s,c,"throw",t)}s(void 0)}))}}function s(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,c(i.key),i)}}function c(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}r.d(e,{Q:()=>l});var l=function(){return t=function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e.scene&&e.player){this.scene=e.scene,this.world=e.world,this.player=e.player,this.RAPIER=e.rapier,this.fov=void 0!==e.fov?e.fov:90,this.rayCount=e.rayCount||60,this.maxDistance=e.maxDistance||50,this.memoryEnabled=void 0===e.memoryEnabled||e.memoryEnabled,this.blurEdges=void 0===e.blurEdges||e.blurEdges,this.normalFov=90,this.aimingFov=45,this.runningFov=70,this.visibilityMask=null,this.memoryMask=null,this.visibilityShape=null,this.currentVisionMesh=null,this.cellSize=e.cellSize||5,this.gridSize=1e3,this.gridResolution=Math.ceil(this.gridSize/this.cellSize),this.memoryGrid=new Array(this.gridResolution),this.isInitialized=!1,this.isRapierReady=!1,this.isRapierChecked=!1,this.initializationPromise=null,this.lastErrorTime=0,this.updateInterval=e.updateInterval||0,this.lastUpdateTime=0,this.errorCooldown=5e3;for(var r=0;r<this.gridResolution;r++)this.memoryGrid[r]=new Array(this.gridResolution).fill(0);this.visibilityGroup=new THREE.Group,this.scene.add(this.visibilityGroup),this.init()}else console.error("VisionSystem: не указаны обязательные параметры (scene, player)")},e=[{key:"init",value:(i=a(n().mark((function t(){var e=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initializationPromise){t.next=2;break}return t.abrupt("return",this.initializationPromise);case 2:return this.initializationPromise=new Promise(function(){var t=a(n().mark((function t(r){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("VisionSystem: начало инициализации..."),e.initVisibilityLayers(),t.next=5,e.checkRapierAvailability();case 5:e.isInitialized=!0,console.log("VisionSystem: успешно инициализирована"),r(!0),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),console.error("VisionSystem: ошибка при инициализации:",t.t0),r(!1);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()),t.abrupt("return",this.initializationPromise);case 4:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"checkRapierAvailability",value:(r=a(n().mark((function t(){var e=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isRapierChecked){t.next=2;break}return t.abrupt("return",this.isRapierReady);case 2:return t.abrupt("return",new Promise((function(t){var r=function(){var i=e.RAPIER;return console.log("🧪 [vision-system.js:122] RAPIER в updateVisibilityMask:",i),i?(console.log("VisionSystem: RAPIER доступен"),e.isRapierReady=!0,e.isRapierChecked=!0,void t(!0)):!e.world||"function"!=typeof e.world.castRay&&"function"!=typeof e.world.castRayAndGetNormal?void setTimeout(r,100):(console.log("VisionSystem: мир физики доступен и поддерживает рейкасты"),e.isRapierReady=!0,e.isRapierChecked=!0,void t(!0))};r()})));case 3:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"initVisibilityLayers",value:function(){this.createFogOfWarLayer(),this.createMemoryLayer(),this.createVisionConeLayer()}},{key:"createFogOfWarLayer",value:function(){var t=new THREE.PlaneGeometry(1.5*this.gridSize,1.5*this.gridSize),e=new THREE.MeshBasicMaterial({color:0,transparent:!0,opacity:.95,side:THREE.DoubleSide,depthTest:!1,depthWrite:!1});this.fogOfWarMesh=new THREE.Mesh(t,e),this.fogOfWarMesh.rotation.x=-Math.PI/2,this.fogOfWarMesh.position.y=.3,this.fogOfWarMesh.renderOrder=997,this.visibilityGroup.add(this.fogOfWarMesh)}},{key:"createMemoryLayer",value:function(){var t=new THREE.PlaneGeometry(1.5*this.gridSize,1.5*this.gridSize,this.gridResolution,this.gridResolution),e=new THREE.ShaderMaterial({uniforms:{opacity:{value:.7},colorInfluence:{value:.2}},vertexShader:"\n                varying vec2 vUv;\n                varying vec3 vPosition;\n                \n                void main() {\n                    vUv = uv;\n                    vPosition = position;\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                }\n            ",fragmentShader:"\n                uniform float opacity;\n                uniform float colorInfluence;\n                \n                varying vec2 vUv;\n                varying vec3 vPosition;\n                \n                void main() {\n                    // В реальной реализации здесь будет использоваться текстура с рендера сцены\n                    // Для прототипа просто делаем ЧБ эффект\n                    gl_FragColor = vec4(0.3, 0.3, 0.3, opacity);\n                }\n            ",transparent:!0,side:THREE.DoubleSide,depthTest:!1,depthWrite:!1});this.memoryMesh=new THREE.Mesh(t,e),this.memoryMesh.rotation.x=-Math.PI/2,this.memoryMesh.position.y=.2,this.memoryMesh.renderOrder=998,this.visibilityGroup.add(this.memoryMesh);for(var r=new Float32Array(t.attributes.position.count),i=0;i<r.length;i++)r[i]=0;t.setAttribute("visibility",new THREE.BufferAttribute(r,1))}},{key:"createVisionConeLayer",value:function(){var t=new THREE.Shape;t.moveTo(0,0),t.lineTo(5,5),t.lineTo(-5,5),t.lineTo(0,0);var e=new THREE.MeshBasicMaterial({color:0,side:THREE.DoubleSide,transparent:!0,opacity:.8,depthTest:!1,depthWrite:!1}),r=1.5*this.gridSize,i=new THREE.PlaneGeometry(r,r);this.visibilityMask=new THREE.Mesh(i,e),this.visibilityMask.rotation.x=-Math.PI/2,this.visibilityMask.position.y=.1,this.visibilityMask.renderOrder=999,this.visibilityGroup.add(this.visibilityMask)}},{key:"isReady",value:function(){return this.isInitialized&&this.isRapierReady&&!!this.world}},{key:"update",value:function(){if(this.isInitialized)if(this.isRapierReady){if(this.player&&this.world){var t=Date.now();if(!(this.updateInterval>0&&t-this.lastUpdateTime<this.updateInterval)){this.lastUpdateTime=t;try{var e=this.player.position,r={x:0,z:-1};"function"==typeof this.player.getViewDirection&&(r=this.player.getViewDirection());var i=this.normalFov;this.player.isAiming?i=this.aimingFov:this.player.isRunning&&(i=this.runningFov);var n=i*Math.PI/180,o=Math.atan2(r.x,r.z);this.updateVisionMask(e,o,n),this.memoryEnabled&&this.updateMemoryMap(e,o,n)}catch(t){var a=Date.now();a-this.lastErrorTime>this.errorCooldown&&(console.error("VisionSystem: ошибка при обновлении:",t),this.lastErrorTime=a)}}}}else this.checkRapierAvailability()}},{key:"updateVisionMask",value:function(t,e,r){var i=this;if(this.isRapierReady&&this.world&&t&&void 0!==e&&void 0!==r)try{var n=this.RAPIER;if(console.log("🧪 [vision-system.js:384] RAPIER в updateVisibilityMask:",n),!n)return void console.warn("VisionSystem: RAPIER не определен при обновлении маски видимости");for(var o=r/2,a={x:t.x,y:t.y+1,z:t.z},s=[],c=0;c<this.rayCount;c++){var l=e-o+c/(this.rayCount-1)*r;s.push(l)}var h=[];h.push(new THREE.Vector2(0,0)),s.forEach((function(t){var e,r={x:Math.sin(t),y:0,z:Math.cos(t)};try{var o;if("function"==typeof n.Ray)o=new n.Ray(a,r);else{if(!n.Ray)return e={x:a.x+r.x*i.maxDistance,z:a.z+r.z*i.maxDistance},void h.push(new THREE.Vector2(e.x-a.x,e.z-a.z));o=n.Ray.new(a,r)}var s=null;if("function"==typeof i.world.castRay)s=i.world.castRay(o,i.maxDistance,!0);else if("function"==typeof i.world.castRayAndGetNormal){var c=i.world.castRayAndGetNormal(a,r,i.maxDistance,!0);s=c.hasHit?c:null}if(s){var l=("function"==typeof s.toi?s.toi():s.toi)*i.maxDistance*.99;e={x:a.x+r.x*l,z:a.z+r.z*l}}else e={x:a.x+r.x*i.maxDistance,z:a.z+r.z*i.maxDistance}}catch(t){console.error("VisionSystem: ошибка при выполнении рейкаста:",t),e={x:a.x+r.x*i.maxDistance,z:a.z+r.z*i.maxDistance}}h.push(new THREE.Vector2(e.x-a.x,e.z-a.z)),i.memoryEnabled&&i.markVisitedArea(e.x,e.z)})),h.length>1&&h.push(h[1].clone()),this.updateVisibilityShape(h,t)}catch(t){console.error("VisionSystem: ошибка при обновлении маски видимости:",t)}}},{key:"updateVisibilityShape",value:function(t,e){if(!t||t.length<3)console.warn("VisionSystem: недостаточно точек для создания формы видимости");else try{var r=new THREE.Shape;r.moveTo(t[0].x,t[0].y);for(var i=1;i<t.length;i++)r.lineTo(t[i].x,t[i].y);var n=2*this.maxDistance,o=new THREE.Shape;o.moveTo(-n,-n),o.lineTo(n,-n),o.lineTo(n,n),o.lineTo(-n,n),o.lineTo(-n,-n),o.holes.push(r),this.visibilityMask&&(this.visibilityMask.geometry&&this.visibilityMask.geometry.dispose(),this.visibilityMask.geometry=new THREE.ShapeGeometry(o),this.visibilityMask.position.set(e.x,.1,e.z))}catch(t){console.error("VisionSystem: ошибка при обновлении формы видимости:",t)}}},{key:"markVisitedArea",value:function(t,e){var r=this.gridSize/2,i=Math.floor((t+r)/this.cellSize),n=Math.floor((e+r)/this.cellSize);if(i>=0&&i<this.gridResolution&&n>=0&&n<this.gridResolution){this.memoryGrid[i][n]=1;for(var o=-1;o<=1;o++)for(var a=-1;a<=1;a++){var s=i+o,c=n+a;s>=0&&s<this.gridResolution&&c>=0&&c<this.gridResolution&&(this.memoryGrid[s][c]=Math.max(this.memoryGrid[s][c],.7))}}}},{key:"updateMemoryMap",value:function(t,e,r){if(this.memoryEnabled&&this.memoryMesh)try{this.fogOfWarMesh&&this.fogOfWarMesh.material}catch(t){console.error("VisionSystem: ошибка при обновлении карты памяти:",t)}}},{key:"setFov",value:function(t){this.fov=t}},{key:"setMaxDistance",value:function(t){this.maxDistance=t}},{key:"setRayCount",value:function(t){this.rayCount=t}},{key:"clearMemory",value:function(){if(this.memoryEnabled){for(var t=0;t<this.gridResolution;t++)for(var e=0;e<this.gridResolution;e++)this.memoryGrid[t][e]=0;console.log("VisionSystem: карта памяти очищена")}}},{key:"dispose",value:function(){try{this.visibilityMask&&(this.visibilityMask.geometry&&this.visibilityMask.geometry.dispose(),this.visibilityMask.material&&this.visibilityMask.material.dispose(),this.visibilityGroup.remove(this.visibilityMask)),this.memoryMesh&&(this.memoryMesh.geometry&&this.memoryMesh.geometry.dispose(),this.memoryMesh.material&&this.memoryMesh.material.dispose(),this.visibilityGroup.remove(this.memoryMesh)),this.fogOfWarMesh&&(this.fogOfWarMesh.geometry&&this.fogOfWarMesh.geometry.dispose(),this.fogOfWarMesh.material&&this.fogOfWarMesh.material.dispose(),this.visibilityGroup.remove(this.fogOfWarMesh)),this.visibilityGroup&&this.scene.remove(this.visibilityGroup),this.visibilityMask=null,this.memoryMesh=null,this.fogOfWarMesh=null,this.visibilityGroup=null,this.memoryGrid=[],this.isInitialized=!1,this.isRapierReady=!1,this.isRapierChecked=!1,this.initializationPromise=null,console.log("VisionSystem: ресурсы успешно освобождены")}catch(t){console.error("VisionSystem: ошибка при освобождении ресурсов:",t)}}}],e&&s(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,i}()},2192:(t,e,r)=>{var i;r.d(e,{l:()=>i}),function(t){t[t.Vertex=0]="Vertex",t[t.Edge=1]="Edge",t[t.Face=2]="Face",t[t.Unknown=3]="Unknown"}(i||(i={}))},2210:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{Om:()=>n,Ux:()=>s,Vk:()=>c});var n,o=r(7707),a=t([o]);o=(a.then?(await a)():a)[0],function(t){t[t.Dynamic=0]="Dynamic",t[t.Fixed=1]="Fixed",t[t.KinematicPositionBased=2]="KinematicPositionBased",t[t.KinematicVelocityBased=3]="KinematicVelocityBased"}(n||(n={}));class s{constructor(t,e,r){this.rawSet=t,this.colliderSet=e,this.handle=r}finalizeDeserialization(t){this.colliderSet=t}isValid(){return this.rawSet.contains(this.handle)}lockTranslations(t,e){return this.rawSet.rbLockTranslations(this.handle,t,e)}lockRotations(t,e){return this.rawSet.rbLockRotations(this.handle,t,e)}setEnabledTranslations(t,e,r,i){return this.rawSet.rbSetEnabledTranslations(this.handle,t,e,r,i)}restrictTranslations(t,e,r,i){this.setEnabledTranslations(t,e,r,i)}setEnabledRotations(t,e,r,i){return this.rawSet.rbSetEnabledRotations(this.handle,t,e,r,i)}restrictRotations(t,e,r,i){this.setEnabledRotations(t,e,r,i)}dominanceGroup(){return this.rawSet.rbDominanceGroup(this.handle)}setDominanceGroup(t){this.rawSet.rbSetDominanceGroup(this.handle,t)}additionalSolverIterations(){return this.rawSet.rbAdditionalSolverIterations(this.handle)}setAdditionalSolverIterations(t){this.rawSet.rbSetAdditionalSolverIterations(this.handle,t)}enableCcd(t){this.rawSet.rbEnableCcd(this.handle,t)}setSoftCcdPrediction(t){this.rawSet.rbSetSoftCcdPrediction(this.handle,t)}softCcdPrediction(){return this.rawSet.rbSoftCcdPrediction(this.handle)}translation(){let t=this.rawSet.rbTranslation(this.handle);return o.if.fromRaw(t)}rotation(){let t=this.rawSet.rbRotation(this.handle);return o.PB.fromRaw(t)}nextTranslation(){let t=this.rawSet.rbNextTranslation(this.handle);return o.if.fromRaw(t)}nextRotation(){let t=this.rawSet.rbNextRotation(this.handle);return o.PB.fromRaw(t)}setTranslation(t,e){this.rawSet.rbSetTranslation(this.handle,t.x,t.y,t.z,e)}setLinvel(t,e){let r=o.if.intoRaw(t);this.rawSet.rbSetLinvel(this.handle,r,e),r.free()}gravityScale(){return this.rawSet.rbGravityScale(this.handle)}setGravityScale(t,e){this.rawSet.rbSetGravityScale(this.handle,t,e)}setRotation(t,e){this.rawSet.rbSetRotation(this.handle,t.x,t.y,t.z,t.w,e)}setAngvel(t,e){let r=o.if.intoRaw(t);this.rawSet.rbSetAngvel(this.handle,r,e),r.free()}setNextKinematicTranslation(t){this.rawSet.rbSetNextKinematicTranslation(this.handle,t.x,t.y,t.z)}setNextKinematicRotation(t){this.rawSet.rbSetNextKinematicRotation(this.handle,t.x,t.y,t.z,t.w)}linvel(){return o.if.fromRaw(this.rawSet.rbLinvel(this.handle))}angvel(){return o.if.fromRaw(this.rawSet.rbAngvel(this.handle))}mass(){return this.rawSet.rbMass(this.handle)}effectiveInvMass(){return o.if.fromRaw(this.rawSet.rbEffectiveInvMass(this.handle))}invMass(){return this.rawSet.rbInvMass(this.handle)}localCom(){return o.if.fromRaw(this.rawSet.rbLocalCom(this.handle))}worldCom(){return o.if.fromRaw(this.rawSet.rbWorldCom(this.handle))}invPrincipalInertiaSqrt(){return o.if.fromRaw(this.rawSet.rbInvPrincipalInertiaSqrt(this.handle))}principalInertia(){return o.if.fromRaw(this.rawSet.rbPrincipalInertia(this.handle))}principalInertiaLocalFrame(){return o.PB.fromRaw(this.rawSet.rbPrincipalInertiaLocalFrame(this.handle))}effectiveWorldInvInertiaSqrt(){return o.K.fromRaw(this.rawSet.rbEffectiveWorldInvInertiaSqrt(this.handle))}effectiveAngularInertia(){return o.K.fromRaw(this.rawSet.rbEffectiveAngularInertia(this.handle))}sleep(){this.rawSet.rbSleep(this.handle)}wakeUp(){this.rawSet.rbWakeUp(this.handle)}isCcdEnabled(){return this.rawSet.rbIsCcdEnabled(this.handle)}numColliders(){return this.rawSet.rbNumColliders(this.handle)}collider(t){return this.colliderSet.get(this.rawSet.rbCollider(this.handle,t))}setEnabled(t){this.rawSet.rbSetEnabled(this.handle,t)}isEnabled(){return this.rawSet.rbIsEnabled(this.handle)}bodyType(){return this.rawSet.rbBodyType(this.handle)}setBodyType(t,e){return this.rawSet.rbSetBodyType(this.handle,t,e)}isSleeping(){return this.rawSet.rbIsSleeping(this.handle)}isMoving(){return this.rawSet.rbIsMoving(this.handle)}isFixed(){return this.rawSet.rbIsFixed(this.handle)}isKinematic(){return this.rawSet.rbIsKinematic(this.handle)}isDynamic(){return this.rawSet.rbIsDynamic(this.handle)}linearDamping(){return this.rawSet.rbLinearDamping(this.handle)}angularDamping(){return this.rawSet.rbAngularDamping(this.handle)}setLinearDamping(t){this.rawSet.rbSetLinearDamping(this.handle,t)}recomputeMassPropertiesFromColliders(){this.rawSet.rbRecomputeMassPropertiesFromColliders(this.handle,this.colliderSet.raw)}setAdditionalMass(t,e){this.rawSet.rbSetAdditionalMass(this.handle,t,e)}setAdditionalMassProperties(t,e,r,i,n){let a=o.if.intoRaw(e),s=o.if.intoRaw(r),c=o.PB.intoRaw(i);this.rawSet.rbSetAdditionalMassProperties(this.handle,t,a,s,c,n),a.free(),s.free(),c.free()}setAngularDamping(t){this.rawSet.rbSetAngularDamping(this.handle,t)}resetForces(t){this.rawSet.rbResetForces(this.handle,t)}resetTorques(t){this.rawSet.rbResetTorques(this.handle,t)}addForce(t,e){const r=o.if.intoRaw(t);this.rawSet.rbAddForce(this.handle,r,e),r.free()}applyImpulse(t,e){const r=o.if.intoRaw(t);this.rawSet.rbApplyImpulse(this.handle,r,e),r.free()}addTorque(t,e){const r=o.if.intoRaw(t);this.rawSet.rbAddTorque(this.handle,r,e),r.free()}applyTorqueImpulse(t,e){const r=o.if.intoRaw(t);this.rawSet.rbApplyTorqueImpulse(this.handle,r,e),r.free()}addForceAtPoint(t,e,r){const i=o.if.intoRaw(t),n=o.if.intoRaw(e);this.rawSet.rbAddForceAtPoint(this.handle,i,n,r),i.free(),n.free()}applyImpulseAtPoint(t,e,r){const i=o.if.intoRaw(t),n=o.if.intoRaw(e);this.rawSet.rbApplyImpulseAtPoint(this.handle,i,n,r),i.free(),n.free()}userForce(){return o.if.fromRaw(this.rawSet.rbUserForce(this.handle))}userTorque(){return o.if.fromRaw(this.rawSet.rbUserTorque(this.handle))}}class c{constructor(t){this.enabled=!0,this.status=t,this.translation=o.if.zeros(),this.rotation=o.PB.identity(),this.gravityScale=1,this.linvel=o.if.zeros(),this.mass=0,this.massOnly=!1,this.centerOfMass=o.if.zeros(),this.translationsEnabledX=!0,this.translationsEnabledY=!0,this.angvel=o.if.zeros(),this.principalAngularInertia=o.if.zeros(),this.angularInertiaLocalFrame=o.PB.identity(),this.translationsEnabledZ=!0,this.rotationsEnabledX=!0,this.rotationsEnabledY=!0,this.rotationsEnabledZ=!0,this.linearDamping=0,this.angularDamping=0,this.canSleep=!0,this.sleeping=!1,this.ccdEnabled=!1,this.softCcdPrediction=0,this.dominanceGroup=0,this.additionalSolverIterations=0}static dynamic(){return new c(n.Dynamic)}static kinematicPositionBased(){return new c(n.KinematicPositionBased)}static kinematicVelocityBased(){return new c(n.KinematicVelocityBased)}static fixed(){return new c(n.Fixed)}static newDynamic(){return new c(n.Dynamic)}static newKinematicPositionBased(){return new c(n.KinematicPositionBased)}static newKinematicVelocityBased(){return new c(n.KinematicVelocityBased)}static newStatic(){return new c(n.Fixed)}setDominanceGroup(t){return this.dominanceGroup=t,this}setAdditionalSolverIterations(t){return this.additionalSolverIterations=t,this}setEnabled(t){return this.enabled=t,this}setTranslation(t,e,r){if("number"!=typeof t||"number"!=typeof e||"number"!=typeof r)throw TypeError("The translation components must be numbers.");return this.translation={x:t,y:e,z:r},this}setRotation(t){return o.PB.copy(this.rotation,t),this}setGravityScale(t){return this.gravityScale=t,this}setAdditionalMass(t){return this.mass=t,this.massOnly=!0,this}setLinvel(t,e,r){if("number"!=typeof t||"number"!=typeof e||"number"!=typeof r)throw TypeError("The linvel components must be numbers.");return this.linvel={x:t,y:e,z:r},this}setAngvel(t){return o.if.copy(this.angvel,t),this}setAdditionalMassProperties(t,e,r,i){return this.mass=t,o.if.copy(this.centerOfMass,e),o.if.copy(this.principalAngularInertia,r),o.PB.copy(this.angularInertiaLocalFrame,i),this.massOnly=!1,this}enabledTranslations(t,e,r){return this.translationsEnabledX=t,this.translationsEnabledY=e,this.translationsEnabledZ=r,this}restrictTranslations(t,e,r){return this.enabledTranslations(t,e,r)}lockTranslations(){return this.enabledTranslations(!1,!1,!1)}enabledRotations(t,e,r){return this.rotationsEnabledX=t,this.rotationsEnabledY=e,this.rotationsEnabledZ=r,this}restrictRotations(t,e,r){return this.enabledRotations(t,e,r)}lockRotations(){return this.restrictRotations(!1,!1,!1)}setLinearDamping(t){return this.linearDamping=t,this}setAngularDamping(t){return this.angularDamping=t,this}setCanSleep(t){return this.canSleep=t,this}setSleeping(t){return this.sleeping=t,this}setCcdEnabled(t){return this.ccdEnabled=t,this}setSoftCcdPrediction(t){return this.softCcdPrediction=t,this}setUserData(t){return this.userData=t,this}}i()}catch(t){i(t)}}))},2231:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{m:()=>a});var n=r(147),o=t([n]);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function h(t){var e=u(t,"string");return"symbol"==s(e)?e:e+""}function u(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}n=(o.then?(await o)():o)[0];var a=function(){return t=function t(e){c(this,t),this.game=e,this.isRunning=!1,this.isLoading=!0,this.isPaused=!1,this.currentScene="loading",this.fogOfWarEnabled=!0,this.visibilitySystemEnabled=!0},(e=[{key:"togglePause",value:function(){this.isRunning?this.pauseGame():this.resumeGame()}},{key:"pauseGame",value:function(){this.isRunning=!1,this.isPaused=!0,this.game.input&&this.game.input.disableGameControls(),(0,n.R)("Игра на паузе")}},{key:"resumeGame",value:function(){this.isRunning=!0,this.isPaused=!1,this.game.input&&this.game.input.enableGameControls(),(0,n.R)("Игра возобновлена"),this.game.lastFrameTime=performance.now(),requestAnimationFrame(this.game.update)}},{key:"endGame",value:function(){this.isRunning=!1,this.currentScene="menu",this.game.world&&this.game.world.clear(),this.game.physics&&this.game.physics.dispose(),this.game.ui&&(this.game.ui.gameCanvas&&this.game.ui.gameCanvas.classList.add("hidden"),this.game.ui.hudElement&&this.game.ui.hudElement.classList.add("hidden"),this.game.ui.mainMenu&&this.game.ui.mainMenu.classList.remove("hidden")),(0,n.R)("Игра завершена")}},{key:"isInScene",value:function(t){return this.currentScene===t}}])&&l(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();i()}catch(_){i(_)}}))},2235:()=>{},2337:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{O:()=>c});var n=r(5063),o=r(8836),a=r(9726),s=t([n,a]);[n,a]=s.then?(await s)():s;class c{free(){this.raw&&this.raw.free(),this.raw=void 0,this.map&&this.map.clear(),this.map=void 0}constructor(t){this.raw=t||new n.YK,this.map=new o.y,t&&t.forEachJointHandle((t=>{this.map.set(t,a.eB.newTyped(this.raw,t))}))}createJoint(t,e,r,i){const n=t.intoRaw(),o=this.raw.createJoint(n,e,r,i);n.free();let s=a.eB.newTyped(this.raw,o);return this.map.set(o,s),s}remove(t,e){this.raw.remove(t,e),this.map.delete(t)}unmap(t){this.map.delete(t)}len(){return this.map.len()}contains(t){return null!=this.get(t)}get(t){return this.map.get(t)}forEach(t){this.map.forEach(t)}forEachJointHandleAttachedToRigidBody(t,e){this.raw.forEachJointAttachedToRigidBody(t,e)}getAll(){return this.map.getAll()}}i()}catch(t){i(t)}}))},2472:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.r(e),r.d(e,{ActiveCollisionTypes:()=>n.ActiveCollisionTypes,ActiveEvents:()=>n.ActiveEvents,ActiveHooks:()=>n.ActiveHooks,Ball:()=>n.Ball,BroadPhase:()=>n.BroadPhase,CCDSolver:()=>n.CCDSolver,Capsule:()=>n.Capsule,CharacterCollision:()=>n.CharacterCollision,CoefficientCombineRule:()=>n.CoefficientCombineRule,Collider:()=>n.Collider,ColliderDesc:()=>n.ColliderDesc,ColliderSet:()=>n.ColliderSet,ColliderShapeCastHit:()=>n.ColliderShapeCastHit,Cone:()=>n.Cone,ConvexPolyhedron:()=>n.ConvexPolyhedron,Cuboid:()=>n.Cuboid,Cylinder:()=>n.Cylinder,DebugRenderBuffers:()=>n.DebugRenderBuffers,DebugRenderPipeline:()=>n.DebugRenderPipeline,DynamicRayCastVehicleController:()=>n.DynamicRayCastVehicleController,EventQueue:()=>n.EventQueue,FeatureType:()=>n.FeatureType,FixedImpulseJoint:()=>n.FixedImpulseJoint,FixedMultibodyJoint:()=>n.FixedMultibodyJoint,GenericImpulseJoint:()=>n.GenericImpulseJoint,HalfSpace:()=>n.HalfSpace,HeightFieldFlags:()=>n.HeightFieldFlags,Heightfield:()=>n.Heightfield,ImpulseJoint:()=>n.ImpulseJoint,ImpulseJointSet:()=>n.ImpulseJointSet,IntegrationParameters:()=>n.IntegrationParameters,IslandManager:()=>n.IslandManager,JointAxesMask:()=>n.JointAxesMask,JointData:()=>n.JointData,JointType:()=>n.JointType,KinematicCharacterController:()=>n.KinematicCharacterController,MassPropsMode:()=>n.MassPropsMode,MotorModel:()=>n.MotorModel,MultibodyJoint:()=>n.MultibodyJoint,MultibodyJointSet:()=>n.MultibodyJointSet,NarrowPhase:()=>n.NarrowPhase,PhysicsPipeline:()=>n.PhysicsPipeline,PidAxesMask:()=>n.PidAxesMask,PidController:()=>n.PidController,PointColliderProjection:()=>n.PointColliderProjection,PointProjection:()=>n.PointProjection,Polyline:()=>n.Polyline,PrismaticImpulseJoint:()=>n.PrismaticImpulseJoint,PrismaticMultibodyJoint:()=>n.PrismaticMultibodyJoint,Quaternion:()=>n.Quaternion,QueryFilterFlags:()=>n.QueryFilterFlags,QueryPipeline:()=>n.QueryPipeline,Ray:()=>n.Ray,RayColliderHit:()=>n.RayColliderHit,RayColliderIntersection:()=>n.RayColliderIntersection,RayIntersection:()=>n.RayIntersection,RevoluteImpulseJoint:()=>n.RevoluteImpulseJoint,RevoluteMultibodyJoint:()=>n.RevoluteMultibodyJoint,RigidBody:()=>n.RigidBody,RigidBodyDesc:()=>n.RigidBodyDesc,RigidBodySet:()=>n.RigidBodySet,RigidBodyType:()=>n.RigidBodyType,RopeImpulseJoint:()=>n.RopeImpulseJoint,RotationOps:()=>n.RotationOps,RoundCone:()=>n.RoundCone,RoundConvexPolyhedron:()=>n.RoundConvexPolyhedron,RoundCuboid:()=>n.RoundCuboid,RoundCylinder:()=>n.RoundCylinder,RoundTriangle:()=>n.RoundTriangle,SdpMatrix3:()=>n.SdpMatrix3,SdpMatrix3Ops:()=>n.SdpMatrix3Ops,Segment:()=>n.Segment,SerializationPipeline:()=>n.SerializationPipeline,Shape:()=>n.Shape,ShapeCastHit:()=>n.ShapeCastHit,ShapeContact:()=>n.ShapeContact,ShapeType:()=>n.ShapeType,SolverFlags:()=>n.SolverFlags,SphericalImpulseJoint:()=>n.SphericalImpulseJoint,SphericalMultibodyJoint:()=>n.SphericalMultibodyJoint,SpringImpulseJoint:()=>n.SpringImpulseJoint,TempContactForceEvent:()=>n.TempContactForceEvent,TempContactManifold:()=>n.TempContactManifold,TriMesh:()=>n.TriMesh,TriMeshFlags:()=>n.TriMeshFlags,Triangle:()=>n.Triangle,UnitImpulseJoint:()=>n.UnitImpulseJoint,UnitMultibodyJoint:()=>n.UnitMultibodyJoint,Vector3:()=>n.Vector3,VectorOps:()=>n.VectorOps,World:()=>n.World,default:()=>a,version:()=>n.version});var n=r(1862),o=t([n]);const a=n=(o.then?(await o)():o)[0];i()}catch(t){i(t)}}))},2952:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{EN:()=>g,Jo:()=>f,_j:()=>n,an:()=>o});var n,o,a=r(7707),s=r(360),c=r(5396),l=r(6370),h=r(3551),u=r(6410),_=r(6892),d=r(3218),p=r(2130),w=t([a,h,_,d,p,u,c]);[a,h,_,d,p,u,c]=w.then?(await w)():w,function(t){t[t.DYNAMIC_DYNAMIC=1]="DYNAMIC_DYNAMIC",t[t.DYNAMIC_KINEMATIC=12]="DYNAMIC_KINEMATIC",t[t.DYNAMIC_FIXED=2]="DYNAMIC_FIXED",t[t.KINEMATIC_KINEMATIC=52224]="KINEMATIC_KINEMATIC",t[t.KINEMATIC_FIXED=8704]="KINEMATIC_FIXED",t[t.FIXED_FIXED=32]="FIXED_FIXED",t[t.DEFAULT=15]="DEFAULT",t[t.ALL=60943]="ALL"}(n||(n={}));class f{constructor(t,e,r,i){this.colliderSet=t,this.handle=e,this._parent=r,this._shape=i}finalizeDeserialization(t){null!=this.handle&&(this._parent=t.get(this.colliderSet.raw.coParent(this.handle)))}ensureShapeIsCached(){this._shape||(this._shape=h.yp.fromRaw(this.colliderSet.raw,this.handle))}get shape(){return this.ensureShapeIsCached(),this._shape}isValid(){return this.colliderSet.raw.contains(this.handle)}translation(){return a.if.fromRaw(this.colliderSet.raw.coTranslation(this.handle))}rotation(){return a.PB.fromRaw(this.colliderSet.raw.coRotation(this.handle))}isSensor(){return this.colliderSet.raw.coIsSensor(this.handle)}setSensor(t){this.colliderSet.raw.coSetSensor(this.handle,t)}setShape(t){let e=t.intoRaw();this.colliderSet.raw.coSetShape(this.handle,e),e.free(),this._shape=t}setEnabled(t){this.colliderSet.raw.coSetEnabled(this.handle,t)}isEnabled(){return this.colliderSet.raw.coIsEnabled(this.handle)}setRestitution(t){this.colliderSet.raw.coSetRestitution(this.handle,t)}setFriction(t){this.colliderSet.raw.coSetFriction(this.handle,t)}frictionCombineRule(){return this.colliderSet.raw.coFrictionCombineRule(this.handle)}setFrictionCombineRule(t){this.colliderSet.raw.coSetFrictionCombineRule(this.handle,t)}restitutionCombineRule(){return this.colliderSet.raw.coRestitutionCombineRule(this.handle)}setRestitutionCombineRule(t){this.colliderSet.raw.coSetRestitutionCombineRule(this.handle,t)}setCollisionGroups(t){this.colliderSet.raw.coSetCollisionGroups(this.handle,t)}setSolverGroups(t){this.colliderSet.raw.coSetSolverGroups(this.handle,t)}contactSkin(){return this.colliderSet.raw.coContactSkin(this.handle)}setContactSkin(t){return this.colliderSet.raw.coSetContactSkin(this.handle,t)}activeHooks(){return this.colliderSet.raw.coActiveHooks(this.handle)}setActiveHooks(t){this.colliderSet.raw.coSetActiveHooks(this.handle,t)}activeEvents(){return this.colliderSet.raw.coActiveEvents(this.handle)}setActiveEvents(t){this.colliderSet.raw.coSetActiveEvents(this.handle,t)}activeCollisionTypes(){return this.colliderSet.raw.coActiveCollisionTypes(this.handle)}setContactForceEventThreshold(t){return this.colliderSet.raw.coSetContactForceEventThreshold(this.handle,t)}contactForceEventThreshold(){return this.colliderSet.raw.coContactForceEventThreshold(this.handle)}setActiveCollisionTypes(t){this.colliderSet.raw.coSetActiveCollisionTypes(this.handle,t)}setDensity(t){this.colliderSet.raw.coSetDensity(this.handle,t)}setMass(t){this.colliderSet.raw.coSetMass(this.handle,t)}setMassProperties(t,e,r,i){let n=a.if.intoRaw(e),o=a.if.intoRaw(r),s=a.PB.intoRaw(i);this.colliderSet.raw.coSetMassProperties(this.handle,t,n,o,s),n.free(),o.free(),s.free()}setTranslation(t){this.colliderSet.raw.coSetTranslation(this.handle,t.x,t.y,t.z)}setTranslationWrtParent(t){this.colliderSet.raw.coSetTranslationWrtParent(this.handle,t.x,t.y,t.z)}setRotation(t){this.colliderSet.raw.coSetRotation(this.handle,t.x,t.y,t.z,t.w)}setRotationWrtParent(t){this.colliderSet.raw.coSetRotationWrtParent(this.handle,t.x,t.y,t.z,t.w)}shapeType(){return this.colliderSet.raw.coShapeType(this.handle)}halfExtents(){return a.if.fromRaw(this.colliderSet.raw.coHalfExtents(this.handle))}setHalfExtents(t){const e=a.if.intoRaw(t);this.colliderSet.raw.coSetHalfExtents(this.handle,e)}radius(){return this.colliderSet.raw.coRadius(this.handle)}setRadius(t){this.colliderSet.raw.coSetRadius(this.handle,t)}roundRadius(){return this.colliderSet.raw.coRoundRadius(this.handle)}setRoundRadius(t){this.colliderSet.raw.coSetRoundRadius(this.handle,t)}halfHeight(){return this.colliderSet.raw.coHalfHeight(this.handle)}setHalfHeight(t){this.colliderSet.raw.coSetHalfHeight(this.handle,t)}vertices(){return this.colliderSet.raw.coVertices(this.handle)}indices(){return this.colliderSet.raw.coIndices(this.handle)}heightfieldHeights(){return this.colliderSet.raw.coHeightfieldHeights(this.handle)}heightfieldScale(){let t=this.colliderSet.raw.coHeightfieldScale(this.handle);return a.if.fromRaw(t)}heightfieldNRows(){return this.colliderSet.raw.coHeightfieldNRows(this.handle)}heightfieldNCols(){return this.colliderSet.raw.coHeightfieldNCols(this.handle)}parent(){return this._parent}friction(){return this.colliderSet.raw.coFriction(this.handle)}restitution(){return this.colliderSet.raw.coRestitution(this.handle)}density(){return this.colliderSet.raw.coDensity(this.handle)}mass(){return this.colliderSet.raw.coMass(this.handle)}volume(){return this.colliderSet.raw.coVolume(this.handle)}collisionGroups(){return this.colliderSet.raw.coCollisionGroups(this.handle)}solverGroups(){return this.colliderSet.raw.coSolverGroups(this.handle)}containsPoint(t){let e=a.if.intoRaw(t),r=this.colliderSet.raw.coContainsPoint(this.handle,e);return e.free(),r}projectPoint(t,e){let r=a.if.intoRaw(t),i=_.g.fromRaw(this.colliderSet.raw.coProjectPoint(this.handle,r,e));return r.free(),i}intersectsRay(t,e){let r=a.if.intoRaw(t.origin),i=a.if.intoRaw(t.dir),n=this.colliderSet.raw.coIntersectsRay(this.handle,r,i,e);return r.free(),i.free(),n}castShape(t,e,r,i,n,o,s,c){let l=a.if.intoRaw(t),h=a.if.intoRaw(r),u=a.PB.intoRaw(i),_=a.if.intoRaw(n),p=e.intoRaw(),w=d.G.fromRaw(this.colliderSet,this.colliderSet.raw.coCastShape(this.handle,l,p,h,u,_,o,s,c));return l.free(),h.free(),u.free(),_.free(),p.free(),w}castCollider(t,e,r,i,n,o){let s=a.if.intoRaw(t),c=a.if.intoRaw(r),l=d.k.fromRaw(this.colliderSet,this.colliderSet.raw.coCastCollider(this.handle,s,e.handle,c,i,n,o));return s.free(),c.free(),l}intersectsShape(t,e,r){let i=a.if.intoRaw(e),n=a.PB.intoRaw(r),o=t.intoRaw(),s=this.colliderSet.raw.coIntersectsShape(this.handle,o,i,n);return i.free(),n.free(),o.free(),s}contactShape(t,e,r,i){let n=a.if.intoRaw(e),o=a.PB.intoRaw(r),s=t.intoRaw(),c=p._.fromRaw(this.colliderSet.raw.coContactShape(this.handle,s,n,o,i));return n.free(),o.free(),s.free(),c}contactCollider(t,e){return p._.fromRaw(this.colliderSet.raw.coContactCollider(this.handle,t.handle,e))}castRay(t,e,r){let i=a.if.intoRaw(t.origin),n=a.if.intoRaw(t.dir),o=this.colliderSet.raw.coCastRay(this.handle,i,n,e,r);return i.free(),n.free(),o}castRayAndGetNormal(t,e,r){let i=a.if.intoRaw(t.origin),n=a.if.intoRaw(t.dir),o=u.cU.fromRaw(this.colliderSet.raw.coCastRayAndGetNormal(this.handle,i,n,e,r));return i.free(),n.free(),o}}!function(t){t[t.Density=0]="Density",t[t.Mass=1]="Mass",t[t.MassProps=2]="MassProps"}(o||(o={}));class g{constructor(t){this.enabled=!0,this.shape=t,this.massPropsMode=o.Density,this.density=1,this.friction=.5,this.restitution=0,this.rotation=a.PB.identity(),this.translation=a.if.zeros(),this.isSensor=!1,this.collisionGroups=4294967295,this.solverGroups=4294967295,this.frictionCombineRule=s.f.Average,this.restitutionCombineRule=s.f.Average,this.activeCollisionTypes=n.DEFAULT,this.activeEvents=c.OX.NONE,this.activeHooks=l.X.NONE,this.mass=0,this.centerOfMass=a.if.zeros(),this.contactForceEventThreshold=0,this.contactSkin=0,this.principalAngularInertia=a.if.zeros(),this.angularInertiaLocalFrame=a.PB.identity()}static ball(t){const e=new h.cx(t);return new g(e)}static capsule(t,e){const r=new h.wn(t,e);return new g(r)}static segment(t,e){const r=new h.Y4(t,e);return new g(r)}static triangle(t,e,r){const i=new h.lM(t,e,r);return new g(i)}static roundTriangle(t,e,r,i){const n=new h.tt(t,e,r,i);return new g(n)}static polyline(t,e){const r=new h.Ro(t,e);return new g(r)}static trimesh(t,e,r){const i=new h.z6(t,e,r);return new g(i)}static cuboid(t,e,r){const i=new h.JP(t,e,r);return new g(i)}static roundCuboid(t,e,r,i){const n=new h.d2(t,e,r,i);return new g(n)}static heightfield(t,e,r,i,n){const o=new h.cW(t,e,r,i,n);return new g(o)}static cylinder(t,e){const r=new h.T(t,e);return new g(r)}static roundCylinder(t,e,r){const i=new h.ti(t,e,r);return new g(i)}static cone(t,e){const r=new h.Sd(t,e);return new g(r)}static roundCone(t,e,r){const i=new h.WE(t,e,r);return new g(i)}static convexHull(t){const e=new h.qe(t,null);return new g(e)}static convexMesh(t,e){const r=new h.qe(t,e);return new g(r)}static roundConvexHull(t,e){const r=new h._D(t,null,e);return new g(r)}static roundConvexMesh(t,e,r){const i=new h._D(t,e,r);return new g(i)}setTranslation(t,e,r){if("number"!=typeof t||"number"!=typeof e||"number"!=typeof r)throw TypeError("The translation components must be numbers.");return this.translation={x:t,y:e,z:r},this}setRotation(t){return a.PB.copy(this.rotation,t),this}setSensor(t){return this.isSensor=t,this}setEnabled(t){return this.enabled=t,this}setContactSkin(t){return this.contactSkin=t,this}setDensity(t){return this.massPropsMode=o.Density,this.density=t,this}setMass(t){return this.massPropsMode=o.Mass,this.mass=t,this}setMassProperties(t,e,r,i){return this.massPropsMode=o.MassProps,this.mass=t,a.if.copy(this.centerOfMass,e),a.if.copy(this.principalAngularInertia,r),a.PB.copy(this.angularInertiaLocalFrame,i),this}setRestitution(t){return this.restitution=t,this}setFriction(t){return this.friction=t,this}setFrictionCombineRule(t){return this.frictionCombineRule=t,this}setRestitutionCombineRule(t){return this.restitutionCombineRule=t,this}setCollisionGroups(t){return this.collisionGroups=t,this}setSolverGroups(t){return this.solverGroups=t,this}setActiveHooks(t){return this.activeHooks=t,this}setActiveEvents(t){return this.activeEvents=t,this}setActiveCollisionTypes(t){return this.activeCollisionTypes=t,this}setContactForceEventThreshold(t){return this.contactForceEventThreshold=t,this}}i()}catch(t){i(t)}}))},3211:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{e:()=>c});var n=r(5063),o=r(8836),a=r(8424),s=t([n,a]);[n,a]=s.then?(await s)():s;class c{free(){this.raw&&this.raw.free(),this.raw=void 0,this.map&&this.map.clear(),this.map=void 0}constructor(t){this.raw=t||new n.wT,this.map=new o.y,t&&t.forEachJointHandle((e=>{this.map.set(e,a.Qz.newTyped(t,null,e))}))}finalizeDeserialization(t){this.map.forEach((e=>e.finalizeDeserialization(t)))}createJoint(t,e,r,i,n){const o=e.intoRaw(),s=this.raw.createJoint(o,r,i,n);o.free();let c=a.Qz.newTyped(this.raw,t,s);return this.map.set(s,c),c}remove(t,e){this.raw.remove(t,e),this.unmap(t)}forEachJointHandleAttachedToRigidBody(t,e){this.raw.forEachJointAttachedToRigidBody(t,e)}unmap(t){this.map.delete(t)}len(){return this.map.len()}contains(t){return null!=this.get(t)}get(t){return this.map.get(t)}forEach(t){this.map.forEach(t)}getAll(){return this.map.getAll()}}i()}catch(t){i(t)}}))},3218:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{G:()=>a,k:()=>s});var n=r(7707),o=t([n]);n=(o.then?(await o)():o)[0];class a{constructor(t,e,r,i,n){this.time_of_impact=t,this.witness1=e,this.witness2=r,this.normal1=i,this.normal2=n}static fromRaw(t,e){if(!e)return null;const r=new a(e.time_of_impact(),n.if.fromRaw(e.witness1()),n.if.fromRaw(e.witness2()),n.if.fromRaw(e.normal1()),n.if.fromRaw(e.normal2()));return e.free(),r}}class s extends a{constructor(t,e,r,i,n,o){super(e,r,i,n,o),this.collider=t}static fromRaw(t,e){if(!e)return null;const r=new s(t.get(e.colliderHandle()),e.time_of_impact(),n.if.fromRaw(e.witness1()),n.if.fromRaw(e.witness2()),n.if.fromRaw(e.normal1()),n.if.fromRaw(e.normal2()));return e.free(),r}}i()}catch(t){i(t)}}))},3294:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{P:()=>c});var n=r(1039),o=r(2150),a=r(147),s=t([a]);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function h(){h=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function _(t,e,r,i){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),s=new A(i||[]);return n(a,"_invoke",{value:k(t,r,s)}),a}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=_;var p="suspendedStart",w="suspendedYield",f="executing",g="completed",y={};function m(){}function b(){}function v(){}var S={};u(S,a,(function(){return this}));var R=Object.getPrototypeOf,E=R&&R(R(j([])));E&&E!==r&&i.call(E,a)&&(S=E);var x=v.prototype=m.prototype=Object.create(S);function C(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,o,a,s){var c=d(t[n],t,o);if("throw"!==c.type){var h=c.arg,u=h.value;return u&&"object"==l(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(u).then((function(t){h.value=t,a(h)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return o=o?o.then(n,n):n()}})}function k(e,r,i){var n=p;return function(o,a){if(n===f)throw Error("Generator is already running");if(n===g){if("throw"===o)throw a;return{value:t,done:!0}}for(i.method=o,i.arg=a;;){var s=i.delegate;if(s){var c=M(s,i);if(c){if(c===y)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===p)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=f;var l=d(e,r,i);if("normal"===l.type){if(n=i.done?g:w,l.arg===y)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=g,i.method="throw",i.arg=l.arg)}}}function M(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,M(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=d(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function j(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(l(e)+" is not iterable")}return b.prototype=v,n(x,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:b,configurable:!0}),b.displayName=u(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},C(P.prototype),u(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var a=new P(_(t,r,i,n),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},C(x),u(x,c,"Generator"),u(x,a,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=j,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return s.type="throw",s.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:j(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function u(t,e,r,i,n,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(i,n)}function _(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(t){u(o,i,n,a,s,"next",t)}function s(t){u(o,i,n,a,s,"throw",t)}a(void 0)}))}}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,w(i.key),i)}}function w(t){var e=f(t,"string");return"symbol"==l(e)?e:e+""}function f(t,e){if("object"!=l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}a=(s.then?(await s)():s)[0];var c=function(){return t=function t(e){d(this,t),this.game=e,this.player=null,this.entities=[],this.visionSystem=null},e=[{key:"initialize",value:(i=_(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.createTestWalls(),this.player=new n.a({position:{x:0,y:0,z:0},renderer:this.game.renderer,input:this.game.input,game:this.game}),(0,a.R)("Игрок создан"),t.next=6,this.initVisionSystem();case 6:return t.abrupt("return",!0);case 9:return t.prev=9,t.t0=t.catch(0),(0,a.R)("Ошибка инициализации игрового мира: ".concat(t.t0.message)),t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return i.apply(this,arguments)})},{key:"update",value:function(t){this.player&&this.player.update(t),this.entities.forEach((function(e){e.update&&e.update(t)}))}},{key:"fixedUpdate",value:function(t){this.entities.forEach((function(e){e.fixedUpdate&&e.fixedUpdate(t)}))}},{key:"initVisionSystem",value:(r=_(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.game.renderer&&this.game.renderer.scene&&this.player){t.next=3;break}throw new Error("Не все компоненты доступны для инициализации системы видимости");case 3:return(0,a.R)("Инициализация системы видимости..."),e=new o.Q({scene:this.game.renderer.scene,world:this.game.physics.getWorld(),player:this.player,fov:90,rayCount:60,maxDistance:50,memoryEnabled:!0,blurEdges:!0}),t.next=7,e.init();case 7:return e.isReady()||(0,a.R)("Система видимости не готова, но будет инициализирована позже автоматически"),this.game.renderer.visionSystem=e,this.visionSystem=e,(0,a.R)("Система видимости инициализирована"),t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t.catch(0),(0,a.R)("Ошибка инициализации системы видимости: ".concat(t.t0.message)),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(){return r.apply(this,arguments)})},{key:"createTestWalls",value:function(){var t=this;try{if(!(this.game.physics&&this.game.physics.isReady()&&this.game.renderer&&this.game.renderer.scene))return void(0,a.R)("Физика или рендерер не готовы для создания стен");(0,a.R)("Создание тестовых стен...");var e=new THREE.MeshStandardMaterial({color:8421504,roughness:.7,metalness:.2}),r=function(r,i,n,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,s=new THREE.BoxGeometry(n,a,o),c=new THREE.Mesh(s,e);return c.position.set(r,a/2,i),t.game.renderer.scene.add(c),t.game.physics.createObstacle({position:{x:r,y:a/2,z:i},size:{x:n,y:a,z:o},object:c}),c};r(0,-20,40,1),r(-20,0,1,40),r(20,0,1,40),r(0,20,40,1),r(-10,-10,1,20),r(10,10,20,1),r(10,-5,1,10),r(-5,5,10,1),r(-15,-15,3,3),r(15,-15,3,3),r(15,15,3,3),r(-15,15,3,3),(0,a.R)("Тестовые стены созданы")}catch(t){(0,a.R)("Ошибка создания тестовых стен: ".concat(t.message))}}},{key:"addEntity",value:function(t){this.entities.push(t)}},{key:"removeEntity",value:function(t){var e=this.entities.indexOf(t);-1!==e&&this.entities.splice(e,1)}},{key:"clear",value:function(){this.entities=[],this.player=null,this.visionSystem&&(this.visionSystem.dispose(),this.visionSystem=null),this.game.renderer&&this.game.renderer.visionSystem&&(this.game.renderer.visionSystem=null)}}],e&&p(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,i}();i()}catch(g){i(g)}}))},3432:(t,e,r)=>{function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function o(t,e,r){return(e=s(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s(i.key),i)}}function s(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}r.d(e,{l:()=>c});var c=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.keys={},this.mouse={position:{x:0,y:0},isDown:!1,rightIsDown:!1},this.lastMousePosition={x:0,y:0},this.keyCallbacks={},this.clickCallback=null,this.rightClickCallback=null,this.mouseMoveCallback=null,this.mouseDownCallback=null,this.mouseUpCallback=null,this.gameControlsEnabled=!0,this.mouseSensitivity=1,this.handleKeyDown=this.handleKeyDown.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleContextMenu=this.handleContextMenu.bind(this),this.init()},e=[{key:"init",value:function(){window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mousedown",this.handleMouseDown),window.addEventListener("mouseup",this.handleMouseUp),window.addEventListener("contextmenu",this.handleContextMenu),document.body.style.userSelect="none"}},{key:"handleKeyDown",value:function(t){this.keys[t.code]=!0,this.keyCallbacks[t.code]&&this.gameControlsEnabled&&this.keyCallbacks[t.code]()}},{key:"handleKeyUp",value:function(t){this.keys[t.code]=!1}},{key:"handleMouseMove",value:function(t){this.mouse.position.x=t.clientX,this.mouse.position.y=t.clientY;var e=(this.mouse.position.x-this.lastMousePosition.x)*this.mouseSensitivity,r=(this.mouse.position.y-this.lastMousePosition.y)*this.mouseSensitivity;this.lastMousePosition.x=this.mouse.position.x,this.lastMousePosition.y=this.mouse.position.y,this.mouseMoveCallback&&this.gameControlsEnabled&&this.mouseMoveCallback(this.mouse.position,{x:e,y:r})}},{key:"handleMouseDown",value:function(t){0===t.button?(this.mouse.isDown=!0,this.mouseDownCallback&&this.gameControlsEnabled&&this.mouseDownCallback(0,this.mouse.position),this.clickCallback&&this.gameControlsEnabled&&this.clickCallback(this.mouse.position)):2===t.button&&(this.mouse.rightIsDown=!0,this.mouseDownCallback&&this.gameControlsEnabled&&this.mouseDownCallback(2,this.mouse.position),this.rightClickCallback&&this.gameControlsEnabled&&this.rightClickCallback(this.mouse.position))}},{key:"handleMouseUp",value:function(t){0===t.button?(this.mouse.isDown=!1,this.mouseUpCallback&&this.gameControlsEnabled&&this.mouseUpCallback(0)):2===t.button&&(this.mouse.rightIsDown=!1,this.mouseUpCallback&&this.gameControlsEnabled&&this.mouseUpCallback(2))}},{key:"handleContextMenu",value:function(t){t.preventDefault()}},{key:"isKeyPressed",value:function(t){return this.gameControlsEnabled&&!0===this.keys[t]}},{key:"isMouseDown",value:function(){return this.gameControlsEnabled&&this.mouse.isDown}},{key:"isRightMouseDown",value:function(){return this.gameControlsEnabled&&this.mouse.rightIsDown}},{key:"getMousePosition",value:function(){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},this.mouse.position)}},{key:"setMouseSensitivity",value:function(t){this.mouseSensitivity=t}},{key:"addKeyCallback",value:function(t,e){this.keyCallbacks[t]=e}},{key:"removeKeyCallback",value:function(t){delete this.keyCallbacks[t]}},{key:"setClickCallback",value:function(t){this.clickCallback=t}},{key:"setRightClickCallback",value:function(t){this.rightClickCallback=t}},{key:"setMouseMoveCallback",value:function(t){this.mouseMoveCallback=t}},{key:"setMouseDownCallback",value:function(t){this.mouseDownCallback=t}},{key:"setMouseUpCallback",value:function(t){this.mouseUpCallback=t}},{key:"disableGameControls",value:function(){this.gameControlsEnabled=!1}},{key:"enableGameControls",value:function(){this.gameControlsEnabled=!0}},{key:"getMovementDirection",value:function(){if(!this.gameControlsEnabled)return{x:0,z:0};var t=0,e=0;return this.isKeyPressed("KeyW")||this.isKeyPressed("ArrowUp")?e=-1:(this.isKeyPressed("KeyS")||this.isKeyPressed("ArrowDown"))&&(e=1),this.isKeyPressed("KeyA")||this.isKeyPressed("ArrowLeft")?t=-1:(this.isKeyPressed("KeyD")||this.isKeyPressed("ArrowRight"))&&(t=1),{x:t,z:e}}},{key:"clearCallbacks",value:function(){this.keyCallbacks={},this.clickCallback=null,this.rightClickCallback=null,this.mouseMoveCallback=null,this.mouseDownCallback=null,this.mouseUpCallback=null}},{key:"destroy",value:function(){window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("mouseup",this.handleMouseUp),window.removeEventListener("contextmenu",this.handleContextMenu),document.body.style.userSelect=""}}],e&&a(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}()},3551:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{G9:()=>f,I8:()=>a,IO:()=>n,JP:()=>g,Ro:()=>R,Sd:()=>I,T:()=>k,WE:()=>T,Y4:()=>b,_D:()=>C,cW:()=>P,cx:()=>w,d2:()=>y,fn:()=>o,lM:()=>v,qe:()=>x,ti:()=>M,tt:()=>S,wn:()=>m,yp:()=>p,z6:()=>E});var n,o,a,s=r(7707),c=r(5063),l=r(2130),h=r(6892),u=r(6410),_=r(3218),d=t([s,c,_,l,h,u]);[s,c,_,l,h,u]=d.then?(await d)():d;class p{static fromRaw(t,e){const r=t.coShapeType(e);let i,n,o,a,l,h,u;switch(r){case c.m3.Ball:return new w(t.coRadius(e));case c.m3.Cuboid:return i=t.coHalfExtents(e),new g(i.x,i.y,i.z);case c.m3.RoundCuboid:return i=t.coHalfExtents(e),n=t.coRoundRadius(e),new y(i.x,i.y,i.z,n);case c.m3.Capsule:return l=t.coHalfHeight(e),h=t.coRadius(e),new m(l,h);case c.m3.Segment:return o=t.coVertices(e),new b(s.if.new(o[0],o[1],o[2]),s.if.new(o[3],o[4],o[5]));case c.m3.Polyline:return o=t.coVertices(e),a=t.coIndices(e),new R(o,a);case c.m3.Triangle:return o=t.coVertices(e),new v(s.if.new(o[0],o[1],o[2]),s.if.new(o[3],o[4],o[5]),s.if.new(o[6],o[7],o[8]));case c.m3.RoundTriangle:return o=t.coVertices(e),n=t.coRoundRadius(e),new S(s.if.new(o[0],o[1],o[2]),s.if.new(o[3],o[4],o[5]),s.if.new(o[6],o[7],o[8]),n);case c.m3.HalfSpace:return u=s.if.fromRaw(t.coHalfspaceNormal(e)),new f(u);case c.m3.TriMesh:o=t.coVertices(e),a=t.coIndices(e);const _=t.coTriMeshFlags(e);return new E(o,a,_);case c.m3.HeightField:const d=t.coHeightfieldScale(e),p=t.coHeightfieldHeights(e),A=t.coHeightfieldNRows(e),j=t.coHeightfieldNCols(e),L=t.coHeightFieldFlags(e);return new P(A,j,p,d,L);case c.m3.ConvexPolyhedron:return o=t.coVertices(e),a=t.coIndices(e),new x(o,a);case c.m3.RoundConvexPolyhedron:return o=t.coVertices(e),a=t.coIndices(e),n=t.coRoundRadius(e),new C(o,a,n);case c.m3.Cylinder:return l=t.coHalfHeight(e),h=t.coRadius(e),new k(l,h);case c.m3.RoundCylinder:return l=t.coHalfHeight(e),h=t.coRadius(e),n=t.coRoundRadius(e),new M(l,h,n);case c.m3.Cone:return l=t.coHalfHeight(e),h=t.coRadius(e),new I(l,h);case c.m3.RoundCone:return l=t.coHalfHeight(e),h=t.coRadius(e),n=t.coRoundRadius(e),new T(l,h,n);default:throw new Error("unknown shape type: "+r)}}castShape(t,e,r,i,n,o,a,c,l,h){let u=s.if.intoRaw(t),d=s.PB.intoRaw(e),p=s.if.intoRaw(r),w=s.if.intoRaw(n),f=s.PB.intoRaw(o),g=s.if.intoRaw(a),y=this.intoRaw(),m=i.intoRaw(),b=_.G.fromRaw(null,y.castShape(u,d,p,m,w,f,g,c,l,h));return u.free(),d.free(),p.free(),w.free(),f.free(),g.free(),y.free(),m.free(),b}intersectsShape(t,e,r,i,n){let o=s.if.intoRaw(t),a=s.PB.intoRaw(e),c=s.if.intoRaw(i),l=s.PB.intoRaw(n),h=this.intoRaw(),u=r.intoRaw(),_=h.intersectsShape(o,a,u,c,l);return o.free(),a.free(),c.free(),l.free(),h.free(),u.free(),_}contactShape(t,e,r,i,n,o){let a=s.if.intoRaw(t),c=s.PB.intoRaw(e),h=s.if.intoRaw(i),u=s.PB.intoRaw(n),_=this.intoRaw(),d=r.intoRaw(),p=l._.fromRaw(_.contactShape(a,c,d,h,u,o));return a.free(),c.free(),h.free(),u.free(),_.free(),d.free(),p}containsPoint(t,e,r){let i=s.if.intoRaw(t),n=s.PB.intoRaw(e),o=s.if.intoRaw(r),a=this.intoRaw(),c=a.containsPoint(i,n,o);return i.free(),n.free(),o.free(),a.free(),c}projectPoint(t,e,r,i){let n=s.if.intoRaw(t),o=s.PB.intoRaw(e),a=s.if.intoRaw(r),c=this.intoRaw(),l=h.g.fromRaw(c.projectPoint(n,o,a,i));return n.free(),o.free(),a.free(),c.free(),l}intersectsRay(t,e,r,i){let n=s.if.intoRaw(e),o=s.PB.intoRaw(r),a=s.if.intoRaw(t.origin),c=s.if.intoRaw(t.dir),l=this.intoRaw(),h=l.intersectsRay(n,o,a,c,i);return n.free(),o.free(),a.free(),c.free(),l.free(),h}castRay(t,e,r,i,n){let o=s.if.intoRaw(e),a=s.PB.intoRaw(r),c=s.if.intoRaw(t.origin),l=s.if.intoRaw(t.dir),h=this.intoRaw(),u=h.castRay(o,a,c,l,i,n);return o.free(),a.free(),c.free(),l.free(),h.free(),u}castRayAndGetNormal(t,e,r,i,n){let o=s.if.intoRaw(e),a=s.PB.intoRaw(r),c=s.if.intoRaw(t.origin),l=s.if.intoRaw(t.dir),h=this.intoRaw(),_=u.cU.fromRaw(h.castRayAndGetNormal(o,a,c,l,i,n));return o.free(),a.free(),c.free(),l.free(),h.free(),_}}!function(t){t[t.Ball=0]="Ball",t[t.Cuboid=1]="Cuboid",t[t.Capsule=2]="Capsule",t[t.Segment=3]="Segment",t[t.Polyline=4]="Polyline",t[t.Triangle=5]="Triangle",t[t.TriMesh=6]="TriMesh",t[t.HeightField=7]="HeightField",t[t.ConvexPolyhedron=9]="ConvexPolyhedron",t[t.Cylinder=10]="Cylinder",t[t.Cone=11]="Cone",t[t.RoundCuboid=12]="RoundCuboid",t[t.RoundTriangle=13]="RoundTriangle",t[t.RoundCylinder=14]="RoundCylinder",t[t.RoundCone=15]="RoundCone",t[t.RoundConvexPolyhedron=16]="RoundConvexPolyhedron",t[t.HalfSpace=17]="HalfSpace"}(n||(n={})),function(t){t[t.FIX_INTERNAL_EDGES=1]="FIX_INTERNAL_EDGES"}(o||(o={})),function(t){t[t.DELETE_BAD_TOPOLOGY_TRIANGLES=4]="DELETE_BAD_TOPOLOGY_TRIANGLES",t[t.ORIENTED=8]="ORIENTED",t[t.MERGE_DUPLICATE_VERTICES=16]="MERGE_DUPLICATE_VERTICES",t[t.DELETE_DEGENERATE_TRIANGLES=32]="DELETE_DEGENERATE_TRIANGLES",t[t.DELETE_DUPLICATE_TRIANGLES=64]="DELETE_DUPLICATE_TRIANGLES",t[t.FIX_INTERNAL_EDGES=152]="FIX_INTERNAL_EDGES"}(a||(a={}));class w extends p{constructor(t){super(),this.type=n.Ball,this.radius=t}intoRaw(){return c.co.ball(this.radius)}}class f extends p{constructor(t){super(),this.type=n.HalfSpace,this.normal=t}intoRaw(){let t=s.if.intoRaw(this.normal),e=c.co.halfspace(t);return t.free(),e}}class g extends p{constructor(t,e,r){super(),this.type=n.Cuboid,this.halfExtents=s.if.new(t,e,r)}intoRaw(){return c.co.cuboid(this.halfExtents.x,this.halfExtents.y,this.halfExtents.z)}}class y extends p{constructor(t,e,r,i){super(),this.type=n.RoundCuboid,this.halfExtents=s.if.new(t,e,r),this.borderRadius=i}intoRaw(){return c.co.roundCuboid(this.halfExtents.x,this.halfExtents.y,this.halfExtents.z,this.borderRadius)}}class m extends p{constructor(t,e){super(),this.type=n.Capsule,this.halfHeight=t,this.radius=e}intoRaw(){return c.co.capsule(this.halfHeight,this.radius)}}class b extends p{constructor(t,e){super(),this.type=n.Segment,this.a=t,this.b=e}intoRaw(){let t=s.if.intoRaw(this.a),e=s.if.intoRaw(this.b),r=c.co.segment(t,e);return t.free(),e.free(),r}}class v extends p{constructor(t,e,r){super(),this.type=n.Triangle,this.a=t,this.b=e,this.c=r}intoRaw(){let t=s.if.intoRaw(this.a),e=s.if.intoRaw(this.b),r=s.if.intoRaw(this.c),i=c.co.triangle(t,e,r);return t.free(),e.free(),r.free(),i}}class S extends p{constructor(t,e,r,i){super(),this.type=n.RoundTriangle,this.a=t,this.b=e,this.c=r,this.borderRadius=i}intoRaw(){let t=s.if.intoRaw(this.a),e=s.if.intoRaw(this.b),r=s.if.intoRaw(this.c),i=c.co.roundTriangle(t,e,r,this.borderRadius);return t.free(),e.free(),r.free(),i}}class R extends p{constructor(t,e){super(),this.type=n.Polyline,this.vertices=t,this.indices=null!=e?e:new Uint32Array(0)}intoRaw(){return c.co.polyline(this.vertices,this.indices)}}class E extends p{constructor(t,e,r){super(),this.type=n.TriMesh,this.vertices=t,this.indices=e,this.flags=r}intoRaw(){return c.co.trimesh(this.vertices,this.indices,this.flags)}}class x extends p{constructor(t,e){super(),this.type=n.ConvexPolyhedron,this.vertices=t,this.indices=e}intoRaw(){return this.indices?c.co.convexMesh(this.vertices,this.indices):c.co.convexHull(this.vertices)}}class C extends p{constructor(t,e,r){super(),this.type=n.RoundConvexPolyhedron,this.vertices=t,this.indices=e,this.borderRadius=r}intoRaw(){return this.indices?c.co.roundConvexMesh(this.vertices,this.indices,this.borderRadius):c.co.roundConvexHull(this.vertices,this.borderRadius)}}class P extends p{constructor(t,e,r,i,o){super(),this.type=n.HeightField,this.nrows=t,this.ncols=e,this.heights=r,this.scale=i,this.flags=o}intoRaw(){let t=s.if.intoRaw(this.scale),e=c.co.heightfield(this.nrows,this.ncols,this.heights,t,this.flags);return t.free(),e}}class k extends p{constructor(t,e){super(),this.type=n.Cylinder,this.halfHeight=t,this.radius=e}intoRaw(){return c.co.cylinder(this.halfHeight,this.radius)}}class M extends p{constructor(t,e,r){super(),this.type=n.RoundCylinder,this.borderRadius=r,this.halfHeight=t,this.radius=e}intoRaw(){return c.co.roundCylinder(this.halfHeight,this.radius,this.borderRadius)}}class I extends p{constructor(t,e){super(),this.type=n.Cone,this.halfHeight=t,this.radius=e}intoRaw(){return c.co.cone(this.halfHeight,this.radius)}}class T extends p{constructor(t,e,r){super(),this.type=n.RoundCone,this.halfHeight=t,this.radius=e,this.borderRadius=r}intoRaw(){return c.co.roundCone(this.halfHeight,this.radius,this.borderRadius)}}i()}catch(t){i(t)}}))},3602:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{M:()=>s});var n=r(5063),o=r(7707),a=t([n,o]);[n,o]=a.then?(await a)():a;class s{free(){this.raw&&this.raw.free(),this.raw=void 0}constructor(t){this.raw=t||new n.yK}step(t,e,r,i,n,a,s,c,l,h,u,_){let d=o.if.intoRaw(t);u?this.raw.stepWithEvents(d,e.raw,r.raw,i.raw,n.raw,a.raw,s.raw,c.raw,l.raw,h.raw,u.raw,_,_?_.filterContactPair:null,_?_.filterIntersectionPair:null):this.raw.step(d,e.raw,r.raw,i.raw,n.raw,a.raw,s.raw,c.raw,l.raw,h.raw),d.free()}}i()}catch(t){i(t)}}))},4172:(t,e,r)=>{function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,o(i.key),i)}}function o(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}r.d(e,{Q:()=>a});var a=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.healthBar=e.querySelector("#health-bar .health-value"),this.ammoCounter=e.querySelector("#ammo-counter"),this.weaponInfo=e.querySelector("#weapon-info"),this.statusMessages=e.querySelector("#status-messages"),this.health=100,this.ammo=0,this.weapon="Нет",this.messages=[],this.messageTimer=null,this.initialize()},e=[{key:"initialize",value:function(){this.healthBar&&this.updateHealthBar(),this.ammoCounter&&this.updateAmmoCounter(),this.weaponInfo&&this.updateWeaponInfo()}},{key:"update",value:function(t){void 0!==t.health&&t.health!==this.health&&(this.health=t.health,this.updateHealthBar()),void 0!==t.ammo&&t.ammo!==this.ammo&&(this.ammo=t.ammo,this.updateAmmoCounter()),void 0!==t.weapon&&t.weapon!==this.weapon&&(this.weapon=t.weapon,this.updateWeaponInfo())}},{key:"updateHealthBar",value:function(){this.healthBar&&(this.healthBar.style.width="".concat(this.health,"%"),this.health>70?this.healthBar.style.backgroundColor="#4CAF50":this.health>30?this.healthBar.style.backgroundColor="#FFC107":this.healthBar.style.backgroundColor="#F44336")}},{key:"updateAmmoCounter",value:function(){this.ammoCounter&&(this.ammoCounter.textContent="".concat(this.ammo))}},{key:"updateWeaponInfo",value:function(){this.weaponInfo&&(this.weaponInfo.textContent=this.weapon)}},{key:"addStatusMessage",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;this.messages.push({text:t,timestamp:Date.now(),duration:r}),this.updateStatusMessages(),null===this.messageTimer&&(this.messageTimer=setInterval((function(){e.checkMessagesTimeout()}),1e3))}},{key:"updateStatusMessages",value:function(){var t=this;this.statusMessages&&(this.statusMessages.innerHTML="",this.messages.forEach((function(e){var r=document.createElement("div");r.className="status-message",r.textContent=e.text,t.statusMessages.appendChild(r)})))}},{key:"checkMessagesTimeout",value:function(){var t=Date.now(),e=!1;this.messages=this.messages.filter((function(r){var i=t-r.timestamp>r.duration;return i&&(e=!0),!i})),e&&this.updateStatusMessages(),0===this.messages.length&&(clearInterval(this.messageTimer),this.messageTimer=null)}},{key:"show",value:function(){this.element.classList.remove("hidden")}},{key:"hide",value:function(){this.element.classList.add("hidden")}}],e&&n(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}()},4192:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{$1:()=>o.$1,$M:()=>o.$M,BX:()=>o.BX,FJ:()=>o.FJ,I$:()=>o.I$,KH:()=>o.KH,NL:()=>o.NL,Pu:()=>o.Pu,Ry:()=>o.Ry,Sn:()=>o.Sn,Y6:()=>o.Y6,YK:()=>o.YK,aF:()=>o.aF,co:()=>o.co,eW:()=>o.eW,m3:()=>o.m3,m7:()=>o.m7,md:()=>o.md,pi:()=>o.pi,qj:()=>o.qj,rE:()=>o.rE,wT:()=>o.wT,xW:()=>o.xW,xm:()=>o.xm,yK:()=>o.yK,z2:()=>o.z2});var n=r(5638),o=r(1020),a=t([n]);n=(a.then?(await a)():a)[0],(0,o.lI)(n),i()}catch(t){i(t)}}))},5063:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{$1:()=>n.$1,$M:()=>n.$M,BX:()=>n.BX,FJ:()=>n.FJ,I$:()=>n.I$,KH:()=>n.KH,NL:()=>n.NL,Pu:()=>n.Pu,Ry:()=>n.Ry,Sn:()=>n.Sn,Y6:()=>n.Y6,YK:()=>n.YK,aF:()=>n.aF,co:()=>n.co,eW:()=>n.eW,m3:()=>n.m3,m7:()=>n.m7,md:()=>n.md,pi:()=>n.pi,qj:()=>n.qj,rE:()=>n.rE,wT:()=>n.wT,xW:()=>n.xW,xm:()=>n.xm,yK:()=>n.yK,z2:()=>n.z2});var n=r(4192),o=t([n]);n=(o.then?(await o)():o)[0],i()}catch(t){i(t)}}))},5081:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{D:()=>a});var n=r(5063),o=t([n]);n=(o.then?(await o)():o)[0];class a{constructor(t){this.raw=t||new n.xW}free(){this.raw&&this.raw.free(),this.raw=void 0}get dt(){return this.raw.dt}get contact_erp(){return this.raw.contact_erp}get lengthUnit(){return this.raw.lengthUnit}get normalizedAllowedLinearError(){return this.raw.normalizedAllowedLinearError}get normalizedPredictionDistance(){return this.raw.normalizedPredictionDistance}get numSolverIterations(){return this.raw.numSolverIterations}get numAdditionalFrictionIterations(){return this.raw.numAdditionalFrictionIterations}get numInternalPgsIterations(){return this.raw.numInternalPgsIterations}get minIslandSize(){return this.raw.minIslandSize}get maxCcdSubsteps(){return this.raw.maxCcdSubsteps}set dt(t){this.raw.dt=t}set contact_natural_frequency(t){this.raw.contact_natural_frequency=t}set lengthUnit(t){this.raw.lengthUnit=t}set normalizedAllowedLinearError(t){this.raw.normalizedAllowedLinearError=t}set normalizedPredictionDistance(t){this.raw.normalizedPredictionDistance=t}set numSolverIterations(t){this.raw.numSolverIterations=t}set numAdditionalFrictionIterations(t){this.raw.numAdditionalFrictionIterations=t}set numInternalPgsIterations(t){this.raw.numInternalPgsIterations=t}set minIslandSize(t){this.raw.minIslandSize=t}set maxCcdSubsteps(t){this.raw.maxCcdSubsteps=t}switchToStandardPgsSolver(){this.raw.switchToStandardPgsSolver()}switchToSmallStepsPgsSolver(){this.raw.switchToSmallStepsPgsSolver()}switchToSmallStepsPgsSolverWithoutWarmstart(){this.raw.switchToSmallStepsPgsSolverWithoutWarmstart()}}i()}catch(t){i(t)}}))},5396:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{Cb:()=>l,OX:()=>n,S6:()=>c});var n,o=r(5063),a=r(7707),s=t([o,a]);[o,a]=s.then?(await s)():s,function(t){t[t.NONE=0]="NONE",t[t.COLLISION_EVENTS=1]="COLLISION_EVENTS",t[t.CONTACT_FORCE_EVENTS=2]="CONTACT_FORCE_EVENTS"}(n||(n={}));class c{free(){this.raw&&this.raw.free(),this.raw=void 0}collider1(){return this.raw.collider1()}collider2(){return this.raw.collider2()}totalForce(){return a.if.fromRaw(this.raw.total_force())}totalForceMagnitude(){return this.raw.total_force_magnitude()}maxForceDirection(){return a.if.fromRaw(this.raw.max_force_direction())}maxForceMagnitude(){return this.raw.max_force_magnitude()}}class l{constructor(t,e){this.raw=e||new o.m7(t)}free(){this.raw&&this.raw.free(),this.raw=void 0}drainCollisionEvents(t){this.raw.drainCollisionEvents(t)}drainContactForceEvents(t){let e=new c;this.raw.drainContactForceEvents((r=>{e.raw=r,t(e),e.free()}))}clear(){this.raw.clear()}}i()}catch(t){i(t)}}))},5440:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{K:()=>l});var n=r(2472),o=t([n]);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",h=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function _(t,e,r,i){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),s=new A(i||[]);return n(a,"_invoke",{value:k(t,r,s)}),a}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=_;var p="suspendedStart",w="suspendedYield",f="executing",g="completed",y={};function m(){}function b(){}function v(){}var S={};u(S,c,(function(){return this}));var R=Object.getPrototypeOf,E=R&&R(R(j([])));E&&E!==r&&i.call(E,c)&&(S=E);var x=v.prototype=m.prototype=Object.create(S);function C(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,o,s,c){var l=d(t[n],t,o);if("throw"!==l.type){var h=l.arg,u=h.value;return u&&"object"==a(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,s,c)}),(function(t){r("throw",t,s,c)})):e.resolve(u).then((function(t){h.value=t,s(h)}),(function(t){return r("throw",t,s,c)}))}c(l.arg)}var o;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return o=o?o.then(n,n):n()}})}function k(e,r,i){var n=p;return function(o,a){if(n===f)throw Error("Generator is already running");if(n===g){if("throw"===o)throw a;return{value:t,done:!0}}for(i.method=o,i.arg=a;;){var s=i.delegate;if(s){var c=M(s,i);if(c){if(c===y)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===p)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=f;var l=d(e,r,i);if("normal"===l.type){if(n=i.done?g:w,l.arg===y)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=g,i.method="throw",i.arg=l.arg)}}}function M(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,M(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=d(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function j(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(a(e)+" is not iterable")}return b.prototype=v,n(x,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:b,configurable:!0}),b.displayName=u(v,h,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,h,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},C(P.prototype),u(P.prototype,l,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var a=new P(_(t,r,i,n),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},C(x),u(x,h,"Generator"),u(x,c,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=j,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return s.type="throw",s.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:j(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function c(t,e,r,i,n,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(i,n)}function l(){return h.apply(this,arguments)}function h(){var t;return t=s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("🔄 initRapier: Rapier 3D загружен напрямую, инициализация не требуется"),t.abrupt("return",n);case 2:case"end":return t.stop()}}),t)})),h=function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(t){c(o,i,n,a,s,"next",t)}function s(t){c(o,i,n,a,s,"throw",t)}a(void 0)}))},h.apply(this,arguments)}n=(o.then?(await o)():o)[0],i()}catch(u){i(u)}}))},5551:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{x:()=>a});var n=r(5063),o=t([n]);n=(o.then?(await o)():o)[0];class a{free(){this.raw&&this.raw.free(),this.raw=void 0}constructor(t){this.raw=t||new n.z2}forEachActiveRigidBodyHandle(t){this.raw.forEachActiveRigidBodyHandle(t)}}i()}catch(t){i(t)}}))},5638:(t,e,r)=>{var i=r(1020);t.exports=r.v(e,t.id,"8364430485b336c7353c",{"./rapier_wasm3d_bg.js":{__wbindgen_number_new:i.QR,__wbindgen_boolean_get:i.Nh,__wbindgen_object_drop_ref:i.bk,__wbindgen_number_get:i.sW,__wbindgen_is_function:i.PR,__wbg_rawraycolliderintersection_new:i.ih,__wbg_rawcontactforceevent_new:i.aN,__wbg_call_7cccdd69e0791ae2:i.w9,__wbg_call_833bed5770ea2041:i.sR,__wbg_call_b8adc8b1d0a0d8eb:i.c6,__wbg_bind_c8359b1cba058168:i.xH,__wbg_buffer_609cc3eee51ed158:i.FH,__wbg_newwithbyteoffsetandlength_d97e637ebe145a9a:i.hI,__wbg_new_a12002a7f91c75be:i.vV,__wbg_set_65595bdd868b3009:i.HB,__wbg_length_a446193dc22c12f8:i.eI,__wbg_newwithbyteoffsetandlength_e6b7e69acd4c7354:i.BK,__wbg_set_10bad9bee0e9c58b:i.yJ,__wbg_length_3b4f022188ae8db6:i.pv,__wbg_newwithlength_5a5efe313cfd59f1:i.nF,__wbindgen_throw:i.Qn,__wbindgen_memory:i.Py}})},6283:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{Z:()=>l});var n=r(5063),o=r(8836),a=r(7707),s=r(2952),c=t([n,a,s]);[n,a,s]=c.then?(await c)():c;class l{free(){this.raw&&this.raw.free(),this.raw=void 0,this.map&&this.map.clear(),this.map=void 0}constructor(t){this.raw=t||new n.NL,this.map=new o.y,t&&t.forEachColliderHandle((t=>{this.map.set(t,new s.Jo(this,t,null))}))}castClosure(t){return e=>t?t(this.get(e)):void 0}finalizeDeserialization(t){this.map.forEach((e=>e.finalizeDeserialization(t)))}createCollider(t,e,r){let i=null!=r&&null!=r;if(i&&isNaN(r))throw Error("Cannot create a collider with a parent rigid-body handle that is not a number.");let n=e.shape.intoRaw(),o=a.if.intoRaw(e.translation),c=a.PB.intoRaw(e.rotation),l=a.if.intoRaw(e.centerOfMass),h=a.if.intoRaw(e.principalAngularInertia),u=a.PB.intoRaw(e.angularInertiaLocalFrame),_=this.raw.createCollider(e.enabled,n,o,c,e.massPropsMode,e.mass,l,h,u,e.density,e.friction,e.restitution,e.frictionCombineRule,e.restitutionCombineRule,e.isSensor,e.collisionGroups,e.solverGroups,e.activeCollisionTypes,e.activeHooks,e.activeEvents,e.contactForceEventThreshold,e.contactSkin,i,i?r:0,t.raw);n.free(),o.free(),c.free(),l.free(),h.free(),u.free();let d=i?t.get(r):null,p=new s.Jo(this,_,d,e.shape);return this.map.set(_,p),p}remove(t,e,r,i){this.raw.remove(t,e.raw,r.raw,i),this.unmap(t)}unmap(t){this.map.delete(t)}get(t){return this.map.get(t)}len(){return this.map.len()}contains(t){return null!=this.get(t)}forEach(t){this.map.forEach(t)}getAll(){return this.map.getAll()}}i()}catch(t){i(t)}}))},6370:(t,e,r)=>{var i,n;r.d(e,{L:()=>n,X:()=>i}),function(t){t[t.NONE=0]="NONE",t[t.FILTER_CONTACT_PAIRS=1]="FILTER_CONTACT_PAIRS",t[t.FILTER_INTERSECTION_PAIRS=2]="FILTER_INTERSECTION_PAIRS"}(i||(i={})),function(t){t[t.EMPTY=0]="EMPTY",t[t.COMPUTE_IMPULSE=1]="COMPUTE_IMPULSE"}(n||(n={}))},6410:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{I0:()=>l,OM:()=>h,Rl:()=>s,cU:()=>c});var n=r(7707),o=r(2192),a=t([n]);n=(a.then?(await a)():a)[0];class s{constructor(t,e){this.origin=t,this.dir=e}pointAt(t){return{x:this.origin.x+this.dir.x*t,y:this.origin.y+this.dir.y*t,z:this.origin.z+this.dir.z*t}}}class c{constructor(t,e,r,i){this.featureType=o.l.Unknown,this.featureId=void 0,this.timeOfImpact=t,this.normal=e,void 0!==i&&(this.featureId=i),void 0!==r&&(this.featureType=r)}static fromRaw(t){if(!t)return null;const e=new c(t.time_of_impact(),n.if.fromRaw(t.normal()),t.featureType(),t.featureId());return t.free(),e}}class l{constructor(t,e,r,i,n){this.featureType=o.l.Unknown,this.featureId=void 0,this.collider=t,this.timeOfImpact=e,this.normal=r,void 0!==n&&(this.featureId=n),void 0!==i&&(this.featureType=i)}static fromRaw(t,e){if(!e)return null;const r=new l(t.get(e.colliderHandle()),e.time_of_impact(),n.if.fromRaw(e.normal()),e.featureType(),e.featureId());return e.free(),r}}class h{constructor(t,e){this.collider=t,this.timeOfImpact=e}static fromRaw(t,e){if(!e)return null;const r=new h(t.get(e.colliderHandle()),e.timeOfImpact());return e.free(),r}}i()}catch(t){i(t)}}))},6414:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{BQ:()=>o.B,EN:()=>s.EN,G9:()=>a.G9,GH:()=>_.G,I0:()=>h.I0,I8:()=>a.I8,IO:()=>a.IO,JP:()=>a.JP,Jo:()=>s.Jo,OM:()=>h.OM,Rl:()=>h.Rl,Ro:()=>a.Ro,Sd:()=>a.Sd,T:()=>a.T,Uv:()=>u.U,WE:()=>a.WE,XB:()=>o.X,Y4:()=>a.Y4,Zf:()=>c.Z,_1:()=>d._,_D:()=>a._D,_j:()=>s._j,an:()=>s.an,cU:()=>h.cU,cW:()=>a.cW,cx:()=>a.cx,d2:()=>a.d2,fn:()=>a.fn,gP:()=>u.g,k2:()=>_.k,lM:()=>a.lM,lo:()=>l.l,qe:()=>a.qe,ti:()=>a.ti,tt:()=>a.tt,uf:()=>n.u,wn:()=>a.wn,yp:()=>a.yp,z6:()=>a.z6});var n=r(1062),o=r(9143),a=r(3551),s=r(2952),c=r(6283),l=r(2192),h=r(6410),u=r(6892),_=r(3218),d=r(2130),p=t([n,o,a,s,c,h,u,_,d]);[n,o,a,s,c,h,u,_,d]=p.then?(await p)():p,i()}catch(t){i(t)}}))},6554:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{A:()=>a});var n=r(5063),o=t([n]);n=(o.then?(await o)():o)[0];class a{free(){this.raw&&this.raw.free(),this.raw=void 0}constructor(t){this.raw=t||new n.qj}}i()}catch(t){i(t)}}))},6745:(t,e,r)=>{function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,o(i.key),i)}}function o(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}r.d(e,{A:()=>a});var a=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,this.scene=null,this.camera=null,this.renderer=null,this.lights=[],this.models={},this.textures={},this.visionSystem=null,this.temporaryObjects=[]},e=[{key:"setupScene",value:function(){var t=this;this.scene=new THREE.Scene,this.scene.background=new THREE.Color(8900331);var e=window.innerWidth/window.innerHeight;this.camera=new THREE.PerspectiveCamera(75,e,.1,1e3),this.camera.position.set(0,30,30),this.camera.lookAt(0,0,0),this.renderer=new THREE.WebGLRenderer({canvas:this.canvas,antialias:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.shadowMap.enabled=!0,this.setupLights(),this.createGround(),this.visionSystem=null,window.addEventListener("resize",(function(){t.camera.aspect=window.innerWidth/window.innerHeight,t.camera.updateProjectionMatrix(),t.renderer.setSize(window.innerWidth,window.innerHeight)}))}},{key:"setupLights",value:function(){var t=new THREE.DirectionalLight(16777215,1);t.position.set(10,30,10),t.castShadow=!0,t.shadow.mapSize.width=2048,t.shadow.mapSize.height=2048,t.shadow.camera.near=.5,t.shadow.camera.far=100,t.shadow.camera.left=-50,t.shadow.camera.right=50,t.shadow.camera.top=50,t.shadow.camera.bottom=-50,this.scene.add(t),this.lights.push(t);var e=new THREE.AmbientLight(5263440,.7);this.scene.add(e),this.lights.push(e)}},{key:"createGround",value:function(){var t=new THREE.PlaneGeometry(1e3,1e3,100,100),e=new THREE.MeshStandardMaterial({color:4089145,roughness:1,metalness:0}),r=new THREE.Mesh(t,e);r.rotation.x=-Math.PI/2,r.position.y=-.5,r.receiveShadow=!0,this.scene.add(r)}},{key:"createTemporaryBeam",value:function(t,e){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16711680,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,o=new THREE.LineBasicMaterial({color:i,transparent:!0,opacity:.8}),a=new THREE.BufferGeometry,s=[new THREE.Vector3(t.x,t.y,t.z),new THREE.Vector3(e.x,e.y,e.z)];a.setFromPoints(s);var c=new THREE.Line(a,o);this.scene.add(c);var l={object:c,endTime:Date.now()+n};this.temporaryObjects.push(l),setTimeout((function(){r.removeTemporaryObject(l)}),n)}},{key:"removeTemporaryObject",value:function(t){if(t&&t.object){this.scene.remove(t.object);var e=this.temporaryObjects.indexOf(t);-1!==e&&this.temporaryObjects.splice(e,1),t.object.geometry&&t.object.geometry.dispose(),t.object.material&&t.object.material.dispose()}}},{key:"cleanTemporaryObjects",value:function(){var t=this,e=Date.now();this.temporaryObjects=this.temporaryObjects.filter((function(r){return!(r.endTime<=e&&(t.scene.remove(r.object),r.object.geometry&&r.object.geometry.dispose(),r.object.material&&r.object.material.dispose(),1))}))}},{key:"addPlayer",value:function(t){var e=new THREE.CylinderGeometry(.5,.5,1.8,8),r=new THREE.MeshStandardMaterial({color:2003199,roughness:.7}),i=new THREE.Mesh(e,r);i.position.copy(t.position),i.castShadow=!0,i.receiveShadow=!0;var n=new THREE.BoxGeometry(.1,.1,1),o=new THREE.MeshStandardMaterial({color:3355443,roughness:.5}),a=new THREE.Mesh(n,o);return a.position.set(.5,0,.5),i.add(a),this.scene.add(i),i}},{key:"updateCamera",value:function(t){this.camera&&(this.camera.position.x=t.x,this.camera.position.z=t.z+30,this.camera.lookAt(t.x,t.y,t.z))}},{key:"updateObjectTransform",value:function(t,e,r){t&&(e&&(t.position.x=e.x,t.position.y=e.y,t.position.z=e.z),r&&(t.rotation.y=r.y))}},{key:"render",value:function(t){this.renderer&&this.scene&&this.camera&&(this.visionSystem&&t&&this.visionSystem.update(),this.cleanTemporaryObjects(),this.renderer.render(this.scene,this.camera))}},{key:"setQuality",value:function(t){if(this.renderer)switch(t){case"low":this.renderer.setPixelRatio(1),this.renderer.shadowMap.enabled=!1;break;case"medium":this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=THREE.PCFShadowMap;break;case"high":this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=THREE.PCFSoftShadowMap}}},{key:"addItem",value:function(t){var e,r;switch(t.type){case"weapon":e=new THREE.BoxGeometry(.8,.3,.2),r=new THREE.MeshStandardMaterial({color:16733986});break;case"medkit":e=new THREE.BoxGeometry(.5,.3,.5),r=new THREE.MeshStandardMaterial({color:5025616});break;case"ammo":e=new THREE.BoxGeometry(.3,.3,.3),r=new THREE.MeshStandardMaterial({color:16761095});break;default:e=new THREE.SphereGeometry(.3,8,8),r=new THREE.MeshStandardMaterial({color:13421772})}var i=new THREE.Mesh(e,r);return i.position.copy(t.position),i.position.y=.2,i.castShadow=!0,i.receiveShadow=!0,this.scene.add(i),i}},{key:"addNPC",value:function(t){var e=new THREE.CylinderGeometry(.5,.5,1.8,8),r=new THREE.MeshStandardMaterial({color:"enemy"===t.type?16711680:65280,roughness:.7}),i=new THREE.Mesh(e,r);return i.position.copy(t.position),i.castShadow=!0,i.receiveShadow=!0,this.scene.add(i),i}}],e&&n(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}()},6892:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{U:()=>c,g:()=>s});var n=r(7707),o=r(2192),a=t([n]);n=(a.then?(await a)():a)[0];class s{constructor(t,e){this.point=t,this.isInside=e}static fromRaw(t){if(!t)return null;const e=new s(n.if.fromRaw(t.point()),t.isInside());return t.free(),e}}class c{constructor(t,e,r,i,n){this.featureType=o.l.Unknown,this.featureId=void 0,this.collider=t,this.point=e,this.isInside=r,void 0!==n&&(this.featureId=n),void 0!==i&&(this.featureType=i)}static fromRaw(t,e){if(!e)return null;const r=new c(t.get(e.colliderHandle()),n.if.fromRaw(e.point()),e.isInside(),e.featureType(),e.featureId());return e.free(),r}}i()}catch(t){i(t)}}))},6976:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{H:()=>S});var n=r(1062),o=r(9143),a=r(6283),s=r(5081),c=r(5551),l=r(7245),h=r(3211),u=r(2337),_=r(6554),d=r(7707),p=r(3602),w=r(157),f=r(7529),g=r(983),y=r(1923),m=r(8365),b=r(2125),v=t([d,s,c,n,o,l,a,h,u,_,w,p,f,g,y,m,b]);[d,s,c,n,o,l,a,h,u,_,w,p,f,g,y,m,b]=v.then?(await v)():v;class S{free(){this.integrationParameters.free(),this.islands.free(),this.broadPhase.free(),this.narrowPhase.free(),this.bodies.free(),this.colliders.free(),this.impulseJoints.free(),this.multibodyJoints.free(),this.ccdSolver.free(),this.queryPipeline.free(),this.physicsPipeline.free(),this.serializationPipeline.free(),this.debugRenderPipeline.free(),this.characterControllers.forEach((t=>t.free())),this.pidControllers.forEach((t=>t.free())),this.vehicleControllers.forEach((t=>t.free())),this.integrationParameters=void 0,this.islands=void 0,this.broadPhase=void 0,this.narrowPhase=void 0,this.bodies=void 0,this.colliders=void 0,this.ccdSolver=void 0,this.impulseJoints=void 0,this.multibodyJoints=void 0,this.queryPipeline=void 0,this.physicsPipeline=void 0,this.serializationPipeline=void 0,this.debugRenderPipeline=void 0,this.characterControllers=void 0,this.pidControllers=void 0,this.vehicleControllers=void 0}constructor(t,e,r,i,d,y,m,b,v,S,R,E,x,C){this.gravity=t,this.integrationParameters=new s.D(e),this.islands=new c.x(r),this.broadPhase=new n.u(i),this.narrowPhase=new o.X(d),this.bodies=new l.k(y),this.colliders=new a.Z(m),this.impulseJoints=new h.e(b),this.multibodyJoints=new u.O(v),this.ccdSolver=new _.A(S),this.queryPipeline=new w.x(R),this.physicsPipeline=new p.M(E),this.serializationPipeline=new f.p(x),this.debugRenderPipeline=new g.e(C),this.characterControllers=new Set,this.pidControllers=new Set,this.vehicleControllers=new Set,this.impulseJoints.finalizeDeserialization(this.bodies),this.bodies.finalizeDeserialization(this.colliders),this.colliders.finalizeDeserialization(this.bodies)}static fromRaw(t){return t?new S(d.if.fromRaw(t.takeGravity()),t.takeIntegrationParameters(),t.takeIslandManager(),t.takeBroadPhase(),t.takeNarrowPhase(),t.takeBodies(),t.takeColliders(),t.takeImpulseJoints(),t.takeMultibodyJoints()):null}takeSnapshot(){return this.serializationPipeline.serializeAll(this.gravity,this.integrationParameters,this.islands,this.broadPhase,this.narrowPhase,this.bodies,this.colliders,this.impulseJoints,this.multibodyJoints)}static restoreSnapshot(t){return(new f.p).deserializeAll(t)}debugRender(){return this.debugRenderPipeline.render(this.bodies,this.colliders,this.impulseJoints,this.multibodyJoints,this.narrowPhase),new g.B(this.debugRenderPipeline.vertices,this.debugRenderPipeline.colors)}step(t,e){this.physicsPipeline.step(this.gravity,this.integrationParameters,this.islands,this.broadPhase,this.narrowPhase,this.bodies,this.colliders,this.impulseJoints,this.multibodyJoints,this.ccdSolver,t,e),this.queryPipeline.update(this.colliders)}propagateModifiedBodyPositionsToColliders(){this.bodies.raw.propagateModifiedBodyPositionsToColliders(this.colliders.raw)}updateSceneQueries(){this.propagateModifiedBodyPositionsToColliders(),this.queryPipeline.update(this.colliders)}get timestep(){return this.integrationParameters.dt}set timestep(t){this.integrationParameters.dt=t}get lengthUnit(){return this.integrationParameters.lengthUnit}set lengthUnit(t){this.integrationParameters.lengthUnit=t}get numSolverIterations(){return this.integrationParameters.numSolverIterations}set numSolverIterations(t){this.integrationParameters.numSolverIterations=t}get numAdditionalFrictionIterations(){return this.integrationParameters.numAdditionalFrictionIterations}set numAdditionalFrictionIterations(t){this.integrationParameters.numAdditionalFrictionIterations=t}get numInternalPgsIterations(){return this.integrationParameters.numInternalPgsIterations}set numInternalPgsIterations(t){this.integrationParameters.numInternalPgsIterations=t}switchToStandardPgsSolver(){this.integrationParameters.switchToStandardPgsSolver()}switchToSmallStepsPgsSolver(){this.integrationParameters.switchToSmallStepsPgsSolver()}switchToSmallStepsPgsSolverWithoutWarmstart(){this.integrationParameters.switchToSmallStepsPgsSolverWithoutWarmstart()}createRigidBody(t){return this.bodies.createRigidBody(this.colliders,t)}createCharacterController(t){let e=new y.B(t,this.integrationParameters,this.bodies,this.colliders,this.queryPipeline);return this.characterControllers.add(e),e}removeCharacterController(t){this.characterControllers.delete(t),t.free()}createPidController(t,e,r,i){let n=new m.E(this.integrationParameters,this.bodies,t,e,r,i);return this.pidControllers.add(n),n}removePidController(t){this.pidControllers.delete(t),t.free()}createVehicleController(t){let e=new b.L(t,this.bodies,this.colliders,this.queryPipeline);return this.vehicleControllers.add(e),e}removeVehicleController(t){this.vehicleControllers.delete(t),t.free()}createCollider(t,e){let r=e?e.handle:void 0;return this.colliders.createCollider(this.bodies,t,r)}createImpulseJoint(t,e,r,i){return this.impulseJoints.createJoint(this.bodies,t,e.handle,r.handle,i)}createMultibodyJoint(t,e,r,i){return this.multibodyJoints.createJoint(t,e.handle,r.handle,i)}getRigidBody(t){return this.bodies.get(t)}getCollider(t){return this.colliders.get(t)}getImpulseJoint(t){return this.impulseJoints.get(t)}getMultibodyJoint(t){return this.multibodyJoints.get(t)}removeRigidBody(t){this.bodies&&this.bodies.remove(t.handle,this.islands,this.colliders,this.impulseJoints,this.multibodyJoints)}removeCollider(t,e){this.colliders&&this.colliders.remove(t.handle,this.islands,this.bodies,e)}removeImpulseJoint(t,e){this.impulseJoints&&this.impulseJoints.remove(t.handle,e)}removeMultibodyJoint(t,e){this.impulseJoints&&this.multibodyJoints.remove(t.handle,e)}forEachCollider(t){this.colliders.forEach(t)}forEachRigidBody(t){this.bodies.forEach(t)}forEachActiveRigidBody(t){this.bodies.forEachActiveRigidBody(this.islands,t)}castRay(t,e,r,i,n,o,a,s){return this.queryPipeline.castRay(this.bodies,this.colliders,t,e,r,i,n,o?o.handle:null,a?a.handle:null,this.colliders.castClosure(s))}castRayAndGetNormal(t,e,r,i,n,o,a,s){return this.queryPipeline.castRayAndGetNormal(this.bodies,this.colliders,t,e,r,i,n,o?o.handle:null,a?a.handle:null,this.colliders.castClosure(s))}intersectionsWithRay(t,e,r,i,n,o,a,s,c){this.queryPipeline.intersectionsWithRay(this.bodies,this.colliders,t,e,r,i,n,o,a?a.handle:null,s?s.handle:null,this.colliders.castClosure(c))}intersectionWithShape(t,e,r,i,n,o,a,s){let c=this.queryPipeline.intersectionWithShape(this.bodies,this.colliders,t,e,r,i,n,o?o.handle:null,a?a.handle:null,this.colliders.castClosure(s));return null!=c?this.colliders.get(c):null}projectPoint(t,e,r,i,n,o,a){return this.queryPipeline.projectPoint(this.bodies,this.colliders,t,e,r,i,n?n.handle:null,o?o.handle:null,this.colliders.castClosure(a))}projectPointAndGetFeature(t,e,r,i,n,o){return this.queryPipeline.projectPointAndGetFeature(this.bodies,this.colliders,t,e,r,i?i.handle:null,n?n.handle:null,this.colliders.castClosure(o))}intersectionsWithPoint(t,e,r,i,n,o,a){this.queryPipeline.intersectionsWithPoint(this.bodies,this.colliders,t,this.colliders.castClosure(e),r,i,n?n.handle:null,o?o.handle:null,this.colliders.castClosure(a))}castShape(t,e,r,i,n,o,a,s,c,l,h,u){return this.queryPipeline.castShape(this.bodies,this.colliders,t,e,r,i,n,o,a,s,c,l?l.handle:null,h?h.handle:null,this.colliders.castClosure(u))}intersectionsWithShape(t,e,r,i,n,o,a,s,c){this.queryPipeline.intersectionsWithShape(this.bodies,this.colliders,t,e,r,this.colliders.castClosure(i),n,o,a?a.handle:null,s?s.handle:null,this.colliders.castClosure(c))}collidersWithAabbIntersectingAabb(t,e,r){this.queryPipeline.collidersWithAabbIntersectingAabb(t,e,this.colliders.castClosure(r))}contactPairsWith(t,e){this.narrowPhase.contactPairsWith(t.handle,this.colliders.castClosure(e))}intersectionPairsWith(t,e){this.narrowPhase.intersectionPairsWith(t.handle,this.colliders.castClosure(e))}contactPair(t,e,r){this.narrowPhase.contactPair(t.handle,e.handle,r)}intersectionPair(t,e){return this.narrowPhase.intersectionPair(t.handle,e.handle)}}i()}catch(t){i(t)}}))},7245:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{k:()=>l});var n=r(5063),o=r(8836),a=r(7707),s=r(2210),c=t([n,a,s]);[n,a,s]=c.then?(await c)():c;class l{free(){this.raw&&this.raw.free(),this.raw=void 0,this.map&&this.map.clear(),this.map=void 0}constructor(t){this.raw=t||new n.I$,this.map=new o.y,t&&t.forEachRigidBodyHandle((e=>{this.map.set(e,new s.Ux(t,null,e))}))}finalizeDeserialization(t){this.map.forEach((e=>e.finalizeDeserialization(t)))}createRigidBody(t,e){let r=a.if.intoRaw(e.translation),i=a.PB.intoRaw(e.rotation),n=a.if.intoRaw(e.linvel),o=a.if.intoRaw(e.centerOfMass),c=a.if.intoRaw(e.angvel),l=a.if.intoRaw(e.principalAngularInertia),h=a.PB.intoRaw(e.angularInertiaLocalFrame),u=this.raw.createRigidBody(e.enabled,r,i,e.gravityScale,e.mass,e.massOnly,o,n,c,l,h,e.translationsEnabledX,e.translationsEnabledY,e.translationsEnabledZ,e.rotationsEnabledX,e.rotationsEnabledY,e.rotationsEnabledZ,e.linearDamping,e.angularDamping,e.status,e.canSleep,e.sleeping,e.softCcdPrediction,e.ccdEnabled,e.dominanceGroup,e.additionalSolverIterations);r.free(),i.free(),n.free(),o.free(),c.free(),l.free(),h.free();const _=new s.Ux(this.raw,t,u);return _.userData=e.userData,this.map.set(u,_),_}remove(t,e,r,i,n){for(let e=0;e<this.raw.rbNumColliders(t);e+=1)r.unmap(this.raw.rbCollider(t,e));i.forEachJointHandleAttachedToRigidBody(t,(t=>i.unmap(t))),n.forEachJointHandleAttachedToRigidBody(t,(t=>n.unmap(t))),this.raw.remove(t,e.raw,r.raw,i.raw,n.raw),this.map.delete(t)}len(){return this.map.len()}contains(t){return null!=this.get(t)}get(t){return this.map.get(t)}forEach(t){this.map.forEach(t)}forEachActiveRigidBody(t,e){t.forEachActiveRigidBodyHandle((t=>{e(this.get(t))}))}getAll(){return this.map.getAll()}}i()}catch(t){i(t)}}))},7529:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{p:()=>c});var n=r(5063),o=r(7707),a=r(6976),s=t([n,o,a]);[n,o,a]=s.then?(await s)():s;class c{free(){this.raw&&this.raw.free(),this.raw=void 0}constructor(t){this.raw=t||new n.pi}serializeAll(t,e,r,i,n,a,s,c,l){let h=o.if.intoRaw(t);const u=this.raw.serializeAll(h,e.raw,r.raw,i.raw,n.raw,a.raw,s.raw,c.raw,l.raw);return h.free(),u}deserializeAll(t){return a.H.fromRaw(this.raw.deserializeAll(t))}}i()}catch(t){i(t)}}))},7702:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{D:()=>c});var n=r(4172),o=r(8273),a=r(147),s=t([a]);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function h(){h=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function _(t,e,r,i){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),s=new A(i||[]);return n(a,"_invoke",{value:k(t,r,s)}),a}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=_;var p="suspendedStart",w="suspendedYield",f="executing",g="completed",y={};function m(){}function b(){}function v(){}var S={};u(S,a,(function(){return this}));var R=Object.getPrototypeOf,E=R&&R(R(j([])));E&&E!==r&&i.call(E,a)&&(S=E);var x=v.prototype=m.prototype=Object.create(S);function C(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(n,o,a,s){var c=d(t[n],t,o);if("throw"!==c.type){var h=c.arg,u=h.value;return u&&"object"==l(u)&&i.call(u,"__await")?e.resolve(u.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(u).then((function(t){h.value=t,a(h)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;n(this,"_invoke",{value:function(t,i){function n(){return new e((function(e,n){r(t,i,e,n)}))}return o=o?o.then(n,n):n()}})}function k(e,r,i){var n=p;return function(o,a){if(n===f)throw Error("Generator is already running");if(n===g){if("throw"===o)throw a;return{value:t,done:!0}}for(i.method=o,i.arg=a;;){var s=i.delegate;if(s){var c=M(s,i);if(c){if(c===y)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===p)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=f;var l=d(e,r,i);if("normal"===l.type){if(n=i.done?g:w,l.arg===y)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=g,i.method="throw",i.arg=l.arg)}}}function M(e,r){var i=r.method,n=e.iterator[i];if(n===t)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=t,M(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=d(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function j(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(l(e)+" is not iterable")}return b.prototype=v,n(x,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:b,configurable:!0}),b.displayName=u(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},C(P.prototype),u(P.prototype,s,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var a=new P(_(t,r,i,n),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},C(x),u(x,c,"Generator"),u(x,a,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var i in e)r.push(i);return r.reverse(),function t(){for(;r.length;){var i=r.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=j,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return s.type="throw",s.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:j(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),y}},e}function u(t,e,r,i,n,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(i,n)}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,p(i.key),i)}}function p(t){var e=w(t,"string");return"symbol"==l(e)?e:e+""}function w(t,e){if("object"!=l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}a=(s.then?(await s)():s)[0];var c=function(){return t=function t(e){_(this,t),this.game=e,this.loadingScreen=document.getElementById("loading-screen"),this.mainMenu=document.getElementById("main-menu"),this.gameCanvas=document.getElementById("game-canvas"),this.hudElement=document.getElementById("hud"),this.inventoryScreen=document.getElementById("inventory-screen"),this.loadingStatus=document.getElementById("loading-status"),this.components={hud:null,inventory:null}},e=[{key:"initComponents",value:(r=h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.components={hud:this.hudElement?new n.Q(this.hudElement):null,inventory:this.inventoryScreen?new o.R(this.inventoryScreen):null},t.abrupt("return",!0);case 2:case"end":return t.stop()}}),t,this)})),i=function(){var t=this,e=arguments;return new Promise((function(i,n){var o=r.apply(t,e);function a(t){u(o,i,n,a,s,"next",t)}function s(t){u(o,i,n,a,s,"throw",t)}a(void 0)}))},function(){return i.apply(this,arguments)})},{key:"updateLoadingStatus",value:function(t){this.loadingStatus&&(this.loadingStatus.textContent=t),(0,a.R)(t)}},{key:"showErrorScreen",value:function(t){var e=document.getElementById("error-screen");if(e){var r=document.getElementById("error-message");r&&(r.textContent=t)}else{(e=document.createElement("div")).id="error-screen",e.className="error-overlay",e.innerHTML='\n                <div class="error-container">\n                    <h2>Произошла ошибка</h2>\n                    <p id="error-message">'.concat(t,'</p>\n                    <button id="reload-button">Перезагрузить</button>\n                </div>\n            '),document.body.appendChild(e);var i=document.getElementById("reload-button");i&&i.addEventListener("click",(function(){window.location.reload()}));var n=document.createElement("style");n.textContent="\n                .error-overlay {\n                    position: fixed;\n                    top: 0;\n                    left: 0;\n                    width: 100%;\n                    height: 100%;\n                    background-color: rgba(0, 0, 0, 0.85);\n                    z-index: 9999;\n                    display: flex;\n                    justify-content: center;\n                    align-items: center;\n                }\n                .error-container {\n                    background-color: #333;\n                    padding: 20px;\n                    border: 2px solid #f44336;\n                    max-width: 80%;\n                    text-align: center;\n                }\n                .error-container h2 {\n                    color: #f44336;\n                    margin-bottom: 15px;\n                }\n                .error-container p {\n                    color: #fff;\n                    margin-bottom: 20px;\n                    font-family: monospace;\n                    white-space: pre-wrap;\n                    text-align: left;\n                }\n                #reload-button {\n                    background-color: #4CAF50;\n                    color: white;\n                    border: none;\n                    padding: 10px 20px;\n                    cursor: pointer;\n                    font-size: 16px;\n                }\n                #reload-button:hover {\n                    background-color: #45a049;\n                }\n            ",document.head.appendChild(n)}this.loadingScreen&&this.loadingScreen.classList.add("hidden")}},{key:"showMainMenu",value:function(){this.loadingScreen&&this.loadingScreen.classList.add("hidden"),this.mainMenu&&this.mainMenu.classList.remove("hidden"),this.game.state.currentScene="menu",(0,a.R)("Главное меню отображено")}},{key:"hideMainMenu",value:function(){this.mainMenu&&this.mainMenu.classList.add("hidden")}},{key:"showGameScreen",value:function(){this.gameCanvas&&this.gameCanvas.classList.remove("hidden"),this.hudElement&&this.hudElement.classList.remove("hidden")}},{key:"update",value:function(){this.game.world.player&&this.components.hud&&this.components.hud.update({health:this.game.world.player.health,ammo:this.game.world.player.ammo,weapon:this.game.world.player.weapon})}},{key:"toggleInventory",value:function(){this.inventoryScreen.classList.contains("hidden")?this.showInventory():this.hideInventory()}},{key:"showInventory",value:function(){this.inventoryScreen.classList.remove("hidden"),this.components.inventory&&this.components.inventory.show(),this.game.input&&this.game.input.disableGameControls()}},{key:"hideInventory",value:function(){this.inventoryScreen.classList.add("hidden"),this.components.inventory&&this.components.inventory.hide(),this.game.input&&this.game.input.enableGameControls()}}],e&&d(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,i}();i()}catch(f){i(f)}}))},7707:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{K:()=>u,PB:()=>l,PT:()=>c,Pq:()=>a,Qr:()=>h,if:()=>s});var n=r(5063),o=t([n]);n=(o.then?(await o)():o)[0];class a{constructor(t,e,r){this.x=t,this.y=e,this.z=r}}class s{static new(t,e,r){return new a(t,e,r)}static intoRaw(t){return new n.KH(t.x,t.y,t.z)}static zeros(){return s.new(0,0,0)}static fromRaw(t){if(!t)return null;let e=s.new(t.x,t.y,t.z);return t.free(),e}static copy(t,e){t.x=e.x,t.y=e.y,t.z=e.z}}class c{constructor(t,e,r,i){this.x=t,this.y=e,this.z=r,this.w=i}}class l{static identity(){return new c(0,0,0,1)}static fromRaw(t){if(!t)return null;let e=new c(t.x,t.y,t.z,t.w);return t.free(),e}static intoRaw(t){return new n.$M(t.x,t.y,t.z,t.w)}static copy(t,e){t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w}}class h{get m11(){return this.elements[0]}get m12(){return this.elements[1]}get m21(){return this.m12}get m13(){return this.elements[2]}get m31(){return this.m13}get m22(){return this.elements[3]}get m23(){return this.elements[4]}get m32(){return this.m23}get m33(){return this.elements[5]}constructor(t){this.elements=t}}class u{static fromRaw(t){const e=new h(t.elements());return t.free(),e}}i()}catch(t){i(t)}}))},8273:(t,e,r)=>{function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,o(i.key),i)}}function o(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}r.d(e,{R:()=>a});var a=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.gridElement=e.querySelector(".inventory-grid"),this.equippedElement=e.querySelector(".equipped-items"),this.inventory={items:[],maxSlots:25},this.equipped={weapon:null,armor:null,helmet:null},this.initialize()},(e=[{key:"initialize",value:function(){this.createInventorySlots(),this.createEquippedSlots(),this.setupDragAndDrop()}},{key:"createInventorySlots",value:function(){if(this.gridElement){this.gridElement.innerHTML="";for(var t=0;t<this.inventory.maxSlots;t++){var e=document.createElement("div");e.className="inventory-slot",e.dataset.slotIndex=t,this.gridElement.appendChild(e)}}}},{key:"createEquippedSlots",value:function(){var t=this;this.equippedElement&&(this.equippedElement.innerHTML="",[{id:"weapon",label:"Оружие"},{id:"armor",label:"Броня"},{id:"helmet",label:"Шлем"}].forEach((function(e){var r=document.createElement("div");r.className="equipped-slot-container";var i=document.createElement("div");i.className="equipped-slot-label",i.textContent=e.label;var n=document.createElement("div");n.className="equipped-slot",n.dataset.slotType=e.id,r.appendChild(i),r.appendChild(n),t.equippedElement.appendChild(r)})))}},{key:"setupDragAndDrop",value:function(){this.element.querySelectorAll(".inventory-slot").forEach((function(t){t.addEventListener("click",(function(){console.log("Клик по слоту инвентаря:",t.dataset.slotIndex)}))})),this.element.querySelectorAll(".equipped-slot").forEach((function(t){t.addEventListener("click",(function(){console.log("Клик по слоту экипировки:",t.dataset.slotType)}))}))}},{key:"update",value:function(t){t&&(this.inventory=t,this.updateInventoryDisplay())}},{key:"updateEquipped",value:function(t){t&&(this.equipped=t,this.updateEquippedDisplay())}},{key:"updateInventoryDisplay",value:function(){var t=this.element.querySelectorAll(".inventory-slot");t.forEach((function(t){t.innerHTML="",t.classList.remove("filled")})),this.inventory.items.forEach((function(e,r){if(!(r>=t.length)){var i=t[r],n=document.createElement("div");switch(n.className="inventory-item",n.dataset.itemId=e.id,e.type){case"weapon":n.classList.add("item-weapon"),n.textContent="W";break;case"medkit":n.classList.add("item-medkit"),n.textContent="M";break;case"ammo":n.classList.add("item-ammo"),n.textContent="A";break;default:n.textContent="?"}i.appendChild(n),i.classList.add("filled")}}))}},{key:"updateEquippedDisplay",value:function(){var t=this.element.querySelector('.equipped-slot[data-slot-type="weapon"]');if(t&&(t.innerHTML="",this.equipped.weapon)){var e=document.createElement("div");e.className="equipped-item item-weapon",e.textContent="W",t.appendChild(e)}var r=this.element.querySelector('.equipped-slot[data-slot-type="armor"]');if(r&&(r.innerHTML="",this.equipped.armor)){var i=document.createElement("div");i.className="equipped-item item-armor",i.textContent="A",r.appendChild(i)}var n=this.element.querySelector('.equipped-slot[data-slot-type="helmet"]');if(n&&(n.innerHTML="",this.equipped.helmet)){var o=document.createElement("div");o.className="equipped-item item-helmet",o.textContent="H",n.appendChild(o)}}},{key:"addInventoryStyles",value:function(){var t=document.createElement("style");t.textContent="\n            .inventory-item {\n                width: 90%;\n                height: 90%;\n                margin: 5%;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                color: white;\n                font-weight: bold;\n                user-select: none;\n                cursor: pointer;\n            }\n            \n            .item-weapon {\n                background-color: #FF5722;\n            }\n            \n            .item-medkit {\n                background-color: #4CAF50;\n            }\n            \n            .item-ammo {\n                background-color: #FFC107;\n            }\n            \n            .item-armor {\n                background-color: #2196F3;\n            }\n            \n            .item-helmet {\n                background-color: #673AB7;\n            }\n            \n            .equipped-slot-container {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n            }\n            \n            .equipped-slot-label {\n                margin-bottom: 5px;\n                font-size: 14px;\n            }\n            \n            .equipped-item {\n                width: 90%;\n                height: 90%;\n                margin: 5%;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                color: white;\n                font-weight: bold;\n            }\n        ",document.head.appendChild(t)}},{key:"show",value:function(){document.querySelector("style[data-inventory-styles]")||this.addInventoryStyles(),this.element.classList.remove("hidden")}},{key:"hide",value:function(){this.element.classList.add("hidden")}}])&&n(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}()},8365:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{E:()=>c,l:()=>n});var n,o=r(5063),a=r(7707),s=t([o,a]);[o,a]=s.then?(await s)():s,function(t){t[t.None=0]="None",t[t.LinX=1]="LinX",t[t.LinY=2]="LinY",t[t.LinZ=4]="LinZ",t[t.AngX=8]="AngX",t[t.AngY=16]="AngY",t[t.AngZ=32]="AngZ",t[t.AllLin=7]="AllLin",t[t.AllAng=56]="AllAng",t[t.All=63]="All"}(n||(n={}));class c{constructor(t,e,r,i,n,a){this.params=t,this.bodies=e,this.raw=new o.Sn(r,i,n,a)}free(){this.raw&&this.raw.free(),this.raw=void 0}setKp(t,e){this.raw.set_kp(t,e)}setKi(t,e){this.raw.set_kp(t,e)}setKd(t,e){this.raw.set_kp(t,e)}setAxes(t){this.raw.set_axes_mask(t)}resetIntegrals(){this.raw.reset_integrals()}applyLinearCorrection(t,e,r){let i=a.if.intoRaw(e),n=a.if.intoRaw(r);this.raw.apply_linear_correction(this.params.dt,this.bodies.raw,t.handle,i,n),i.free(),n.free()}applyAngularCorrection(t,e,r){let i=a.PB.intoRaw(e),n=a.if.intoRaw(r);this.raw.apply_angular_correction(this.params.dt,this.bodies.raw,t.handle,i,n),i.free(),n.free()}linearCorrection(t,e,r){let i=a.if.intoRaw(e),n=a.if.intoRaw(r),o=this.raw.linear_correction(this.params.dt,this.bodies.raw,t.handle,i,n);return i.free(),n.free(),a.if.fromRaw(o)}angularCorrection(t,e,r){let i=a.PB.intoRaw(e),n=a.if.intoRaw(r),o=this.raw.angular_correction(this.params.dt,this.bodies.raw,t.handle,i,n);return i.free(),n.free(),a.if.fromRaw(o)}}i()}catch(t){i(t)}}))},8424:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{CA:()=>d,DO:()=>n,Po:()=>m,Qm:()=>a,Qz:()=>h,Rc:()=>y,Vn:()=>g,a7:()=>w,eN:()=>u,ik:()=>_,rA:()=>o,ux:()=>f,vH:()=>p});var n,o,a,s=r(7707),c=r(5063),l=t([s,c]);[s,c]=l.then?(await l)():l,function(t){t[t.Revolute=0]="Revolute",t[t.Fixed=1]="Fixed",t[t.Prismatic=2]="Prismatic",t[t.Rope=3]="Rope",t[t.Spring=4]="Spring",t[t.Spherical=5]="Spherical",t[t.Generic=6]="Generic"}(n||(n={})),function(t){t[t.AccelerationBased=0]="AccelerationBased",t[t.ForceBased=1]="ForceBased"}(o||(o={})),function(t){t[t.LinX=1]="LinX",t[t.LinY=2]="LinY",t[t.LinZ=4]="LinZ",t[t.AngX=8]="AngX",t[t.AngY=16]="AngY",t[t.AngZ=32]="AngZ"}(a||(a={}));class h{constructor(t,e,r){this.rawSet=t,this.bodySet=e,this.handle=r}static newTyped(t,e,r){switch(t.jointType(r)){case c.Pu.Revolute:return new f(t,e,r);case c.Pu.Prismatic:return new w(t,e,r);case c.Pu.Fixed:return new _(t,e,r);case c.Pu.Spring:return new p(t,e,r);case c.Pu.Rope:return new d(t,e,r);case c.Pu.Spherical:return new y(t,e,r);case c.Pu.Generic:return new g(t,e,r);default:return new h(t,e,r)}}finalizeDeserialization(t){this.bodySet=t}isValid(){return this.rawSet.contains(this.handle)}body1(){return this.bodySet.get(this.rawSet.jointBodyHandle1(this.handle))}body2(){return this.bodySet.get(this.rawSet.jointBodyHandle2(this.handle))}type(){return this.rawSet.jointType(this.handle)}frameX1(){return s.PB.fromRaw(this.rawSet.jointFrameX1(this.handle))}frameX2(){return s.PB.fromRaw(this.rawSet.jointFrameX2(this.handle))}anchor1(){return s.if.fromRaw(this.rawSet.jointAnchor1(this.handle))}anchor2(){return s.if.fromRaw(this.rawSet.jointAnchor2(this.handle))}setAnchor1(t){const e=s.if.intoRaw(t);this.rawSet.jointSetAnchor1(this.handle,e),e.free()}setAnchor2(t){const e=s.if.intoRaw(t);this.rawSet.jointSetAnchor2(this.handle,e),e.free()}setContactsEnabled(t){this.rawSet.jointSetContactsEnabled(this.handle,t)}contactsEnabled(){return this.rawSet.jointContactsEnabled(this.handle)}}class u extends h{limitsEnabled(){return this.rawSet.jointLimitsEnabled(this.handle,this.rawAxis())}limitsMin(){return this.rawSet.jointLimitsMin(this.handle,this.rawAxis())}limitsMax(){return this.rawSet.jointLimitsMax(this.handle,this.rawAxis())}setLimits(t,e){this.rawSet.jointSetLimits(this.handle,this.rawAxis(),t,e)}configureMotorModel(t){this.rawSet.jointConfigureMotorModel(this.handle,this.rawAxis(),t)}configureMotorVelocity(t,e){this.rawSet.jointConfigureMotorVelocity(this.handle,this.rawAxis(),t,e)}configureMotorPosition(t,e,r){this.rawSet.jointConfigureMotorPosition(this.handle,this.rawAxis(),t,e,r)}configureMotor(t,e,r,i){this.rawSet.jointConfigureMotor(this.handle,this.rawAxis(),t,e,r,i)}}class _ extends h{}class d extends h{}class p extends h{}class w extends u{rawAxis(){return c.aF.LinX}}class f extends u{rawAxis(){return c.aF.AngX}}class g extends h{}class y extends h{}class m{constructor(){}static fixed(t,e,r,i){let o=new m;return o.anchor1=t,o.anchor2=r,o.frame1=e,o.frame2=i,o.jointType=n.Fixed,o}static spring(t,e,r,i,o){let a=new m;return a.anchor1=i,a.anchor2=o,a.length=t,a.stiffness=e,a.damping=r,a.jointType=n.Spring,a}static rope(t,e,r){let i=new m;return i.anchor1=e,i.anchor2=r,i.length=t,i.jointType=n.Rope,i}static generic(t,e,r,i){let o=new m;return o.anchor1=t,o.anchor2=e,o.axis=r,o.axesMask=i,o.jointType=n.Generic,o}static spherical(t,e){let r=new m;return r.anchor1=t,r.anchor2=e,r.jointType=n.Spherical,r}static prismatic(t,e,r){let i=new m;return i.anchor1=t,i.anchor2=e,i.axis=r,i.jointType=n.Prismatic,i}static revolute(t,e,r){let i=new m;return i.anchor1=t,i.anchor2=e,i.axis=r,i.jointType=n.Revolute,i}intoRaw(){let t,e,r=s.if.intoRaw(this.anchor1),i=s.if.intoRaw(this.anchor2),o=!1,a=0,l=0;switch(this.jointType){case n.Fixed:let h=s.PB.intoRaw(this.frame1),u=s.PB.intoRaw(this.frame2);e=c.FJ.fixed(r,h,i,u),h.free(),u.free();break;case n.Spring:e=c.FJ.spring(this.length,this.stiffness,this.damping,r,i);break;case n.Rope:e=c.FJ.rope(this.length,r,i);break;case n.Prismatic:t=s.if.intoRaw(this.axis),this.limitsEnabled&&(o=!0,a=this.limits[0],l=this.limits[1]),e=c.FJ.prismatic(r,i,t,o,a,l),t.free();break;case n.Generic:t=s.if.intoRaw(this.axis);let _=this.axesMask;e=c.FJ.generic(r,i,t,_);break;case n.Spherical:e=c.FJ.spherical(r,i);break;case n.Revolute:t=s.if.intoRaw(this.axis),e=c.FJ.revolute(r,i,t),t.free()}return r.free(),i.free(),e}}i()}catch(t){i(t)}}))},8836:(t,e,r)=>{r.d(e,{y:()=>i});class i{constructor(){this.fconv=new Float64Array(1),this.uconv=new Uint32Array(this.fconv.buffer),this.data=new Array,this.size=0}set(t,e){let r=this.index(t);for(;this.data.length<=r;)this.data.push(null);null==this.data[r]&&(this.size+=1),this.data[r]=e}len(){return this.size}delete(t){let e=this.index(t);e<this.data.length&&(null!=this.data[e]&&(this.size-=1),this.data[e]=null)}clear(){this.data=new Array}get(t){let e=this.index(t);return e<this.data.length?this.data[e]:null}forEach(t){for(const e of this.data)null!=e&&t(e)}getAll(){return this.data.filter((t=>null!=t))}index(t){return this.fconv[0]=t,this.uconv[0]}}},9143:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{B:()=>c,X:()=>s});var n=r(5063),o=r(7707),a=t([n,o]);[n,o]=a.then?(await a)():a;class s{free(){this.raw&&this.raw.free(),this.raw=void 0}constructor(t){this.raw=t||new n.xm,this.tempManifold=new c(null)}contactPairsWith(t,e){this.raw.contact_pairs_with(t,e)}intersectionPairsWith(t,e){this.raw.intersection_pairs_with(t,e)}contactPair(t,e,r){const i=this.raw.contact_pair(t,e);if(i){const e=i.collider1()!=t;let n;for(n=0;n<i.numContactManifolds();++n)this.tempManifold.raw=i.contactManifold(n),this.tempManifold.raw&&r(this.tempManifold,e),this.tempManifold.free();i.free()}}intersectionPair(t,e){return this.raw.intersection_pair(t,e)}}class c{free(){this.raw&&this.raw.free(),this.raw=void 0}constructor(t){this.raw=t}normal(){return o.if.fromRaw(this.raw.normal())}localNormal1(){return o.if.fromRaw(this.raw.local_n1())}localNormal2(){return o.if.fromRaw(this.raw.local_n2())}subshape1(){return this.raw.subshape1()}subshape2(){return this.raw.subshape2()}numContacts(){return this.raw.num_contacts()}localContactPoint1(t){return o.if.fromRaw(this.raw.contact_local_p1(t))}localContactPoint2(t){return o.if.fromRaw(this.raw.contact_local_p2(t))}contactDist(t){return this.raw.contact_dist(t)}contactFid1(t){return this.raw.contact_fid1(t)}contactFid2(t){return this.raw.contact_fid2(t)}contactImpulse(t){return this.raw.contact_impulse(t)}contactTangentImpulseX(t){return this.raw.contact_tangent_impulse_x(t)}contactTangentImpulseY(t){return this.raw.contact_tangent_impulse_y(t)}numSolverContacts(){return this.raw.num_solver_contacts()}solverContactPoint(t){return o.if.fromRaw(this.raw.solver_contact_point(t))}solverContactDist(t){return this.raw.solver_contact_dist(t)}solverContactFriction(t){return this.raw.solver_contact_friction(t)}solverContactRestitution(t){return this.raw.solver_contact_restitution(t)}solverContactTangentVelocity(t){return o.if.fromRaw(this.raw.solver_contact_tangent_velocity(t))}}i()}catch(t){i(t)}}))},9726:(t,e,r)=>{r.a(t,(async(t,i)=>{try{r.d(e,{c$:()=>l,eB:()=>a,p9:()=>u,qe:()=>s,y:()=>h,yB:()=>c});var n=r(5063),o=t([n]);n=(o.then?(await o)():o)[0];class a{constructor(t,e){this.rawSet=t,this.handle=e}static newTyped(t,e){switch(t.jointType(e)){case n.Pu.Revolute:return new h(t,e);case n.Pu.Prismatic:return new l(t,e);case n.Pu.Fixed:return new c(t,e);case n.Pu.Spherical:return new u(t,e);default:return new a(t,e)}}isValid(){return this.rawSet.contains(this.handle)}setContactsEnabled(t){this.rawSet.jointSetContactsEnabled(this.handle,t)}contactsEnabled(){return this.rawSet.jointContactsEnabled(this.handle)}}class s extends a{}class c extends a{}class l extends s{rawAxis(){return n.aF.LinX}}class h extends s{rawAxis(){return n.aF.AngX}}class u extends a{}i()}catch(t){i(t)}}))}},o={};function a(t){var e=o[t];if(void 0!==e)return e.exports;var r=o[t]={id:t,loaded:!1,exports:{}};return n[t](r,r.exports,a),r.loaded=!0,r.exports}t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",e="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",i=t=>{t&&t.d<1&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},a.a=(n,o,a)=>{var s;a&&((s=[]).d=-1);var c,l,h,u=new Set,_=n.exports,d=new Promise(((t,e)=>{h=e,l=t}));d[e]=_,d[t]=t=>(s&&t(s),u.forEach(t),d.catch((t=>{}))),n.exports=d,o((n=>{var o;c=(n=>n.map((n=>{if(null!==n&&"object"==typeof n){if(n[t])return n;if(n.then){var o=[];o.d=0,n.then((t=>{a[e]=t,i(o)}),(t=>{a[r]=t,i(o)}));var a={};return a[t]=t=>t(o),a}}var s={};return s[t]=t=>{},s[e]=n,s})))(n);var a=()=>c.map((t=>{if(t[r])throw t[r];return t[e]})),l=new Promise((e=>{(o=()=>e(a)).r=0;var r=t=>t!==s&&!u.has(t)&&(u.add(t),t&&!t.d&&(o.r++,t.push(o)));c.map((e=>e[t](r)))}));return o.r?l:a()}),(t=>(t?h(d[r]=t):l(_),i(s)))),s&&s.d<0&&(s.d=0)},a.d=(t,e)=>{for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},a.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.v=(t,e,r,i)=>{var n=fetch(a.p+""+r+".module.wasm"),o=()=>n.then((t=>t.arrayBuffer())).then((t=>WebAssembly.instantiate(t,i))).then((e=>Object.assign(t,e.instance.exports)));return n.then((e=>"function"==typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(e,i).then((e=>Object.assign(t,e.instance.exports)),(t=>{if("application/wasm"!==e.headers.get("Content-Type"))return console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t),o();throw t})):o()))},a.p="./",a(1332)})();
//# sourceMappingURL=bundle.js.map